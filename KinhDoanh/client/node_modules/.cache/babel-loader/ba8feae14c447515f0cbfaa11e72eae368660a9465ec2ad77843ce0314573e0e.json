{"ast":null,"code":"import _objectSpread from\"C:/Users/Admin/Documents/GitHub/MVG_InventoryManagement/KinhDoanh/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";/**\r\n * Contract Manager - Quản lý hợp đồng chính\r\n */import React,{useState,useEffect,useCallback}from'react';import{Container,Row,Col,Card,Button,Table,Badge,Form,Modal,Tabs,Tab,Dropdown,OverlayTrigger,Tooltip}from'react-bootstrap';import{useAuth}from'../../contexts/AuthContext';import{useNotification}from'../../contexts/NotificationContext';import LoadingSpinner from'../Common/LoadingSpinner';import ContractCreator from'./ContractCreator';import contractService from'../../services/contractService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ContractManager=_ref=>{let{initialOpenCreate=false,initialCustomerId=''}=_ref;const{hasPermission}=useAuth();const{showSuccess,showError}=useNotification();const[loading,setLoading]=useState(true);const[contracts,setContracts]=useState([]);const[filteredContracts,setFilteredContracts]=useState([]);const[showCreateModal,setShowCreateModal]=useState(!!initialOpenCreate);const[selectedContract,setSelectedContract]=useState(null);const[showDetailModal,setShowDetailModal]=useState(false);const[renderError,setRenderError]=useState(null);const[filters,setFilters]=useState({search:'',status:'',workflow_stage:'',start_date_from:'',start_date_to:''});const[pagination,setPagination]=useState({page:1,limit:20,total:0,pages:0});// Contract statuses with colors\nconst contractStatuses={draft:{label:'Bản nháp',variant:'secondary'},review:{label:'Đang xem xét',variant:'info'},approved:{label:'Đã duyệt',variant:'success'},signed:{label:'Đã ký',variant:'primary'},active:{label:'Đang hiệu lực',variant:'success'},expired:{label:'Hết hạn',variant:'warning'},terminated:{label:'Chấm dứt',variant:'danger'},cancelled:{label:'Hủy bỏ',variant:'dark'}};const workflowStages={preparation:{label:'Chuẩn bị',icon:'fas fa-edit'},legal_review:{label:'Xem xét pháp lý',icon:'fas fa-balance-scale'},approval:{label:'Phê duyệt',icon:'fas fa-check-circle'},signing:{label:'Ký kết',icon:'fas fa-signature'},execution:{label:'Thực thi',icon:'fas fa-play-circle'}};// Load contracts\nconst loadContracts=useCallback(async function(){let page=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;try{setLoading(true);const params=_objectSpread({page:page.toString(),limit:pagination.limit.toString()},filters);// Remove empty filters\nObject.keys(params).forEach(key=>{if(!params[key])delete params[key];});const response=await contractService.getContracts(params);if(response&&response.success){const contractsData=Array.isArray(response.data.contracts)?response.data.contracts:[];const paginationData=response.data.pagination||{page:1,limit:20,total:contractsData.length,pages:1};setContracts(contractsData);setFilteredContracts(contractsData);setPagination(paginationData);}else{showError(response.message||'Không thể tải danh sách hợp đồng');}}catch(error){console.warn('Contract loading error:',(error===null||error===void 0?void 0:error.message)||error);// showError('Lỗi kết nối: ' + error.message);\n}finally{setLoading(false);}},[filters,pagination.limit,showError]);useEffect(()=>{if(hasPermission('contract_read')){loadContracts();}},[hasPermission,loadContracts,pagination.page]);// Handle filter changes\nuseEffect(()=>{// Debounce search to avoid too many API calls\nconst timeoutId=setTimeout(()=>{if(pagination.page===1){loadContracts(1);}else{setPagination(prev=>_objectSpread(_objectSpread({},prev),{},{page:1}));loadContracts(1);}},500);return()=>clearTimeout(timeoutId);},[filters]);// Format currency\nconst formatCurrency=amount=>{return new Intl.NumberFormat('vi-VN',{style:'currency',currency:'VND'}).format(amount);};// Calculate contract value\n// const calculateContractValue = (contract) => {\n//   const startDate = new Date(contract.start_date);\n//   const endDate = new Date(contract.end_date);\n//   const months = (endDate.getFullYear() - startDate.getFullYear()) * 12 + \n//                  (endDate.getMonth() - startDate.getMonth());\n//   return contract.rental_price * months;\n// };\n// Handle contract status change\nconst handleStatusChange=async(contractId,newStatus,newStage)=>{try{var _contractStatuses$new;const statusData={status:newStatus,workflow_stage:newStage,comment:\"Chuy\\u1EC3n tr\\u1EA1ng th\\xE1i sang \".concat((_contractStatuses$new=contractStatuses[newStatus])===null||_contractStatuses$new===void 0?void 0:_contractStatuses$new.label)};const response=await contractService.updateContractStatus(contractId,statusData);if(response.success){showSuccess('Cập nhật trạng thái thành công');loadContracts(pagination.page);}else{showError(response.message||'Không thể cập nhật trạng thái');}}catch(error){showError('Lỗi kết nối: '+error.message);}};// View contract details\nconst viewContractDetails=async contractId=>{try{const response=await contractService.getContract(contractId);if(response.success){setSelectedContract(response.data);setShowDetailModal(true);}else{showError(response.message||'Không thể tải chi tiết hợp đồng');}}catch(error){showError('Lỗi kết nối: '+error.message);}};if(!hasPermission('contract_read')){return/*#__PURE__*/_jsx(Container,{className:\"mt-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-warning\",children:\"B\\u1EA1n kh\\xF4ng c\\xF3 quy\\u1EC1n truy c\\u1EADp qu\\u1EA3n l\\xFD h\\u1EE3p \\u0111\\u1ED3ng.\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4\",children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-4\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-file-contract me-2\"}),\"Qu\\u1EA3n l\\xFD h\\u1EE3p \\u0111\\u1ED3ng\"]}),hasPermission('contract_create')&&/*#__PURE__*/_jsxs(Button,{variant:\"primary\",onClick:()=>setShowCreateModal(true),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-plus me-2\"}),\"T\\u1EA1o h\\u1EE3p \\u0111\\u1ED3ng m\\u1EDBi\"]})]}),/*#__PURE__*/_jsxs(Card,{className:\"mb-4\",children:[/*#__PURE__*/_jsx(Card.Header,{children:/*#__PURE__*/_jsxs(\"h5\",{className:\"mb-0\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-filter me-2\"}),\"B\\u1ED9 l\\u1ECDc\"]})}),/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"T\\xECm ki\\u1EBFm\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"S\\u1ED1 H\\u0110, t\\xEAn kh\\xE1ch h\\xE0ng...\",value:filters.search,onChange:e=>setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{search:e.target.value}))})]})}),/*#__PURE__*/_jsx(Col,{md:2,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Tr\\u1EA1ng th\\xE1i\"}),/*#__PURE__*/_jsxs(Form.Select,{value:filters.status,onChange:e=>setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{status:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"T\\u1EA5t c\\u1EA3\"}),Object.entries(contractStatuses).map(_ref2=>{let[key,status]=_ref2;return/*#__PURE__*/_jsx(\"option\",{value:key,children:status.label},key);})]})]})}),/*#__PURE__*/_jsx(Col,{md:2,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Giai \\u0111o\\u1EA1n\"}),/*#__PURE__*/_jsxs(Form.Select,{value:filters.workflow_stage,onChange:e=>setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{workflow_stage:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"T\\u1EA5t c\\u1EA3\"}),Object.entries(workflowStages).map(_ref3=>{let[key,stage]=_ref3;return/*#__PURE__*/_jsx(\"option\",{value:key,children:stage.label},key);})]})]})}),/*#__PURE__*/_jsx(Col,{md:2,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"T\\u1EEB ng\\xE0y\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"date\",value:filters.start_date_from,onChange:e=>setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{start_date_from:e.target.value}))})]})}),/*#__PURE__*/_jsx(Col,{md:2,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"\\u0110\\u1EBFn ng\\xE0y\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"date\",value:filters.start_date_to,onChange:e=>setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{start_date_to:e.target.value}))})]})}),/*#__PURE__*/_jsx(Col,{md:1,className:\"d-flex align-items-end\",children:/*#__PURE__*/_jsx(Button,{variant:\"outline-secondary\",onClick:()=>setFilters({search:'',status:'',workflow_stage:'',start_date_from:'',start_date_to:''}),children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-undo\"})})})]})})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(Card.Header,{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"h5\",{className:\"mb-0\",children:[\"Danh s\\xE1ch h\\u1EE3p \\u0111\\u1ED3ng (\",pagination.total,\")\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex gap-2\",children:[/*#__PURE__*/_jsxs(Button,{variant:\"outline-primary\",size:\"sm\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-download me-2\"}),\"Xu\\u1EA5t Excel\"]}),/*#__PURE__*/_jsx(Button,{variant:\"outline-secondary\",size:\"sm\",onClick:()=>loadContracts(pagination.page),children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-sync-alt\"})})]})]}),/*#__PURE__*/_jsx(Card.Body,{className:\"p-0\",children:loading?/*#__PURE__*/_jsx(\"div\",{className:\"text-center p-4\",children:/*#__PURE__*/_jsx(LoadingSpinner,{})}):renderError?/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-danger\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"L\\u1ED7i hi\\u1EC3n th\\u1ECB danh s\\xE1ch h\\u1EE3p \\u0111\\u1ED3ng:\"}),/*#__PURE__*/_jsx(\"div\",{children:String(renderError)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-muted\",children:\"Vui l\\xF2ng t\\u1EA3i l\\u1EA1i trang ho\\u1EB7c li\\xEAn h\\u1EC7 admin.\"})]}):/*#__PURE__*/_jsxs(Table,{responsive:true,hover:true,className:\"mb-0\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"table-light\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"S\\u1ED1 h\\u1EE3p \\u0111\\u1ED3ng\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Kh\\xE1ch h\\xE0ng\"}),/*#__PURE__*/_jsx(\"th\",{children:\"D\\u1EF1 \\xE1n\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Di\\u1EC7n t\\xEDch\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Gi\\xE1 thu\\xEA/th\\xE1ng\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Th\\u1EDDi h\\u1EA1n\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Tr\\u1EA1ng th\\xE1i\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Giai \\u0111o\\u1EA1n\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Ng\\u01B0\\u1EDDi ph\\u1EE5 tr\\xE1ch\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Thao t\\xE1c\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:(()=>{try{return(filteredContracts||[]).map(contract=>{var _contract$warehouse_a,_contract$rental_pric,_contract$rental_pric2,_contractStatuses$con,_contractStatuses$con2,_workflowStages$contr,_workflowStages$contr2;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:contract.contract_number}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:contract.created_at?new Date(contract.created_at).toLocaleDateString('vi-VN'):''})]}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:contract.customer_company_name||contract.company_name}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:contract.customer_name})]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:contract.project_name||'Chưa phân bổ'}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:contract.warehouse_location})]})}),/*#__PURE__*/_jsxs(\"td\",{children:[(_contract$warehouse_a=contract.warehouse_area)!==null&&_contract$warehouse_a!==void 0?_contract$warehouse_a:'N/A',\" m\\xB2\"]}),/*#__PURE__*/_jsxs(\"td\",{children:[formatCurrency((_contract$rental_pric=contract.rental_price)!==null&&_contract$rental_pric!==void 0?_contract$rental_pric:0),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:contract.warehouse_area?formatCurrency(((_contract$rental_pric2=contract.rental_price)!==null&&_contract$rental_pric2!==void 0?_contract$rental_pric2:0)/contract.warehouse_area)+'/m²':'N/A'})]}),/*#__PURE__*/_jsxs(\"td\",{children:[contract.start_date?new Date(contract.start_date).toLocaleDateString('vi-VN'):'',/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[\"\\u2192 \",contract.end_date?new Date(contract.end_date).toLocaleDateString('vi-VN'):'']})]}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Badge,{bg:((_contractStatuses$con=contractStatuses[contract.status])===null||_contractStatuses$con===void 0?void 0:_contractStatuses$con.variant)||'secondary',children:((_contractStatuses$con2=contractStatuses[contract.status])===null||_contractStatuses$con2===void 0?void 0:_contractStatuses$con2.label)||contract.status})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"\".concat((_workflowStages$contr=workflowStages[contract.workflow_stage])===null||_workflowStages$contr===void 0?void 0:_workflowStages$contr.icon,\" me-2\")}),/*#__PURE__*/_jsx(\"small\",{children:(_workflowStages$contr2=workflowStages[contract.workflow_stage])===null||_workflowStages$contr2===void 0?void 0:_workflowStages$contr2.label})]})}),/*#__PURE__*/_jsx(\"td\",{children:contract.assigned_to_name?/*#__PURE__*/_jsx(Badge,{bg:\"info\",children:contract.assigned_to_name}):/*#__PURE__*/_jsx(\"span\",{className:\"text-muted\",children:\"Ch\\u01B0a giao\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex gap-1\",children:[/*#__PURE__*/_jsx(OverlayTrigger,{overlay:/*#__PURE__*/_jsx(Tooltip,{children:\"Xem chi ti\\u1EBFt\"}),children:/*#__PURE__*/_jsx(Button,{variant:\"outline-primary\",size:\"sm\",onClick:()=>viewContractDetails(contract.id),children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-eye\"})})}),hasPermission('contract_update')&&/*#__PURE__*/_jsxs(Dropdown,{children:[/*#__PURE__*/_jsx(Dropdown.Toggle,{variant:\"outline-secondary\",size:\"sm\",id:\"dropdown-\".concat(contract.id),children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-cog\"})}),/*#__PURE__*/_jsxs(Dropdown.Menu,{children:[/*#__PURE__*/_jsxs(Dropdown.Item,{onClick:()=>handleStatusChange(contract.id,'review','legal_review'),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-eye me-2\"}),\"G\\u1EEDi xem x\\xE9t\"]}),/*#__PURE__*/_jsxs(Dropdown.Item,{onClick:()=>handleStatusChange(contract.id,'approved','signing'),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-check me-2\"}),\"Ph\\xEA duy\\u1EC7t\"]}),/*#__PURE__*/_jsxs(Dropdown.Item,{onClick:()=>handleStatusChange(contract.id,'signed','execution'),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-signature me-2\"}),\"\\u0110\\xE3 k\\xFD\"]}),/*#__PURE__*/_jsx(Dropdown.Divider,{}),/*#__PURE__*/_jsxs(Dropdown.Item,{className:\"text-danger\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-trash me-2\"}),\"H\\u1EE7y b\\u1ECF\"]})]})]})]})})]},contract.id);});}catch(err){console.error('Render error in ContractManager:',err);setRenderError((err===null||err===void 0?void 0:err.message)||String(err));return null;}})()})]})}),pagination.pages>1&&/*#__PURE__*/_jsx(Card.Footer,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[\"Hi\\u1EC3n th\\u1ECB \",(pagination.page-1)*pagination.limit+1,\" - \",Math.min(pagination.page*pagination.limit,pagination.total),\"trong t\\u1ED5ng s\\u1ED1 \",pagination.total,\" h\\u1EE3p \\u0111\\u1ED3ng\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex gap-2\",children:[/*#__PURE__*/_jsx(Button,{variant:\"outline-secondary\",size:\"sm\",disabled:pagination.page===1,onClick:()=>setPagination(prev=>_objectSpread(_objectSpread({},prev),{},{page:prev.page-1})),children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-chevron-left\"})}),/*#__PURE__*/_jsxs(\"span\",{className:\"d-flex align-items-center px-3\",children:[\"Trang \",pagination.page,\" / \",pagination.pages]}),/*#__PURE__*/_jsx(Button,{variant:\"outline-secondary\",size:\"sm\",disabled:pagination.page===pagination.pages,onClick:()=>setPagination(prev=>_objectSpread(_objectSpread({},prev),{},{page:prev.page+1})),children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-chevron-right\"})})]})]})})]})]})}),/*#__PURE__*/_jsx(ContractCreator,{show:showCreateModal,initialCustomerId:initialCustomerId,onHide:()=>setShowCreateModal(false),onSuccess:()=>{setShowCreateModal(false);loadContracts(pagination.page);}}),selectedContract&&/*#__PURE__*/_jsxs(Modal,{show:showDetailModal,onHide:()=>setShowDetailModal(false),size:\"xl\",scrollable:true,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsxs(Modal.Title,{children:[\"Chi ti\\u1EBFt h\\u1EE3p \\u0111\\u1ED3ng \",selectedContract.contract.contract_number]})}),/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsx(ContractDetailView,{contract:selectedContract})})]})]});};// Contract Detail Component  \nconst ContractDetailView=_ref4=>{var _contract$documents,_contract$documents2,_contract$workflow_hi;let{contract}=_ref4;return/*#__PURE__*/_jsxs(Tabs,{defaultActiveKey:\"overview\",id:\"contract-detail-tabs\",children:[/*#__PURE__*/_jsx(Tab,{eventKey:\"overview\",title:\"T\\u1ED5ng quan\",children:/*#__PURE__*/_jsx(\"div\",{className:\"pt-3\",children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{md:6,children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Th\\xF4ng tin h\\u1EE3p \\u0111\\u1ED3ng\"}),/*#__PURE__*/_jsx(Table,{size:\"sm\",children:/*#__PURE__*/_jsxs(\"tbody\",{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"S\\u1ED1 h\\u1EE3p \\u0111\\u1ED3ng:\"})}),/*#__PURE__*/_jsx(\"td\",{children:contract.contract.contract_number})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Ti\\xEAu \\u0111\\u1EC1:\"})}),/*#__PURE__*/_jsx(\"td\",{children:contract.contract.contract_title})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"D\\u1EF1 \\xE1n:\"})}),/*#__PURE__*/_jsx(\"td\",{children:contract.contract.project_name||'Chưa phân bổ'})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Kho:\"})}),/*#__PURE__*/_jsx(\"td\",{children:contract.contract.warehouse_location})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Di\\u1EC7n t\\xEDch:\"})}),/*#__PURE__*/_jsxs(\"td\",{children:[contract.contract.warehouse_area,\" m\\xB2\"]})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Gi\\xE1 thu\\xEA:\"})}),/*#__PURE__*/_jsxs(\"td\",{children:[new Intl.NumberFormat('vi-VN').format(contract.contract.rental_price),\" VN\\u0110/th\\xE1ng\"]})]})]})})]}),/*#__PURE__*/_jsxs(Col,{md:6,children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Th\\xF4ng tin kh\\xE1ch h\\xE0ng\"}),/*#__PURE__*/_jsx(Table,{size:\"sm\",children:/*#__PURE__*/_jsxs(\"tbody\",{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"C\\xF4ng ty:\"})}),/*#__PURE__*/_jsx(\"td\",{children:contract.contract.customer_company_name})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Ng\\u01B0\\u1EDDi li\\xEAn h\\u1EC7:\"})}),/*#__PURE__*/_jsx(\"td\",{children:contract.contract.customer_name})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0110i\\u1EC7n tho\\u1EA1i:\"})}),/*#__PURE__*/_jsx(\"td\",{children:contract.contract.customer_phone})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Email:\"})}),/*#__PURE__*/_jsx(\"td\",{children:contract.contract.customer_email})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"M\\xE3 s\\u1ED1 thu\\u1EBF:\"})}),/*#__PURE__*/_jsx(\"td\",{children:contract.contract.tax_code})]})]})})]})]})})}),/*#__PURE__*/_jsx(Tab,{eventKey:\"documents\",title:\"T\\xE0i li\\u1EC7u (\".concat(((_contract$documents=contract.documents)===null||_contract$documents===void 0?void 0:_contract$documents.length)||0,\")\"),children:/*#__PURE__*/_jsx(\"div\",{className:\"pt-3\",children:((_contract$documents2=contract.documents)===null||_contract$documents2===void 0?void 0:_contract$documents2.length)>0?/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"T\\xEAn t\\xE0i li\\u1EC7u\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Lo\\u1EA1i\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Phi\\xEAn b\\u1EA3n\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Tr\\u1EA1ng th\\xE1i\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Ng\\xE0y t\\u1EA1o\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Thao t\\xE1c\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:contract.documents.map(doc=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:doc.document_name}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Badge,{bg:\"info\",children:doc.category_name})}),/*#__PURE__*/_jsxs(\"td\",{children:[\"v\",doc.version]}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Badge,{bg:doc.status==='final'?'success':doc.status==='draft'?'secondary':'warning',children:doc.status})}),/*#__PURE__*/_jsx(\"td\",{children:new Date(doc.created_at).toLocaleDateString('vi-VN')}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Button,{variant:\"outline-primary\",size:\"sm\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-eye\"})})})]},doc.id))})]}):/*#__PURE__*/_jsx(\"div\",{className:\"text-center text-muted py-4\",children:\"Ch\\u01B0a c\\xF3 t\\xE0i li\\u1EC7u n\\xE0o\"})})}),/*#__PURE__*/_jsx(Tab,{eventKey:\"history\",title:\"L\\u1ECBch s\\u1EED\",children:/*#__PURE__*/_jsx(\"div\",{className:\"pt-3\",children:((_contract$workflow_hi=contract.workflow_history)===null||_contract$workflow_hi===void 0?void 0:_contract$workflow_hi.length)>0?/*#__PURE__*/_jsx(\"div\",{className:\"timeline\",children:contract.workflow_history.map(history=>/*#__PURE__*/_jsx(\"div\",{className:\"timeline-item mb-3\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"rounded-circle bg-primary text-white d-flex align-items-center justify-content-center\",style:{width:'40px',height:'40px'},children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-user fa-sm\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow-1 ms-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between\",children:[/*#__PURE__*/_jsx(\"h6\",{className:\"mb-1\",children:history.action}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:new Date(history.performed_at).toLocaleString('vi-VN')})]}),/*#__PURE__*/_jsx(\"p\",{className:\"mb-1\",children:history.comment}),/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[\"B\\u1EDFi: \",history.performed_by_name]})]})]})},history.id))}):/*#__PURE__*/_jsx(\"div\",{className:\"text-center text-muted py-4\",children:\"Ch\\u01B0a c\\xF3 l\\u1ECBch s\\u1EED n\\xE0o\"})})})]});};export default ContractManager;","map":{"version":3,"names":["React","useState","useEffect","useCallback","Container","Row","Col","Card","Button","Table","Badge","Form","Modal","Tabs","Tab","Dropdown","OverlayTrigger","Tooltip","useAuth","useNotification","LoadingSpinner","ContractCreator","contractService","jsx","_jsx","jsxs","_jsxs","ContractManager","_ref","initialOpenCreate","initialCustomerId","hasPermission","showSuccess","showError","loading","setLoading","contracts","setContracts","filteredContracts","setFilteredContracts","showCreateModal","setShowCreateModal","selectedContract","setSelectedContract","showDetailModal","setShowDetailModal","renderError","setRenderError","filters","setFilters","search","status","workflow_stage","start_date_from","start_date_to","pagination","setPagination","page","limit","total","pages","contractStatuses","draft","label","variant","review","approved","signed","active","expired","terminated","cancelled","workflowStages","preparation","icon","legal_review","approval","signing","execution","loadContracts","arguments","length","undefined","params","_objectSpread","toString","Object","keys","forEach","key","response","getContracts","success","contractsData","Array","isArray","data","paginationData","message","error","console","warn","timeoutId","setTimeout","prev","clearTimeout","formatCurrency","amount","Intl","NumberFormat","style","currency","format","handleStatusChange","contractId","newStatus","newStage","_contractStatuses$new","statusData","comment","concat","updateContractStatus","viewContractDetails","getContract","className","children","onClick","Header","Body","md","Group","Label","Control","type","placeholder","value","onChange","e","target","Select","entries","map","_ref2","_ref3","stage","size","String","responsive","hover","contract","_contract$warehouse_a","_contract$rental_pric","_contract$rental_pric2","_contractStatuses$con","_contractStatuses$con2","_workflowStages$contr","_workflowStages$contr2","contract_number","created_at","Date","toLocaleDateString","customer_company_name","company_name","customer_name","project_name","warehouse_location","warehouse_area","rental_price","start_date","end_date","bg","assigned_to_name","overlay","id","Toggle","Menu","Item","Divider","err","Footer","Math","min","disabled","show","onHide","onSuccess","scrollable","closeButton","Title","ContractDetailView","_ref4","_contract$documents","_contract$documents2","_contract$workflow_hi","defaultActiveKey","eventKey","title","contract_title","customer_phone","customer_email","tax_code","documents","doc","document_name","category_name","version","workflow_history","history","width","height","action","performed_at","toLocaleString","performed_by_name"],"sources":["C:/Users/Admin/Documents/GitHub/MVG_InventoryManagement/KinhDoanh/client/src/components/Contracts/ContractManager.js"],"sourcesContent":["/**\r\n * Contract Manager - Quản lý hợp đồng chính\r\n */\r\n\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport { \r\n  Container, Row, Col, Card, Button, Table, Badge, Form, \r\n  Modal, Tabs, Tab, Dropdown, OverlayTrigger, Tooltip \r\n} from 'react-bootstrap';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { useNotification } from '../../contexts/NotificationContext';\r\nimport LoadingSpinner from '../Common/LoadingSpinner';\r\nimport ContractCreator from './ContractCreator';\r\nimport contractService from '../../services/contractService';\r\n\r\nconst ContractManager = ({ initialOpenCreate = false, initialCustomerId = '' }) => {\r\n  const { hasPermission } = useAuth();\r\n  const { showSuccess, showError } = useNotification();\r\n  \r\n  const [loading, setLoading] = useState(true);\r\n  const [contracts, setContracts] = useState([]);\r\n  const [filteredContracts, setFilteredContracts] = useState([]);\r\n  const [showCreateModal, setShowCreateModal] = useState(!!initialOpenCreate);\r\n  const [selectedContract, setSelectedContract] = useState(null);\r\n  const [showDetailModal, setShowDetailModal] = useState(false);\r\n  const [renderError, setRenderError] = useState(null);\r\n\r\n  const [filters, setFilters] = useState({\r\n    search: '',\r\n    status: '',\r\n    workflow_stage: '',\r\n    start_date_from: '',\r\n    start_date_to: ''\r\n  });\r\n\r\n  const [pagination, setPagination] = useState({\r\n    page: 1,\r\n    limit: 20,\r\n    total: 0,\r\n    pages: 0\r\n  });\r\n\r\n  // Contract statuses with colors\r\n  const contractStatuses = {\r\n    draft: { label: 'Bản nháp', variant: 'secondary' },\r\n    review: { label: 'Đang xem xét', variant: 'info' },\r\n    approved: { label: 'Đã duyệt', variant: 'success' },\r\n    signed: { label: 'Đã ký', variant: 'primary' },\r\n    active: { label: 'Đang hiệu lực', variant: 'success' },\r\n    expired: { label: 'Hết hạn', variant: 'warning' },\r\n    terminated: { label: 'Chấm dứt', variant: 'danger' },\r\n    cancelled: { label: 'Hủy bỏ', variant: 'dark' }\r\n  };\r\n\r\n  const workflowStages = {\r\n    preparation: { label: 'Chuẩn bị', icon: 'fas fa-edit' },\r\n    legal_review: { label: 'Xem xét pháp lý', icon: 'fas fa-balance-scale' },\r\n    approval: { label: 'Phê duyệt', icon: 'fas fa-check-circle' },\r\n    signing: { label: 'Ký kết', icon: 'fas fa-signature' },\r\n    execution: { label: 'Thực thi', icon: 'fas fa-play-circle' }\r\n  };\r\n\r\n  // Load contracts\r\n  const loadContracts = useCallback(async (page = 1) => {\r\n    try {\r\n      setLoading(true);\r\n      const params = {\r\n        page: page.toString(),\r\n        limit: pagination.limit.toString(),\r\n        ...filters\r\n      };\r\n\r\n      // Remove empty filters\r\n      Object.keys(params).forEach(key => {\r\n        if (!params[key]) delete params[key];\r\n      });\r\n\r\n      const response = await contractService.getContracts(params);\r\n      \r\n      if (response && response.success) {\r\n        const contractsData = Array.isArray(response.data.contracts) ? response.data.contracts : [];\r\n        const paginationData = response.data.pagination || { page: 1, limit: 20, total: contractsData.length, pages: 1 };\r\n\r\n        setContracts(contractsData);\r\n        setFilteredContracts(contractsData);\r\n        setPagination(paginationData);\r\n      } else {\r\n        showError(response.message || 'Không thể tải danh sách hợp đồng');\r\n      }\r\n    } catch (error) {\r\n      console.warn('Contract loading error:', error?.message || error);\r\n      // showError('Lỗi kết nối: ' + error.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [filters, pagination.limit, showError]);\r\n\r\n  useEffect(() => {\r\n    if (hasPermission('contract_read')) {\r\n      loadContracts();\r\n    }\r\n  }, [hasPermission, loadContracts, pagination.page]);\r\n\r\n  // Handle filter changes\r\n  useEffect(() => {\r\n    // Debounce search to avoid too many API calls\r\n    const timeoutId = setTimeout(() => {\r\n      if (pagination.page === 1) {\r\n        loadContracts(1);\r\n      } else {\r\n        setPagination(prev => ({ ...prev, page: 1 }));\r\n        loadContracts(1);\r\n      }\r\n    }, 500);\r\n\r\n    return () => clearTimeout(timeoutId);\r\n  }, [filters]);\r\n\r\n  // Format currency\r\n  const formatCurrency = (amount) => {\r\n    return new Intl.NumberFormat('vi-VN', {\r\n      style: 'currency',\r\n      currency: 'VND'\r\n    }).format(amount);\r\n  };\r\n\r\n  // Calculate contract value\r\n  // const calculateContractValue = (contract) => {\r\n  //   const startDate = new Date(contract.start_date);\r\n  //   const endDate = new Date(contract.end_date);\r\n  //   const months = (endDate.getFullYear() - startDate.getFullYear()) * 12 + \r\n  //                  (endDate.getMonth() - startDate.getMonth());\r\n  //   return contract.rental_price * months;\r\n  // };\r\n\r\n  // Handle contract status change\r\n  const handleStatusChange = async (contractId, newStatus, newStage) => {\r\n    try {\r\n      const statusData = { \r\n        status: newStatus, \r\n        workflow_stage: newStage,\r\n        comment: `Chuyển trạng thái sang ${contractStatuses[newStatus]?.label}` \r\n      };\r\n\r\n      const response = await contractService.updateContractStatus(contractId, statusData);\r\n      \r\n      if (response.success) {\r\n        showSuccess('Cập nhật trạng thái thành công');\r\n        loadContracts(pagination.page);\r\n      } else {\r\n        showError(response.message || 'Không thể cập nhật trạng thái');\r\n      }\r\n    } catch (error) {\r\n      showError('Lỗi kết nối: ' + error.message);\r\n    }\r\n  };\r\n\r\n  // View contract details\r\n  const viewContractDetails = async (contractId) => {\r\n    try {\r\n      const response = await contractService.getContract(contractId);\r\n      \r\n      if (response.success) {\r\n        setSelectedContract(response.data);\r\n        setShowDetailModal(true);\r\n      } else {\r\n        showError(response.message || 'Không thể tải chi tiết hợp đồng');\r\n      }\r\n    } catch (error) {\r\n      showError('Lỗi kết nối: ' + error.message);\r\n    }\r\n  };\r\n\r\n  if (!hasPermission('contract_read')) {\r\n    return (\r\n      <Container className=\"mt-4\">\r\n        <div className=\"alert alert-warning\">\r\n          Bạn không có quyền truy cập quản lý hợp đồng.\r\n        </div>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"mt-4\">\r\n      <Row>\r\n        <Col>\r\n          {/* Header */}\r\n          <div className=\"d-flex justify-content-between align-items-center mb-4\">\r\n            <h2>\r\n              <i className=\"fas fa-file-contract me-2\"></i>\r\n              Quản lý hợp đồng\r\n            </h2>\r\n            \r\n            {hasPermission('contract_create') && (\r\n              <Button \r\n                variant=\"primary\" \r\n                onClick={() => setShowCreateModal(true)}\r\n              >\r\n                <i className=\"fas fa-plus me-2\"></i>\r\n                Tạo hợp đồng mới\r\n              </Button>\r\n            )}\r\n          </div>\r\n\r\n          {/* Filters */}\r\n          <Card className=\"mb-4\">\r\n            <Card.Header>\r\n              <h5 className=\"mb-0\">\r\n                <i className=\"fas fa-filter me-2\"></i>\r\n                Bộ lọc\r\n              </h5>\r\n            </Card.Header>\r\n            <Card.Body>\r\n              <Row>\r\n                <Col md={3}>\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Label>Tìm kiếm</Form.Label>\r\n                    <Form.Control\r\n                      type=\"text\"\r\n                      placeholder=\"Số HĐ, tên khách hàng...\"\r\n                      value={filters.search}\r\n                      onChange={(e) => setFilters(prev => ({ \r\n                        ...prev, \r\n                        search: e.target.value \r\n                      }))}\r\n                    />\r\n                  </Form.Group>\r\n                </Col>\r\n                \r\n                <Col md={2}>\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Label>Trạng thái</Form.Label>\r\n                    <Form.Select\r\n                      value={filters.status}\r\n                      onChange={(e) => setFilters(prev => ({ \r\n                        ...prev, \r\n                        status: e.target.value \r\n                      }))}\r\n                    >\r\n                      <option value=\"\">Tất cả</option>\r\n                      {Object.entries(contractStatuses).map(([key, status]) => (\r\n                        <option key={key} value={key}>{status.label}</option>\r\n                      ))}\r\n                    </Form.Select>\r\n                  </Form.Group>\r\n                </Col>\r\n                \r\n                <Col md={2}>\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Label>Giai đoạn</Form.Label>\r\n                    <Form.Select\r\n                      value={filters.workflow_stage}\r\n                      onChange={(e) => setFilters(prev => ({ \r\n                        ...prev, \r\n                        workflow_stage: e.target.value \r\n                      }))}\r\n                    >\r\n                      <option value=\"\">Tất cả</option>\r\n                      {Object.entries(workflowStages).map(([key, stage]) => (\r\n                        <option key={key} value={key}>{stage.label}</option>\r\n                      ))}\r\n                    </Form.Select>\r\n                  </Form.Group>\r\n                </Col>\r\n                \r\n                <Col md={2}>\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Label>Từ ngày</Form.Label>\r\n                    <Form.Control\r\n                      type=\"date\"\r\n                      value={filters.start_date_from}\r\n                      onChange={(e) => setFilters(prev => ({ \r\n                        ...prev, \r\n                        start_date_from: e.target.value \r\n                      }))}\r\n                    />\r\n                  </Form.Group>\r\n                </Col>\r\n                \r\n                <Col md={2}>\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Label>Đến ngày</Form.Label>\r\n                    <Form.Control\r\n                      type=\"date\"\r\n                      value={filters.start_date_to}\r\n                      onChange={(e) => setFilters(prev => ({ \r\n                        ...prev, \r\n                        start_date_to: e.target.value \r\n                      }))}\r\n                    />\r\n                  </Form.Group>\r\n                </Col>\r\n                \r\n                <Col md={1} className=\"d-flex align-items-end\">\r\n                  <Button \r\n                    variant=\"outline-secondary\" \r\n                    onClick={() => setFilters({\r\n                      search: '',\r\n                      status: '',\r\n                      workflow_stage: '',\r\n                      start_date_from: '',\r\n                      start_date_to: ''\r\n                    })}\r\n                  >\r\n                    <i className=\"fas fa-undo\"></i>\r\n                  </Button>\r\n                </Col>\r\n              </Row>\r\n            </Card.Body>\r\n          </Card>\r\n\r\n          {/* Contracts Table */}\r\n          <Card>\r\n            <Card.Header className=\"d-flex justify-content-between align-items-center\">\r\n              <h5 className=\"mb-0\">\r\n                Danh sách hợp đồng ({pagination.total})\r\n              </h5>\r\n              \r\n              <div className=\"d-flex gap-2\">\r\n                <Button variant=\"outline-primary\" size=\"sm\">\r\n                  <i className=\"fas fa-download me-2\"></i>\r\n                  Xuất Excel\r\n                </Button>\r\n                <Button variant=\"outline-secondary\" size=\"sm\" onClick={() => loadContracts(pagination.page)}>\r\n                  <i className=\"fas fa-sync-alt\"></i>\r\n                </Button>\r\n              </div>\r\n            </Card.Header>\r\n            \r\n            <Card.Body className=\"p-0\">\r\n              {loading ? (\r\n                <div className=\"text-center p-4\">\r\n                  <LoadingSpinner />\r\n                </div>\r\n              ) : (\r\n                renderError ? (\r\n                  <div className=\"p-4\">\r\n                    <div className=\"alert alert-danger\">\r\n                      <strong>Lỗi hiển thị danh sách hợp đồng:</strong>\r\n                      <div>{String(renderError)}</div>\r\n                    </div>\r\n                    <div className=\"text-muted\">Vui lòng tải lại trang hoặc liên hệ admin.</div>\r\n                  </div>\r\n                ) : (\r\n                <Table responsive hover className=\"mb-0\">\r\n                  <thead className=\"table-light\">\r\n                    <tr>\r\n                      <th>Số hợp đồng</th>\r\n                      <th>Khách hàng</th>\r\n                      <th>Dự án</th>\r\n                      <th>Diện tích</th>\r\n                      <th>Giá thuê/tháng</th>\r\n                      <th>Thời hạn</th>\r\n                      <th>Trạng thái</th>\r\n                      <th>Giai đoạn</th>\r\n                      <th>Người phụ trách</th>\r\n                      <th>Thao tác</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {(() => {\r\n                      try {\r\n                        return (filteredContracts || []).map(contract => (\r\n                          <tr key={contract.id}>\r\n                            <td>\r\n                              <strong>{contract.contract_number}</strong>\r\n                              <br/>\r\n                              <small className=\"text-muted\">\r\n                                {contract.created_at ? new Date(contract.created_at).toLocaleDateString('vi-VN') : ''}\r\n                              </small>\r\n                            </td>\r\n                            <td>\r\n                              <div>\r\n                                <strong>{contract.customer_company_name || contract.company_name}</strong>\r\n                                <br/>\r\n                                <small className=\"text-muted\">{contract.customer_name}</small>\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              <div>\r\n                                <strong>{contract.project_name || 'Chưa phân bổ'}</strong>\r\n                                <br/>\r\n                                <small className=\"text-muted\">{contract.warehouse_location}</small>\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              {contract.warehouse_area ?? 'N/A'} m²\r\n                            </td>\r\n                            <td>\r\n                              {formatCurrency(contract.rental_price ?? 0)}\r\n                              <br/>\r\n                              <small className=\"text-muted\">\r\n                                {contract.warehouse_area ? formatCurrency((contract.rental_price ?? 0) / contract.warehouse_area) + '/m²' : 'N/A'}\r\n                              </small>\r\n                            </td>\r\n                            <td>\r\n                              {contract.start_date ? new Date(contract.start_date).toLocaleDateString('vi-VN') : ''}\r\n                              <br/>\r\n                              <small className=\"text-muted\">\r\n                                → {contract.end_date ? new Date(contract.end_date).toLocaleDateString('vi-VN') : ''}\r\n                              </small>\r\n                            </td>\r\n                            <td>\r\n                              <Badge bg={contractStatuses[contract.status]?.variant || 'secondary'}>\r\n                                {contractStatuses[contract.status]?.label || contract.status}\r\n                              </Badge>\r\n                            </td>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center\">\r\n                                <i className={`${workflowStages[contract.workflow_stage]?.icon} me-2`}></i>\r\n                                <small>{workflowStages[contract.workflow_stage]?.label}</small>\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              {contract.assigned_to_name ? (\r\n                                <Badge bg=\"info\">{contract.assigned_to_name}</Badge>\r\n                              ) : (\r\n                                <span className=\"text-muted\">Chưa giao</span>\r\n                              )}\r\n                            </td>\r\n                            <td>\r\n                              <div className=\"d-flex gap-1\">\r\n                                <OverlayTrigger \r\n                                  overlay={<Tooltip>Xem chi tiết</Tooltip>}\r\n                                >\r\n                                  <Button \r\n                                    variant=\"outline-primary\" \r\n                                    size=\"sm\"\r\n                                    onClick={() => viewContractDetails(contract.id)}\r\n                                  >\r\n                                    <i className=\"fas fa-eye\"></i>\r\n                                  </Button>\r\n                                </OverlayTrigger>\r\n                                \r\n                                {hasPermission('contract_update') && (\r\n                                  <Dropdown>\r\n                                    <Dropdown.Toggle \r\n                                      variant=\"outline-secondary\" \r\n                                      size=\"sm\"\r\n                                      id={`dropdown-${contract.id}`}\r\n                                    >\r\n                                      <i className=\"fas fa-cog\"></i>\r\n                                    </Dropdown.Toggle>\r\n                                    <Dropdown.Menu>\r\n                                      <Dropdown.Item \r\n                                        onClick={() => handleStatusChange(contract.id, 'review', 'legal_review')}\r\n                                      >\r\n                                        <i className=\"fas fa-eye me-2\"></i>\r\n                                        Gửi xem xét\r\n                                      </Dropdown.Item>\r\n                                      <Dropdown.Item \r\n                                        onClick={() => handleStatusChange(contract.id, 'approved', 'signing')}\r\n                                      >\r\n                                        <i className=\"fas fa-check me-2\"></i>\r\n                                        Phê duyệt\r\n                                      </Dropdown.Item>\r\n                                      <Dropdown.Item \r\n                                        onClick={() => handleStatusChange(contract.id, 'signed', 'execution')}\r\n                                      >\r\n                                        <i className=\"fas fa-signature me-2\"></i>\r\n                                        Đã ký\r\n                                      </Dropdown.Item>\r\n                                      <Dropdown.Divider />\r\n                                      <Dropdown.Item className=\"text-danger\">\r\n                                        <i className=\"fas fa-trash me-2\"></i>\r\n                                        Hủy bỏ\r\n                                      </Dropdown.Item>\r\n                                    </Dropdown.Menu>\r\n                                  </Dropdown>\r\n                                )}\r\n                              </div>\r\n                            </td>\r\n                          </tr>\r\n                        ));\r\n                      } catch (err) {\r\n                        console.error('Render error in ContractManager:', err);\r\n                        setRenderError(err?.message || String(err));\r\n                        return null;\r\n                      }\r\n                    })()}\r\n                  </tbody>\r\n                </Table>\r\n               )\r\n             )}\r\n            </Card.Body>\r\n            \r\n            {/* Pagination */}\r\n            {pagination.pages > 1 && (\r\n              <Card.Footer>\r\n                <div className=\"d-flex justify-content-between align-items-center\">\r\n                  <small className=\"text-muted\">\r\n                    Hiển thị {((pagination.page - 1) * pagination.limit) + 1} - {Math.min(pagination.page * pagination.limit, pagination.total)} \r\n                    trong tổng số {pagination.total} hợp đồng\r\n                  </small>\r\n                  \r\n                  <div className=\"d-flex gap-2\">\r\n                    <Button \r\n                      variant=\"outline-secondary\" \r\n                      size=\"sm\"\r\n                      disabled={pagination.page === 1}\r\n                      onClick={() => setPagination(prev => ({ ...prev, page: prev.page - 1 }))}\r\n                    >\r\n                      <i className=\"fas fa-chevron-left\"></i>\r\n                    </Button>\r\n                    \r\n                    <span className=\"d-flex align-items-center px-3\">\r\n                      Trang {pagination.page} / {pagination.pages}\r\n                    </span>\r\n                    \r\n                    <Button \r\n                      variant=\"outline-secondary\" \r\n                      size=\"sm\"\r\n                      disabled={pagination.page === pagination.pages}\r\n                      onClick={() => setPagination(prev => ({ ...prev, page: prev.page + 1 }))}\r\n                    >\r\n                      <i className=\"fas fa-chevron-right\"></i>\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </Card.Footer>\r\n            )}\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Create Contract Modal */}\r\n      <ContractCreator\r\n        show={showCreateModal}\r\n        initialCustomerId={initialCustomerId}\r\n        onHide={() => setShowCreateModal(false)}\r\n        onSuccess={() => {\r\n          setShowCreateModal(false);\r\n          loadContracts(pagination.page);\r\n        }}\r\n      />\r\n\r\n      {/* Contract Detail Modal */}\r\n      {selectedContract && (\r\n        <Modal \r\n          show={showDetailModal} \r\n          onHide={() => setShowDetailModal(false)} \r\n          size=\"xl\"\r\n          scrollable\r\n        >\r\n          <Modal.Header closeButton>\r\n            <Modal.Title>\r\n              Chi tiết hợp đồng {selectedContract.contract.contract_number}\r\n            </Modal.Title>\r\n          </Modal.Header>\r\n          <Modal.Body>\r\n            <ContractDetailView contract={selectedContract} />\r\n          </Modal.Body>\r\n        </Modal>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n// Contract Detail Component  \r\nconst ContractDetailView = ({ contract }) => {\r\n  return (\r\n    <Tabs defaultActiveKey=\"overview\" id=\"contract-detail-tabs\">\r\n      <Tab eventKey=\"overview\" title=\"Tổng quan\">\r\n        <div className=\"pt-3\">\r\n          <Row>\r\n            <Col md={6}>\r\n              <h5>Thông tin hợp đồng</h5>\r\n              <Table size=\"sm\">\r\n                <tbody>\r\n                  <tr>\r\n                    <td><strong>Số hợp đồng:</strong></td>\r\n                    <td>{contract.contract.contract_number}</td>\r\n                  </tr>\r\n                  <tr>\r\n                    <td><strong>Tiêu đề:</strong></td>\r\n                    <td>{contract.contract.contract_title}</td>\r\n                  </tr>\r\n                  <tr>\r\n                    <td><strong>Dự án:</strong></td>\r\n                    <td>{contract.contract.project_name || 'Chưa phân bổ'}</td>\r\n                  </tr>\r\n                  <tr>\r\n                    <td><strong>Kho:</strong></td>\r\n                    <td>{contract.contract.warehouse_location}</td>\r\n                  </tr>\r\n                  <tr>\r\n                    <td><strong>Diện tích:</strong></td>\r\n                    <td>{contract.contract.warehouse_area} m²</td>\r\n                  </tr>\r\n                  <tr>\r\n                    <td><strong>Giá thuê:</strong></td>\r\n                    <td>{new Intl.NumberFormat('vi-VN').format(contract.contract.rental_price)} VNĐ/tháng</td>\r\n                  </tr>\r\n                </tbody>\r\n              </Table>\r\n            </Col>\r\n            <Col md={6}>\r\n              <h5>Thông tin khách hàng</h5>\r\n              <Table size=\"sm\">\r\n                <tbody>\r\n                  <tr>\r\n                    <td><strong>Công ty:</strong></td>\r\n                    <td>{contract.contract.customer_company_name}</td>\r\n                  </tr>\r\n                  <tr>\r\n                    <td><strong>Người liên hệ:</strong></td>\r\n                    <td>{contract.contract.customer_name}</td>\r\n                  </tr>\r\n                  <tr>\r\n                    <td><strong>Điện thoại:</strong></td>\r\n                    <td>{contract.contract.customer_phone}</td>\r\n                  </tr>\r\n                  <tr>\r\n                    <td><strong>Email:</strong></td>\r\n                    <td>{contract.contract.customer_email}</td>\r\n                  </tr>\r\n                  <tr>\r\n                    <td><strong>Mã số thuế:</strong></td>\r\n                    <td>{contract.contract.tax_code}</td>\r\n                  </tr>\r\n                </tbody>\r\n              </Table>\r\n            </Col>\r\n          </Row>\r\n        </div>\r\n      </Tab>\r\n      \r\n      <Tab eventKey=\"documents\" title={`Tài liệu (${contract.documents?.length || 0})`}>\r\n        <div className=\"pt-3\">\r\n          {contract.documents?.length > 0 ? (\r\n            <Table>\r\n              <thead>\r\n                <tr>\r\n                  <th>Tên tài liệu</th>\r\n                  <th>Loại</th>\r\n                  <th>Phiên bản</th>\r\n                  <th>Trạng thái</th>\r\n                  <th>Ngày tạo</th>\r\n                  <th>Thao tác</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {contract.documents.map(doc => (\r\n                  <tr key={doc.id}>\r\n                    <td>{doc.document_name}</td>\r\n                    <td>\r\n                      <Badge bg=\"info\">{doc.category_name}</Badge>\r\n                    </td>\r\n                    <td>v{doc.version}</td>\r\n                    <td>\r\n                      <Badge \r\n                        bg={doc.status === 'final' ? 'success' : \r\n                            doc.status === 'draft' ? 'secondary' : 'warning'}\r\n                      >\r\n                        {doc.status}\r\n                      </Badge>\r\n                    </td>\r\n                    <td>{new Date(doc.created_at).toLocaleDateString('vi-VN')}</td>\r\n                    <td>\r\n                      <Button variant=\"outline-primary\" size=\"sm\">\r\n                        <i className=\"fas fa-eye\"></i>\r\n                      </Button>\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </Table>\r\n          ) : (\r\n            <div className=\"text-center text-muted py-4\">\r\n              Chưa có tài liệu nào\r\n            </div>\r\n          )}\r\n        </div>\r\n      </Tab>\r\n      \r\n      <Tab eventKey=\"history\" title=\"Lịch sử\">\r\n        <div className=\"pt-3\">\r\n          {contract.workflow_history?.length > 0 ? (\r\n            <div className=\"timeline\">\r\n              {contract.workflow_history.map(history => (\r\n                <div key={history.id} className=\"timeline-item mb-3\">\r\n                  <div className=\"d-flex\">\r\n                    <div className=\"flex-shrink-0\">\r\n                      <div className=\"rounded-circle bg-primary text-white d-flex align-items-center justify-content-center\" style={{width: '40px', height: '40px'}}>\r\n                        <i className=\"fas fa-user fa-sm\"></i>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex-grow-1 ms-3\">\r\n                      <div className=\"d-flex justify-content-between\">\r\n                        <h6 className=\"mb-1\">{history.action}</h6>\r\n                        <small className=\"text-muted\">{new Date(history.performed_at).toLocaleString('vi-VN')}</small>\r\n                      </div>\r\n                      <p className=\"mb-1\">{history.comment}</p>\r\n                      <small className=\"text-muted\">Bởi: {history.performed_by_name}</small>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <div className=\"text-center text-muted py-4\">\r\n              Chưa có lịch sử nào\r\n            </div>\r\n          )}\r\n        </div>\r\n      </Tab>\r\n    </Tabs>\r\n  );\r\n};\r\n\r\nexport default ContractManager;"],"mappings":"6JAAA;AACA;AACA,GAEA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,WAAW,KAAQ,OAAO,CAC/D,OACEC,SAAS,CAAEC,GAAG,CAAEC,GAAG,CAAEC,IAAI,CAAEC,MAAM,CAAEC,KAAK,CAAEC,KAAK,CAAEC,IAAI,CACrDC,KAAK,CAAEC,IAAI,CAAEC,GAAG,CAAEC,QAAQ,CAAEC,cAAc,CAAEC,OAAO,KAC9C,iBAAiB,CACxB,OAASC,OAAO,KAAQ,4BAA4B,CACpD,OAASC,eAAe,KAAQ,oCAAoC,CACpE,MAAO,CAAAC,cAAc,KAAM,0BAA0B,CACrD,MAAO,CAAAC,eAAe,KAAM,mBAAmB,CAC/C,MAAO,CAAAC,eAAe,KAAM,gCAAgC,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE7D,KAAM,CAAAC,eAAe,CAAGC,IAAA,EAA2D,IAA1D,CAAEC,iBAAiB,CAAG,KAAK,CAAEC,iBAAiB,CAAG,EAAG,CAAC,CAAAF,IAAA,CAC5E,KAAM,CAAEG,aAAc,CAAC,CAAGb,OAAO,CAAC,CAAC,CACnC,KAAM,CAAEc,WAAW,CAAEC,SAAU,CAAC,CAAGd,eAAe,CAAC,CAAC,CAEpD,KAAM,CAACe,OAAO,CAAEC,UAAU,CAAC,CAAGlC,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACmC,SAAS,CAAEC,YAAY,CAAC,CAAGpC,QAAQ,CAAC,EAAE,CAAC,CAC9C,KAAM,CAACqC,iBAAiB,CAAEC,oBAAoB,CAAC,CAAGtC,QAAQ,CAAC,EAAE,CAAC,CAC9D,KAAM,CAACuC,eAAe,CAAEC,kBAAkB,CAAC,CAAGxC,QAAQ,CAAC,CAAC,CAAC4B,iBAAiB,CAAC,CAC3E,KAAM,CAACa,gBAAgB,CAAEC,mBAAmB,CAAC,CAAG1C,QAAQ,CAAC,IAAI,CAAC,CAC9D,KAAM,CAAC2C,eAAe,CAAEC,kBAAkB,CAAC,CAAG5C,QAAQ,CAAC,KAAK,CAAC,CAC7D,KAAM,CAAC6C,WAAW,CAAEC,cAAc,CAAC,CAAG9C,QAAQ,CAAC,IAAI,CAAC,CAEpD,KAAM,CAAC+C,OAAO,CAAEC,UAAU,CAAC,CAAGhD,QAAQ,CAAC,CACrCiD,MAAM,CAAE,EAAE,CACVC,MAAM,CAAE,EAAE,CACVC,cAAc,CAAE,EAAE,CAClBC,eAAe,CAAE,EAAE,CACnBC,aAAa,CAAE,EACjB,CAAC,CAAC,CAEF,KAAM,CAACC,UAAU,CAAEC,aAAa,CAAC,CAAGvD,QAAQ,CAAC,CAC3CwD,IAAI,CAAE,CAAC,CACPC,KAAK,CAAE,EAAE,CACTC,KAAK,CAAE,CAAC,CACRC,KAAK,CAAE,CACT,CAAC,CAAC,CAEF;AACA,KAAM,CAAAC,gBAAgB,CAAG,CACvBC,KAAK,CAAE,CAAEC,KAAK,CAAE,UAAU,CAAEC,OAAO,CAAE,WAAY,CAAC,CAClDC,MAAM,CAAE,CAAEF,KAAK,CAAE,cAAc,CAAEC,OAAO,CAAE,MAAO,CAAC,CAClDE,QAAQ,CAAE,CAAEH,KAAK,CAAE,UAAU,CAAEC,OAAO,CAAE,SAAU,CAAC,CACnDG,MAAM,CAAE,CAAEJ,KAAK,CAAE,OAAO,CAAEC,OAAO,CAAE,SAAU,CAAC,CAC9CI,MAAM,CAAE,CAAEL,KAAK,CAAE,eAAe,CAAEC,OAAO,CAAE,SAAU,CAAC,CACtDK,OAAO,CAAE,CAAEN,KAAK,CAAE,SAAS,CAAEC,OAAO,CAAE,SAAU,CAAC,CACjDM,UAAU,CAAE,CAAEP,KAAK,CAAE,UAAU,CAAEC,OAAO,CAAE,QAAS,CAAC,CACpDO,SAAS,CAAE,CAAER,KAAK,CAAE,QAAQ,CAAEC,OAAO,CAAE,MAAO,CAChD,CAAC,CAED,KAAM,CAAAQ,cAAc,CAAG,CACrBC,WAAW,CAAE,CAAEV,KAAK,CAAE,UAAU,CAAEW,IAAI,CAAE,aAAc,CAAC,CACvDC,YAAY,CAAE,CAAEZ,KAAK,CAAE,iBAAiB,CAAEW,IAAI,CAAE,sBAAuB,CAAC,CACxEE,QAAQ,CAAE,CAAEb,KAAK,CAAE,WAAW,CAAEW,IAAI,CAAE,qBAAsB,CAAC,CAC7DG,OAAO,CAAE,CAAEd,KAAK,CAAE,QAAQ,CAAEW,IAAI,CAAE,kBAAmB,CAAC,CACtDI,SAAS,CAAE,CAAEf,KAAK,CAAE,UAAU,CAAEW,IAAI,CAAE,oBAAqB,CAC7D,CAAC,CAED;AACA,KAAM,CAAAK,aAAa,CAAG5E,WAAW,CAAC,gBAAoB,IAAb,CAAAsD,IAAI,CAAAuB,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,CAAC,CAC/C,GAAI,CACF7C,UAAU,CAAC,IAAI,CAAC,CAChB,KAAM,CAAAgD,MAAM,CAAAC,aAAA,EACV3B,IAAI,CAAEA,IAAI,CAAC4B,QAAQ,CAAC,CAAC,CACrB3B,KAAK,CAAEH,UAAU,CAACG,KAAK,CAAC2B,QAAQ,CAAC,CAAC,EAC/BrC,OAAO,CACX,CAED;AACAsC,MAAM,CAACC,IAAI,CAACJ,MAAM,CAAC,CAACK,OAAO,CAACC,GAAG,EAAI,CACjC,GAAI,CAACN,MAAM,CAACM,GAAG,CAAC,CAAE,MAAO,CAAAN,MAAM,CAACM,GAAG,CAAC,CACtC,CAAC,CAAC,CAEF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAApE,eAAe,CAACqE,YAAY,CAACR,MAAM,CAAC,CAE3D,GAAIO,QAAQ,EAAIA,QAAQ,CAACE,OAAO,CAAE,CAChC,KAAM,CAAAC,aAAa,CAAGC,KAAK,CAACC,OAAO,CAACL,QAAQ,CAACM,IAAI,CAAC5D,SAAS,CAAC,CAAGsD,QAAQ,CAACM,IAAI,CAAC5D,SAAS,CAAG,EAAE,CAC3F,KAAM,CAAA6D,cAAc,CAAGP,QAAQ,CAACM,IAAI,CAACzC,UAAU,EAAI,CAAEE,IAAI,CAAE,CAAC,CAAEC,KAAK,CAAE,EAAE,CAAEC,KAAK,CAAEkC,aAAa,CAACZ,MAAM,CAAErB,KAAK,CAAE,CAAE,CAAC,CAEhHvB,YAAY,CAACwD,aAAa,CAAC,CAC3BtD,oBAAoB,CAACsD,aAAa,CAAC,CACnCrC,aAAa,CAACyC,cAAc,CAAC,CAC/B,CAAC,IAAM,CACLhE,SAAS,CAACyD,QAAQ,CAACQ,OAAO,EAAI,kCAAkC,CAAC,CACnE,CACF,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACC,IAAI,CAAC,yBAAyB,CAAE,CAAAF,KAAK,SAALA,KAAK,iBAALA,KAAK,CAAED,OAAO,GAAIC,KAAK,CAAC,CAChE;AACF,CAAC,OAAS,CACRhE,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAAE,CAACa,OAAO,CAAEO,UAAU,CAACG,KAAK,CAAEzB,SAAS,CAAC,CAAC,CAE1C/B,SAAS,CAAC,IAAM,CACd,GAAI6B,aAAa,CAAC,eAAe,CAAC,CAAE,CAClCgD,aAAa,CAAC,CAAC,CACjB,CACF,CAAC,CAAE,CAAChD,aAAa,CAAEgD,aAAa,CAAExB,UAAU,CAACE,IAAI,CAAC,CAAC,CAEnD;AACAvD,SAAS,CAAC,IAAM,CACd;AACA,KAAM,CAAAoG,SAAS,CAAGC,UAAU,CAAC,IAAM,CACjC,GAAIhD,UAAU,CAACE,IAAI,GAAK,CAAC,CAAE,CACzBsB,aAAa,CAAC,CAAC,CAAC,CAClB,CAAC,IAAM,CACLvB,aAAa,CAACgD,IAAI,EAAApB,aAAA,CAAAA,aAAA,IAAUoB,IAAI,MAAE/C,IAAI,CAAE,CAAC,EAAG,CAAC,CAC7CsB,aAAa,CAAC,CAAC,CAAC,CAClB,CACF,CAAC,CAAE,GAAG,CAAC,CAEP,MAAO,IAAM0B,YAAY,CAACH,SAAS,CAAC,CACtC,CAAC,CAAE,CAACtD,OAAO,CAAC,CAAC,CAEb;AACA,KAAM,CAAA0D,cAAc,CAAIC,MAAM,EAAK,CACjC,MAAO,IAAI,CAAAC,IAAI,CAACC,YAAY,CAAC,OAAO,CAAE,CACpCC,KAAK,CAAE,UAAU,CACjBC,QAAQ,CAAE,KACZ,CAAC,CAAC,CAACC,MAAM,CAACL,MAAM,CAAC,CACnB,CAAC,CAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA,KAAM,CAAAM,kBAAkB,CAAG,KAAAA,CAAOC,UAAU,CAAEC,SAAS,CAAEC,QAAQ,GAAK,CACpE,GAAI,KAAAC,qBAAA,CACF,KAAM,CAAAC,UAAU,CAAG,CACjBnE,MAAM,CAAEgE,SAAS,CACjB/D,cAAc,CAAEgE,QAAQ,CACxBG,OAAO,wCAAAC,MAAA,EAAAH,qBAAA,CAA4BxD,gBAAgB,CAACsD,SAAS,CAAC,UAAAE,qBAAA,iBAA3BA,qBAAA,CAA6BtD,KAAK,CACvE,CAAC,CAED,KAAM,CAAA2B,QAAQ,CAAG,KAAM,CAAApE,eAAe,CAACmG,oBAAoB,CAACP,UAAU,CAAEI,UAAU,CAAC,CAEnF,GAAI5B,QAAQ,CAACE,OAAO,CAAE,CACpB5D,WAAW,CAAC,gCAAgC,CAAC,CAC7C+C,aAAa,CAACxB,UAAU,CAACE,IAAI,CAAC,CAChC,CAAC,IAAM,CACLxB,SAAS,CAACyD,QAAQ,CAACQ,OAAO,EAAI,+BAA+B,CAAC,CAChE,CACF,CAAE,MAAOC,KAAK,CAAE,CACdlE,SAAS,CAAC,eAAe,CAAGkE,KAAK,CAACD,OAAO,CAAC,CAC5C,CACF,CAAC,CAED;AACA,KAAM,CAAAwB,mBAAmB,CAAG,KAAO,CAAAR,UAAU,EAAK,CAChD,GAAI,CACF,KAAM,CAAAxB,QAAQ,CAAG,KAAM,CAAApE,eAAe,CAACqG,WAAW,CAACT,UAAU,CAAC,CAE9D,GAAIxB,QAAQ,CAACE,OAAO,CAAE,CACpBjD,mBAAmB,CAAC+C,QAAQ,CAACM,IAAI,CAAC,CAClCnD,kBAAkB,CAAC,IAAI,CAAC,CAC1B,CAAC,IAAM,CACLZ,SAAS,CAACyD,QAAQ,CAACQ,OAAO,EAAI,iCAAiC,CAAC,CAClE,CACF,CAAE,MAAOC,KAAK,CAAE,CACdlE,SAAS,CAAC,eAAe,CAAGkE,KAAK,CAACD,OAAO,CAAC,CAC5C,CACF,CAAC,CAED,GAAI,CAACnE,aAAa,CAAC,eAAe,CAAC,CAAE,CACnC,mBACEP,IAAA,CAACpB,SAAS,EAACwH,SAAS,CAAC,MAAM,CAAAC,QAAA,cACzBrG,IAAA,QAAKoG,SAAS,CAAC,qBAAqB,CAAAC,QAAA,CAAC,2FAErC,CAAK,CAAC,CACG,CAAC,CAEhB,CAEA,mBACEnG,KAAA,QAAKkG,SAAS,CAAC,MAAM,CAAAC,QAAA,eACnBrG,IAAA,CAACnB,GAAG,EAAAwH,QAAA,cACFnG,KAAA,CAACpB,GAAG,EAAAuH,QAAA,eAEFnG,KAAA,QAAKkG,SAAS,CAAC,wDAAwD,CAAAC,QAAA,eACrEnG,KAAA,OAAAmG,QAAA,eACErG,IAAA,MAAGoG,SAAS,CAAC,2BAA2B,CAAI,CAAC,0CAE/C,EAAI,CAAC,CAEJ7F,aAAa,CAAC,iBAAiB,CAAC,eAC/BL,KAAA,CAAClB,MAAM,EACLwD,OAAO,CAAC,SAAS,CACjB8D,OAAO,CAAEA,CAAA,GAAMrF,kBAAkB,CAAC,IAAI,CAAE,CAAAoF,QAAA,eAExCrG,IAAA,MAAGoG,SAAS,CAAC,kBAAkB,CAAI,CAAC,4CAEtC,EAAQ,CACT,EACE,CAAC,cAGNlG,KAAA,CAACnB,IAAI,EAACqH,SAAS,CAAC,MAAM,CAAAC,QAAA,eACpBrG,IAAA,CAACjB,IAAI,CAACwH,MAAM,EAAAF,QAAA,cACVnG,KAAA,OAAIkG,SAAS,CAAC,MAAM,CAAAC,QAAA,eAClBrG,IAAA,MAAGoG,SAAS,CAAC,oBAAoB,CAAI,CAAC,mBAExC,EAAI,CAAC,CACM,CAAC,cACdpG,IAAA,CAACjB,IAAI,CAACyH,IAAI,EAAAH,QAAA,cACRnG,KAAA,CAACrB,GAAG,EAAAwH,QAAA,eACFrG,IAAA,CAAClB,GAAG,EAAC2H,EAAE,CAAE,CAAE,CAAAJ,QAAA,cACTnG,KAAA,CAACf,IAAI,CAACuH,KAAK,EAACN,SAAS,CAAC,MAAM,CAAAC,QAAA,eAC1BrG,IAAA,CAACb,IAAI,CAACwH,KAAK,EAAAN,QAAA,CAAC,kBAAQ,CAAY,CAAC,cACjCrG,IAAA,CAACb,IAAI,CAACyH,OAAO,EACXC,IAAI,CAAC,MAAM,CACXC,WAAW,CAAC,6CAA0B,CACtCC,KAAK,CAAEvF,OAAO,CAACE,MAAO,CACtBsF,QAAQ,CAAGC,CAAC,EAAKxF,UAAU,CAACuD,IAAI,EAAApB,aAAA,CAAAA,aAAA,IAC3BoB,IAAI,MACPtD,MAAM,CAAEuF,CAAC,CAACC,MAAM,CAACH,KAAK,EACtB,CAAE,CACL,CAAC,EACQ,CAAC,CACV,CAAC,cAEN/G,IAAA,CAAClB,GAAG,EAAC2H,EAAE,CAAE,CAAE,CAAAJ,QAAA,cACTnG,KAAA,CAACf,IAAI,CAACuH,KAAK,EAACN,SAAS,CAAC,MAAM,CAAAC,QAAA,eAC1BrG,IAAA,CAACb,IAAI,CAACwH,KAAK,EAAAN,QAAA,CAAC,oBAAU,CAAY,CAAC,cACnCnG,KAAA,CAACf,IAAI,CAACgI,MAAM,EACVJ,KAAK,CAAEvF,OAAO,CAACG,MAAO,CACtBqF,QAAQ,CAAGC,CAAC,EAAKxF,UAAU,CAACuD,IAAI,EAAApB,aAAA,CAAAA,aAAA,IAC3BoB,IAAI,MACPrD,MAAM,CAAEsF,CAAC,CAACC,MAAM,CAACH,KAAK,EACtB,CAAE,CAAAV,QAAA,eAEJrG,IAAA,WAAQ+G,KAAK,CAAC,EAAE,CAAAV,QAAA,CAAC,kBAAM,CAAQ,CAAC,CAC/BvC,MAAM,CAACsD,OAAO,CAAC/E,gBAAgB,CAAC,CAACgF,GAAG,CAACC,KAAA,MAAC,CAACrD,GAAG,CAAEtC,MAAM,CAAC,CAAA2F,KAAA,oBAClDtH,IAAA,WAAkB+G,KAAK,CAAE9C,GAAI,CAAAoC,QAAA,CAAE1E,MAAM,CAACY,KAAK,EAA9B0B,GAAuC,CAAC,EACtD,CAAC,EACS,CAAC,EACJ,CAAC,CACV,CAAC,cAENjE,IAAA,CAAClB,GAAG,EAAC2H,EAAE,CAAE,CAAE,CAAAJ,QAAA,cACTnG,KAAA,CAACf,IAAI,CAACuH,KAAK,EAACN,SAAS,CAAC,MAAM,CAAAC,QAAA,eAC1BrG,IAAA,CAACb,IAAI,CAACwH,KAAK,EAAAN,QAAA,CAAC,qBAAS,CAAY,CAAC,cAClCnG,KAAA,CAACf,IAAI,CAACgI,MAAM,EACVJ,KAAK,CAAEvF,OAAO,CAACI,cAAe,CAC9BoF,QAAQ,CAAGC,CAAC,EAAKxF,UAAU,CAACuD,IAAI,EAAApB,aAAA,CAAAA,aAAA,IAC3BoB,IAAI,MACPpD,cAAc,CAAEqF,CAAC,CAACC,MAAM,CAACH,KAAK,EAC9B,CAAE,CAAAV,QAAA,eAEJrG,IAAA,WAAQ+G,KAAK,CAAC,EAAE,CAAAV,QAAA,CAAC,kBAAM,CAAQ,CAAC,CAC/BvC,MAAM,CAACsD,OAAO,CAACpE,cAAc,CAAC,CAACqE,GAAG,CAACE,KAAA,MAAC,CAACtD,GAAG,CAAEuD,KAAK,CAAC,CAAAD,KAAA,oBAC/CvH,IAAA,WAAkB+G,KAAK,CAAE9C,GAAI,CAAAoC,QAAA,CAAEmB,KAAK,CAACjF,KAAK,EAA7B0B,GAAsC,CAAC,EACrD,CAAC,EACS,CAAC,EACJ,CAAC,CACV,CAAC,cAENjE,IAAA,CAAClB,GAAG,EAAC2H,EAAE,CAAE,CAAE,CAAAJ,QAAA,cACTnG,KAAA,CAACf,IAAI,CAACuH,KAAK,EAACN,SAAS,CAAC,MAAM,CAAAC,QAAA,eAC1BrG,IAAA,CAACb,IAAI,CAACwH,KAAK,EAAAN,QAAA,CAAC,iBAAO,CAAY,CAAC,cAChCrG,IAAA,CAACb,IAAI,CAACyH,OAAO,EACXC,IAAI,CAAC,MAAM,CACXE,KAAK,CAAEvF,OAAO,CAACK,eAAgB,CAC/BmF,QAAQ,CAAGC,CAAC,EAAKxF,UAAU,CAACuD,IAAI,EAAApB,aAAA,CAAAA,aAAA,IAC3BoB,IAAI,MACPnD,eAAe,CAAEoF,CAAC,CAACC,MAAM,CAACH,KAAK,EAC/B,CAAE,CACL,CAAC,EACQ,CAAC,CACV,CAAC,cAEN/G,IAAA,CAAClB,GAAG,EAAC2H,EAAE,CAAE,CAAE,CAAAJ,QAAA,cACTnG,KAAA,CAACf,IAAI,CAACuH,KAAK,EAACN,SAAS,CAAC,MAAM,CAAAC,QAAA,eAC1BrG,IAAA,CAACb,IAAI,CAACwH,KAAK,EAAAN,QAAA,CAAC,uBAAQ,CAAY,CAAC,cACjCrG,IAAA,CAACb,IAAI,CAACyH,OAAO,EACXC,IAAI,CAAC,MAAM,CACXE,KAAK,CAAEvF,OAAO,CAACM,aAAc,CAC7BkF,QAAQ,CAAGC,CAAC,EAAKxF,UAAU,CAACuD,IAAI,EAAApB,aAAA,CAAAA,aAAA,IAC3BoB,IAAI,MACPlD,aAAa,CAAEmF,CAAC,CAACC,MAAM,CAACH,KAAK,EAC7B,CAAE,CACL,CAAC,EACQ,CAAC,CACV,CAAC,cAEN/G,IAAA,CAAClB,GAAG,EAAC2H,EAAE,CAAE,CAAE,CAACL,SAAS,CAAC,wBAAwB,CAAAC,QAAA,cAC5CrG,IAAA,CAAChB,MAAM,EACLwD,OAAO,CAAC,mBAAmB,CAC3B8D,OAAO,CAAEA,CAAA,GAAM7E,UAAU,CAAC,CACxBC,MAAM,CAAE,EAAE,CACVC,MAAM,CAAE,EAAE,CACVC,cAAc,CAAE,EAAE,CAClBC,eAAe,CAAE,EAAE,CACnBC,aAAa,CAAE,EACjB,CAAC,CAAE,CAAAuE,QAAA,cAEHrG,IAAA,MAAGoG,SAAS,CAAC,aAAa,CAAI,CAAC,CACzB,CAAC,CACN,CAAC,EACH,CAAC,CACG,CAAC,EACR,CAAC,cAGPlG,KAAA,CAACnB,IAAI,EAAAsH,QAAA,eACHnG,KAAA,CAACnB,IAAI,CAACwH,MAAM,EAACH,SAAS,CAAC,mDAAmD,CAAAC,QAAA,eACxEnG,KAAA,OAAIkG,SAAS,CAAC,MAAM,CAAAC,QAAA,EAAC,wCACC,CAACtE,UAAU,CAACI,KAAK,CAAC,GACxC,EAAI,CAAC,cAELjC,KAAA,QAAKkG,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BnG,KAAA,CAAClB,MAAM,EAACwD,OAAO,CAAC,iBAAiB,CAACiF,IAAI,CAAC,IAAI,CAAApB,QAAA,eACzCrG,IAAA,MAAGoG,SAAS,CAAC,sBAAsB,CAAI,CAAC,kBAE1C,EAAQ,CAAC,cACTpG,IAAA,CAAChB,MAAM,EAACwD,OAAO,CAAC,mBAAmB,CAACiF,IAAI,CAAC,IAAI,CAACnB,OAAO,CAAEA,CAAA,GAAM/C,aAAa,CAACxB,UAAU,CAACE,IAAI,CAAE,CAAAoE,QAAA,cAC1FrG,IAAA,MAAGoG,SAAS,CAAC,iBAAiB,CAAI,CAAC,CAC7B,CAAC,EACN,CAAC,EACK,CAAC,cAEdpG,IAAA,CAACjB,IAAI,CAACyH,IAAI,EAACJ,SAAS,CAAC,KAAK,CAAAC,QAAA,CACvB3F,OAAO,cACNV,IAAA,QAAKoG,SAAS,CAAC,iBAAiB,CAAAC,QAAA,cAC9BrG,IAAA,CAACJ,cAAc,GAAE,CAAC,CACf,CAAC,CAEN0B,WAAW,cACTpB,KAAA,QAAKkG,SAAS,CAAC,KAAK,CAAAC,QAAA,eAClBnG,KAAA,QAAKkG,SAAS,CAAC,oBAAoB,CAAAC,QAAA,eACjCrG,IAAA,WAAAqG,QAAA,CAAQ,mEAAgC,CAAQ,CAAC,cACjDrG,IAAA,QAAAqG,QAAA,CAAMqB,MAAM,CAACpG,WAAW,CAAC,CAAM,CAAC,EAC7B,CAAC,cACNtB,IAAA,QAAKoG,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,sEAA0C,CAAK,CAAC,EACzE,CAAC,cAERnG,KAAA,CAACjB,KAAK,EAAC0I,UAAU,MAACC,KAAK,MAACxB,SAAS,CAAC,MAAM,CAAAC,QAAA,eACtCrG,IAAA,UAAOoG,SAAS,CAAC,aAAa,CAAAC,QAAA,cAC5BnG,KAAA,OAAAmG,QAAA,eACErG,IAAA,OAAAqG,QAAA,CAAI,iCAAW,CAAI,CAAC,cACpBrG,IAAA,OAAAqG,QAAA,CAAI,kBAAU,CAAI,CAAC,cACnBrG,IAAA,OAAAqG,QAAA,CAAI,eAAK,CAAI,CAAC,cACdrG,IAAA,OAAAqG,QAAA,CAAI,mBAAS,CAAI,CAAC,cAClBrG,IAAA,OAAAqG,QAAA,CAAI,yBAAc,CAAI,CAAC,cACvBrG,IAAA,OAAAqG,QAAA,CAAI,oBAAQ,CAAI,CAAC,cACjBrG,IAAA,OAAAqG,QAAA,CAAI,oBAAU,CAAI,CAAC,cACnBrG,IAAA,OAAAqG,QAAA,CAAI,qBAAS,CAAI,CAAC,cAClBrG,IAAA,OAAAqG,QAAA,CAAI,mCAAe,CAAI,CAAC,cACxBrG,IAAA,OAAAqG,QAAA,CAAI,aAAQ,CAAI,CAAC,EACf,CAAC,CACA,CAAC,cACRrG,IAAA,UAAAqG,QAAA,CACG,CAAC,IAAM,CACN,GAAI,CACF,MAAO,CAACvF,iBAAiB,EAAI,EAAE,EAAEuG,GAAG,CAACQ,QAAQ,OAAAC,qBAAA,CAAAC,qBAAA,CAAAC,sBAAA,CAAAC,qBAAA,CAAAC,sBAAA,CAAAC,qBAAA,CAAAC,sBAAA,oBAC3ClI,KAAA,OAAAmG,QAAA,eACEnG,KAAA,OAAAmG,QAAA,eACErG,IAAA,WAAAqG,QAAA,CAASwB,QAAQ,CAACQ,eAAe,CAAS,CAAC,cAC3CrI,IAAA,QAAI,CAAC,cACLA,IAAA,UAAOoG,SAAS,CAAC,YAAY,CAAAC,QAAA,CAC1BwB,QAAQ,CAACS,UAAU,CAAG,GAAI,CAAAC,IAAI,CAACV,QAAQ,CAACS,UAAU,CAAC,CAACE,kBAAkB,CAAC,OAAO,CAAC,CAAG,EAAE,CAChF,CAAC,EACN,CAAC,cACLxI,IAAA,OAAAqG,QAAA,cACEnG,KAAA,QAAAmG,QAAA,eACErG,IAAA,WAAAqG,QAAA,CAASwB,QAAQ,CAACY,qBAAqB,EAAIZ,QAAQ,CAACa,YAAY,CAAS,CAAC,cAC1E1I,IAAA,QAAI,CAAC,cACLA,IAAA,UAAOoG,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAEwB,QAAQ,CAACc,aAAa,CAAQ,CAAC,EAC3D,CAAC,CACJ,CAAC,cACL3I,IAAA,OAAAqG,QAAA,cACEnG,KAAA,QAAAmG,QAAA,eACErG,IAAA,WAAAqG,QAAA,CAASwB,QAAQ,CAACe,YAAY,EAAI,cAAc,CAAS,CAAC,cAC1D5I,IAAA,QAAI,CAAC,cACLA,IAAA,UAAOoG,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAEwB,QAAQ,CAACgB,kBAAkB,CAAQ,CAAC,EAChE,CAAC,CACJ,CAAC,cACL3I,KAAA,OAAAmG,QAAA,GAAAyB,qBAAA,CACGD,QAAQ,CAACiB,cAAc,UAAAhB,qBAAA,UAAAA,qBAAA,CAAI,KAAK,CAAC,QACpC,EAAI,CAAC,cACL5H,KAAA,OAAAmG,QAAA,EACGnB,cAAc,EAAA6C,qBAAA,CAACF,QAAQ,CAACkB,YAAY,UAAAhB,qBAAA,UAAAA,qBAAA,CAAI,CAAC,CAAC,cAC3C/H,IAAA,QAAI,CAAC,cACLA,IAAA,UAAOoG,SAAS,CAAC,YAAY,CAAAC,QAAA,CAC1BwB,QAAQ,CAACiB,cAAc,CAAG5D,cAAc,CAAC,EAAA8C,sBAAA,CAACH,QAAQ,CAACkB,YAAY,UAAAf,sBAAA,UAAAA,sBAAA,CAAI,CAAC,EAAIH,QAAQ,CAACiB,cAAc,CAAC,CAAG,KAAK,CAAG,KAAK,CAC5G,CAAC,EACN,CAAC,cACL5I,KAAA,OAAAmG,QAAA,EACGwB,QAAQ,CAACmB,UAAU,CAAG,GAAI,CAAAT,IAAI,CAACV,QAAQ,CAACmB,UAAU,CAAC,CAACR,kBAAkB,CAAC,OAAO,CAAC,CAAG,EAAE,cACrFxI,IAAA,QAAI,CAAC,cACLE,KAAA,UAAOkG,SAAS,CAAC,YAAY,CAAAC,QAAA,EAAC,SAC1B,CAACwB,QAAQ,CAACoB,QAAQ,CAAG,GAAI,CAAAV,IAAI,CAACV,QAAQ,CAACoB,QAAQ,CAAC,CAACT,kBAAkB,CAAC,OAAO,CAAC,CAAG,EAAE,EAC9E,CAAC,EACN,CAAC,cACLxI,IAAA,OAAAqG,QAAA,cACErG,IAAA,CAACd,KAAK,EAACgK,EAAE,CAAE,EAAAjB,qBAAA,CAAA5F,gBAAgB,CAACwF,QAAQ,CAAClG,MAAM,CAAC,UAAAsG,qBAAA,iBAAjCA,qBAAA,CAAmCzF,OAAO,GAAI,WAAY,CAAA6D,QAAA,CAClE,EAAA6B,sBAAA,CAAA7F,gBAAgB,CAACwF,QAAQ,CAAClG,MAAM,CAAC,UAAAuG,sBAAA,iBAAjCA,sBAAA,CAAmC3F,KAAK,GAAIsF,QAAQ,CAAClG,MAAM,CACvD,CAAC,CACN,CAAC,cACL3B,IAAA,OAAAqG,QAAA,cACEnG,KAAA,QAAKkG,SAAS,CAAC,2BAA2B,CAAAC,QAAA,eACxCrG,IAAA,MAAGoG,SAAS,IAAAJ,MAAA,EAAAmC,qBAAA,CAAKnF,cAAc,CAAC6E,QAAQ,CAACjG,cAAc,CAAC,UAAAuG,qBAAA,iBAAvCA,qBAAA,CAAyCjF,IAAI,SAAQ,CAAI,CAAC,cAC3ElD,IAAA,UAAAqG,QAAA,EAAA+B,sBAAA,CAAQpF,cAAc,CAAC6E,QAAQ,CAACjG,cAAc,CAAC,UAAAwG,sBAAA,iBAAvCA,sBAAA,CAAyC7F,KAAK,CAAQ,CAAC,EAC5D,CAAC,CACJ,CAAC,cACLvC,IAAA,OAAAqG,QAAA,CACGwB,QAAQ,CAACsB,gBAAgB,cACxBnJ,IAAA,CAACd,KAAK,EAACgK,EAAE,CAAC,MAAM,CAAA7C,QAAA,CAAEwB,QAAQ,CAACsB,gBAAgB,CAAQ,CAAC,cAEpDnJ,IAAA,SAAMoG,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,gBAAS,CAAM,CAC7C,CACC,CAAC,cACLrG,IAAA,OAAAqG,QAAA,cACEnG,KAAA,QAAKkG,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BrG,IAAA,CAACR,cAAc,EACb4J,OAAO,cAAEpJ,IAAA,CAACP,OAAO,EAAA4G,QAAA,CAAC,mBAAY,CAAS,CAAE,CAAAA,QAAA,cAEzCrG,IAAA,CAAChB,MAAM,EACLwD,OAAO,CAAC,iBAAiB,CACzBiF,IAAI,CAAC,IAAI,CACTnB,OAAO,CAAEA,CAAA,GAAMJ,mBAAmB,CAAC2B,QAAQ,CAACwB,EAAE,CAAE,CAAAhD,QAAA,cAEhDrG,IAAA,MAAGoG,SAAS,CAAC,YAAY,CAAI,CAAC,CACxB,CAAC,CACK,CAAC,CAEhB7F,aAAa,CAAC,iBAAiB,CAAC,eAC/BL,KAAA,CAACX,QAAQ,EAAA8G,QAAA,eACPrG,IAAA,CAACT,QAAQ,CAAC+J,MAAM,EACd9G,OAAO,CAAC,mBAAmB,CAC3BiF,IAAI,CAAC,IAAI,CACT4B,EAAE,aAAArD,MAAA,CAAc6B,QAAQ,CAACwB,EAAE,CAAG,CAAAhD,QAAA,cAE9BrG,IAAA,MAAGoG,SAAS,CAAC,YAAY,CAAI,CAAC,CACf,CAAC,cAClBlG,KAAA,CAACX,QAAQ,CAACgK,IAAI,EAAAlD,QAAA,eACZnG,KAAA,CAACX,QAAQ,CAACiK,IAAI,EACZlD,OAAO,CAAEA,CAAA,GAAMb,kBAAkB,CAACoC,QAAQ,CAACwB,EAAE,CAAE,QAAQ,CAAE,cAAc,CAAE,CAAAhD,QAAA,eAEzErG,IAAA,MAAGoG,SAAS,CAAC,iBAAiB,CAAI,CAAC,sBAErC,EAAe,CAAC,cAChBlG,KAAA,CAACX,QAAQ,CAACiK,IAAI,EACZlD,OAAO,CAAEA,CAAA,GAAMb,kBAAkB,CAACoC,QAAQ,CAACwB,EAAE,CAAE,UAAU,CAAE,SAAS,CAAE,CAAAhD,QAAA,eAEtErG,IAAA,MAAGoG,SAAS,CAAC,mBAAmB,CAAI,CAAC,oBAEvC,EAAe,CAAC,cAChBlG,KAAA,CAACX,QAAQ,CAACiK,IAAI,EACZlD,OAAO,CAAEA,CAAA,GAAMb,kBAAkB,CAACoC,QAAQ,CAACwB,EAAE,CAAE,QAAQ,CAAE,WAAW,CAAE,CAAAhD,QAAA,eAEtErG,IAAA,MAAGoG,SAAS,CAAC,uBAAuB,CAAI,CAAC,mBAE3C,EAAe,CAAC,cAChBpG,IAAA,CAACT,QAAQ,CAACkK,OAAO,GAAE,CAAC,cACpBvJ,KAAA,CAACX,QAAQ,CAACiK,IAAI,EAACpD,SAAS,CAAC,aAAa,CAAAC,QAAA,eACpCrG,IAAA,MAAGoG,SAAS,CAAC,mBAAmB,CAAI,CAAC,mBAEvC,EAAe,CAAC,EACH,CAAC,EACR,CACX,EACE,CAAC,CACJ,CAAC,GA5GEyB,QAAQ,CAACwB,EA6Gd,CAAC,EACN,CAAC,CACJ,CAAE,MAAOK,GAAG,CAAE,CACZ9E,OAAO,CAACD,KAAK,CAAC,kCAAkC,CAAE+E,GAAG,CAAC,CACtDnI,cAAc,CAAC,CAAAmI,GAAG,SAAHA,GAAG,iBAAHA,GAAG,CAAEhF,OAAO,GAAIgD,MAAM,CAACgC,GAAG,CAAC,CAAC,CAC3C,MAAO,KAAI,CACb,CACF,CAAC,EAAE,CAAC,CACC,CAAC,EACH,CAET,CACS,CAAC,CAGX3H,UAAU,CAACK,KAAK,CAAG,CAAC,eACnBpC,IAAA,CAACjB,IAAI,CAAC4K,MAAM,EAAAtD,QAAA,cACVnG,KAAA,QAAKkG,SAAS,CAAC,mDAAmD,CAAAC,QAAA,eAChEnG,KAAA,UAAOkG,SAAS,CAAC,YAAY,CAAAC,QAAA,EAAC,qBACnB,CAAE,CAACtE,UAAU,CAACE,IAAI,CAAG,CAAC,EAAIF,UAAU,CAACG,KAAK,CAAI,CAAC,CAAC,KAAG,CAAC0H,IAAI,CAACC,GAAG,CAAC9H,UAAU,CAACE,IAAI,CAAGF,UAAU,CAACG,KAAK,CAAEH,UAAU,CAACI,KAAK,CAAC,CAAC,0BAC9G,CAACJ,UAAU,CAACI,KAAK,CAAC,0BAClC,EAAO,CAAC,cAERjC,KAAA,QAAKkG,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BrG,IAAA,CAAChB,MAAM,EACLwD,OAAO,CAAC,mBAAmB,CAC3BiF,IAAI,CAAC,IAAI,CACTqC,QAAQ,CAAE/H,UAAU,CAACE,IAAI,GAAK,CAAE,CAChCqE,OAAO,CAAEA,CAAA,GAAMtE,aAAa,CAACgD,IAAI,EAAApB,aAAA,CAAAA,aAAA,IAAUoB,IAAI,MAAE/C,IAAI,CAAE+C,IAAI,CAAC/C,IAAI,CAAG,CAAC,EAAG,CAAE,CAAAoE,QAAA,cAEzErG,IAAA,MAAGoG,SAAS,CAAC,qBAAqB,CAAI,CAAC,CACjC,CAAC,cAETlG,KAAA,SAAMkG,SAAS,CAAC,gCAAgC,CAAAC,QAAA,EAAC,QACzC,CAACtE,UAAU,CAACE,IAAI,CAAC,KAAG,CAACF,UAAU,CAACK,KAAK,EACvC,CAAC,cAEPpC,IAAA,CAAChB,MAAM,EACLwD,OAAO,CAAC,mBAAmB,CAC3BiF,IAAI,CAAC,IAAI,CACTqC,QAAQ,CAAE/H,UAAU,CAACE,IAAI,GAAKF,UAAU,CAACK,KAAM,CAC/CkE,OAAO,CAAEA,CAAA,GAAMtE,aAAa,CAACgD,IAAI,EAAApB,aAAA,CAAAA,aAAA,IAAUoB,IAAI,MAAE/C,IAAI,CAAE+C,IAAI,CAAC/C,IAAI,CAAG,CAAC,EAAG,CAAE,CAAAoE,QAAA,cAEzErG,IAAA,MAAGoG,SAAS,CAAC,sBAAsB,CAAI,CAAC,CAClC,CAAC,EACN,CAAC,EACH,CAAC,CACK,CACd,EACG,CAAC,EACJ,CAAC,CACH,CAAC,cAGNpG,IAAA,CAACH,eAAe,EACdkK,IAAI,CAAE/I,eAAgB,CACtBV,iBAAiB,CAAEA,iBAAkB,CACrC0J,MAAM,CAAEA,CAAA,GAAM/I,kBAAkB,CAAC,KAAK,CAAE,CACxCgJ,SAAS,CAAEA,CAAA,GAAM,CACfhJ,kBAAkB,CAAC,KAAK,CAAC,CACzBsC,aAAa,CAACxB,UAAU,CAACE,IAAI,CAAC,CAChC,CAAE,CACH,CAAC,CAGDf,gBAAgB,eACfhB,KAAA,CAACd,KAAK,EACJ2K,IAAI,CAAE3I,eAAgB,CACtB4I,MAAM,CAAEA,CAAA,GAAM3I,kBAAkB,CAAC,KAAK,CAAE,CACxCoG,IAAI,CAAC,IAAI,CACTyC,UAAU,MAAA7D,QAAA,eAEVrG,IAAA,CAACZ,KAAK,CAACmH,MAAM,EAAC4D,WAAW,MAAA9D,QAAA,cACvBnG,KAAA,CAACd,KAAK,CAACgL,KAAK,EAAA/D,QAAA,EAAC,wCACO,CAACnF,gBAAgB,CAAC2G,QAAQ,CAACQ,eAAe,EACjD,CAAC,CACF,CAAC,cACfrI,IAAA,CAACZ,KAAK,CAACoH,IAAI,EAAAH,QAAA,cACTrG,IAAA,CAACqK,kBAAkB,EAACxC,QAAQ,CAAE3G,gBAAiB,CAAE,CAAC,CACxC,CAAC,EACR,CACR,EACE,CAAC,CAEV,CAAC,CAED;AACA,KAAM,CAAAmJ,kBAAkB,CAAGC,KAAA,EAAkB,KAAAC,mBAAA,CAAAC,oBAAA,CAAAC,qBAAA,IAAjB,CAAE5C,QAAS,CAAC,CAAAyC,KAAA,CACtC,mBACEpK,KAAA,CAACb,IAAI,EAACqL,gBAAgB,CAAC,UAAU,CAACrB,EAAE,CAAC,sBAAsB,CAAAhD,QAAA,eACzDrG,IAAA,CAACV,GAAG,EAACqL,QAAQ,CAAC,UAAU,CAACC,KAAK,CAAC,gBAAW,CAAAvE,QAAA,cACxCrG,IAAA,QAAKoG,SAAS,CAAC,MAAM,CAAAC,QAAA,cACnBnG,KAAA,CAACrB,GAAG,EAAAwH,QAAA,eACFnG,KAAA,CAACpB,GAAG,EAAC2H,EAAE,CAAE,CAAE,CAAAJ,QAAA,eACTrG,IAAA,OAAAqG,QAAA,CAAI,sCAAkB,CAAI,CAAC,cAC3BrG,IAAA,CAACf,KAAK,EAACwI,IAAI,CAAC,IAAI,CAAApB,QAAA,cACdnG,KAAA,UAAAmG,QAAA,eACEnG,KAAA,OAAAmG,QAAA,eACErG,IAAA,OAAAqG,QAAA,cAAIrG,IAAA,WAAAqG,QAAA,CAAQ,kCAAY,CAAQ,CAAC,CAAI,CAAC,cACtCrG,IAAA,OAAAqG,QAAA,CAAKwB,QAAQ,CAACA,QAAQ,CAACQ,eAAe,CAAK,CAAC,EAC1C,CAAC,cACLnI,KAAA,OAAAmG,QAAA,eACErG,IAAA,OAAAqG,QAAA,cAAIrG,IAAA,WAAAqG,QAAA,CAAQ,uBAAQ,CAAQ,CAAC,CAAI,CAAC,cAClCrG,IAAA,OAAAqG,QAAA,CAAKwB,QAAQ,CAACA,QAAQ,CAACgD,cAAc,CAAK,CAAC,EACzC,CAAC,cACL3K,KAAA,OAAAmG,QAAA,eACErG,IAAA,OAAAqG,QAAA,cAAIrG,IAAA,WAAAqG,QAAA,CAAQ,gBAAM,CAAQ,CAAC,CAAI,CAAC,cAChCrG,IAAA,OAAAqG,QAAA,CAAKwB,QAAQ,CAACA,QAAQ,CAACe,YAAY,EAAI,cAAc,CAAK,CAAC,EACzD,CAAC,cACL1I,KAAA,OAAAmG,QAAA,eACErG,IAAA,OAAAqG,QAAA,cAAIrG,IAAA,WAAAqG,QAAA,CAAQ,MAAI,CAAQ,CAAC,CAAI,CAAC,cAC9BrG,IAAA,OAAAqG,QAAA,CAAKwB,QAAQ,CAACA,QAAQ,CAACgB,kBAAkB,CAAK,CAAC,EAC7C,CAAC,cACL3I,KAAA,OAAAmG,QAAA,eACErG,IAAA,OAAAqG,QAAA,cAAIrG,IAAA,WAAAqG,QAAA,CAAQ,oBAAU,CAAQ,CAAC,CAAI,CAAC,cACpCnG,KAAA,OAAAmG,QAAA,EAAKwB,QAAQ,CAACA,QAAQ,CAACiB,cAAc,CAAC,QAAG,EAAI,CAAC,EAC5C,CAAC,cACL5I,KAAA,OAAAmG,QAAA,eACErG,IAAA,OAAAqG,QAAA,cAAIrG,IAAA,WAAAqG,QAAA,CAAQ,iBAAS,CAAQ,CAAC,CAAI,CAAC,cACnCnG,KAAA,OAAAmG,QAAA,EAAK,GAAI,CAAAjB,IAAI,CAACC,YAAY,CAAC,OAAO,CAAC,CAACG,MAAM,CAACqC,QAAQ,CAACA,QAAQ,CAACkB,YAAY,CAAC,CAAC,oBAAU,EAAI,CAAC,EACxF,CAAC,EACA,CAAC,CACH,CAAC,EACL,CAAC,cACN7I,KAAA,CAACpB,GAAG,EAAC2H,EAAE,CAAE,CAAE,CAAAJ,QAAA,eACTrG,IAAA,OAAAqG,QAAA,CAAI,+BAAoB,CAAI,CAAC,cAC7BrG,IAAA,CAACf,KAAK,EAACwI,IAAI,CAAC,IAAI,CAAApB,QAAA,cACdnG,KAAA,UAAAmG,QAAA,eACEnG,KAAA,OAAAmG,QAAA,eACErG,IAAA,OAAAqG,QAAA,cAAIrG,IAAA,WAAAqG,QAAA,CAAQ,aAAQ,CAAQ,CAAC,CAAI,CAAC,cAClCrG,IAAA,OAAAqG,QAAA,CAAKwB,QAAQ,CAACA,QAAQ,CAACY,qBAAqB,CAAK,CAAC,EAChD,CAAC,cACLvI,KAAA,OAAAmG,QAAA,eACErG,IAAA,OAAAqG,QAAA,cAAIrG,IAAA,WAAAqG,QAAA,CAAQ,kCAAc,CAAQ,CAAC,CAAI,CAAC,cACxCrG,IAAA,OAAAqG,QAAA,CAAKwB,QAAQ,CAACA,QAAQ,CAACc,aAAa,CAAK,CAAC,EACxC,CAAC,cACLzI,KAAA,OAAAmG,QAAA,eACErG,IAAA,OAAAqG,QAAA,cAAIrG,IAAA,WAAAqG,QAAA,CAAQ,4BAAW,CAAQ,CAAC,CAAI,CAAC,cACrCrG,IAAA,OAAAqG,QAAA,CAAKwB,QAAQ,CAACA,QAAQ,CAACiD,cAAc,CAAK,CAAC,EACzC,CAAC,cACL5K,KAAA,OAAAmG,QAAA,eACErG,IAAA,OAAAqG,QAAA,cAAIrG,IAAA,WAAAqG,QAAA,CAAQ,QAAM,CAAQ,CAAC,CAAI,CAAC,cAChCrG,IAAA,OAAAqG,QAAA,CAAKwB,QAAQ,CAACA,QAAQ,CAACkD,cAAc,CAAK,CAAC,EACzC,CAAC,cACL7K,KAAA,OAAAmG,QAAA,eACErG,IAAA,OAAAqG,QAAA,cAAIrG,IAAA,WAAAqG,QAAA,CAAQ,0BAAW,CAAQ,CAAC,CAAI,CAAC,cACrCrG,IAAA,OAAAqG,QAAA,CAAKwB,QAAQ,CAACA,QAAQ,CAACmD,QAAQ,CAAK,CAAC,EACnC,CAAC,EACA,CAAC,CACH,CAAC,EACL,CAAC,EACH,CAAC,CACH,CAAC,CACH,CAAC,cAENhL,IAAA,CAACV,GAAG,EAACqL,QAAQ,CAAC,WAAW,CAACC,KAAK,sBAAA5E,MAAA,CAAe,EAAAuE,mBAAA,CAAA1C,QAAQ,CAACoD,SAAS,UAAAV,mBAAA,iBAAlBA,mBAAA,CAAoB9G,MAAM,GAAI,CAAC,KAAI,CAAA4C,QAAA,cAC/ErG,IAAA,QAAKoG,SAAS,CAAC,MAAM,CAAAC,QAAA,CAClB,EAAAmE,oBAAA,CAAA3C,QAAQ,CAACoD,SAAS,UAAAT,oBAAA,iBAAlBA,oBAAA,CAAoB/G,MAAM,EAAG,CAAC,cAC7BvD,KAAA,CAACjB,KAAK,EAAAoH,QAAA,eACJrG,IAAA,UAAAqG,QAAA,cACEnG,KAAA,OAAAmG,QAAA,eACErG,IAAA,OAAAqG,QAAA,CAAI,yBAAY,CAAI,CAAC,cACrBrG,IAAA,OAAAqG,QAAA,CAAI,WAAI,CAAI,CAAC,cACbrG,IAAA,OAAAqG,QAAA,CAAI,mBAAS,CAAI,CAAC,cAClBrG,IAAA,OAAAqG,QAAA,CAAI,oBAAU,CAAI,CAAC,cACnBrG,IAAA,OAAAqG,QAAA,CAAI,kBAAQ,CAAI,CAAC,cACjBrG,IAAA,OAAAqG,QAAA,CAAI,aAAQ,CAAI,CAAC,EACf,CAAC,CACA,CAAC,cACRrG,IAAA,UAAAqG,QAAA,CACGwB,QAAQ,CAACoD,SAAS,CAAC5D,GAAG,CAAC6D,GAAG,eACzBhL,KAAA,OAAAmG,QAAA,eACErG,IAAA,OAAAqG,QAAA,CAAK6E,GAAG,CAACC,aAAa,CAAK,CAAC,cAC5BnL,IAAA,OAAAqG,QAAA,cACErG,IAAA,CAACd,KAAK,EAACgK,EAAE,CAAC,MAAM,CAAA7C,QAAA,CAAE6E,GAAG,CAACE,aAAa,CAAQ,CAAC,CAC1C,CAAC,cACLlL,KAAA,OAAAmG,QAAA,EAAI,GAAC,CAAC6E,GAAG,CAACG,OAAO,EAAK,CAAC,cACvBrL,IAAA,OAAAqG,QAAA,cACErG,IAAA,CAACd,KAAK,EACJgK,EAAE,CAAEgC,GAAG,CAACvJ,MAAM,GAAK,OAAO,CAAG,SAAS,CAClCuJ,GAAG,CAACvJ,MAAM,GAAK,OAAO,CAAG,WAAW,CAAG,SAAU,CAAA0E,QAAA,CAEpD6E,GAAG,CAACvJ,MAAM,CACN,CAAC,CACN,CAAC,cACL3B,IAAA,OAAAqG,QAAA,CAAK,GAAI,CAAAkC,IAAI,CAAC2C,GAAG,CAAC5C,UAAU,CAAC,CAACE,kBAAkB,CAAC,OAAO,CAAC,CAAK,CAAC,cAC/DxI,IAAA,OAAAqG,QAAA,cACErG,IAAA,CAAChB,MAAM,EAACwD,OAAO,CAAC,iBAAiB,CAACiF,IAAI,CAAC,IAAI,CAAApB,QAAA,cACzCrG,IAAA,MAAGoG,SAAS,CAAC,YAAY,CAAI,CAAC,CACxB,CAAC,CACP,CAAC,GAnBE8E,GAAG,CAAC7B,EAoBT,CACL,CAAC,CACG,CAAC,EACH,CAAC,cAERrJ,IAAA,QAAKoG,SAAS,CAAC,6BAA6B,CAAAC,QAAA,CAAC,yCAE7C,CAAK,CACN,CACE,CAAC,CACH,CAAC,cAENrG,IAAA,CAACV,GAAG,EAACqL,QAAQ,CAAC,SAAS,CAACC,KAAK,CAAC,mBAAS,CAAAvE,QAAA,cACrCrG,IAAA,QAAKoG,SAAS,CAAC,MAAM,CAAAC,QAAA,CAClB,EAAAoE,qBAAA,CAAA5C,QAAQ,CAACyD,gBAAgB,UAAAb,qBAAA,iBAAzBA,qBAAA,CAA2BhH,MAAM,EAAG,CAAC,cACpCzD,IAAA,QAAKoG,SAAS,CAAC,UAAU,CAAAC,QAAA,CACtBwB,QAAQ,CAACyD,gBAAgB,CAACjE,GAAG,CAACkE,OAAO,eACpCvL,IAAA,QAAsBoG,SAAS,CAAC,oBAAoB,CAAAC,QAAA,cAClDnG,KAAA,QAAKkG,SAAS,CAAC,QAAQ,CAAAC,QAAA,eACrBrG,IAAA,QAAKoG,SAAS,CAAC,eAAe,CAAAC,QAAA,cAC5BrG,IAAA,QAAKoG,SAAS,CAAC,uFAAuF,CAACd,KAAK,CAAE,CAACkG,KAAK,CAAE,MAAM,CAAEC,MAAM,CAAE,MAAM,CAAE,CAAApF,QAAA,cAC5IrG,IAAA,MAAGoG,SAAS,CAAC,mBAAmB,CAAI,CAAC,CAClC,CAAC,CACH,CAAC,cACNlG,KAAA,QAAKkG,SAAS,CAAC,kBAAkB,CAAAC,QAAA,eAC/BnG,KAAA,QAAKkG,SAAS,CAAC,gCAAgC,CAAAC,QAAA,eAC7CrG,IAAA,OAAIoG,SAAS,CAAC,MAAM,CAAAC,QAAA,CAAEkF,OAAO,CAACG,MAAM,CAAK,CAAC,cAC1C1L,IAAA,UAAOoG,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAE,GAAI,CAAAkC,IAAI,CAACgD,OAAO,CAACI,YAAY,CAAC,CAACC,cAAc,CAAC,OAAO,CAAC,CAAQ,CAAC,EAC3F,CAAC,cACN5L,IAAA,MAAGoG,SAAS,CAAC,MAAM,CAAAC,QAAA,CAAEkF,OAAO,CAACxF,OAAO,CAAI,CAAC,cACzC7F,KAAA,UAAOkG,SAAS,CAAC,YAAY,CAAAC,QAAA,EAAC,YAAK,CAACkF,OAAO,CAACM,iBAAiB,EAAQ,CAAC,EACnE,CAAC,EACH,CAAC,EAfEN,OAAO,CAAClC,EAgBb,CACN,CAAC,CACC,CAAC,cAENrJ,IAAA,QAAKoG,SAAS,CAAC,6BAA6B,CAAAC,QAAA,CAAC,0CAE7C,CAAK,CACN,CACE,CAAC,CACH,CAAC,EACF,CAAC,CAEX,CAAC,CAED,cAAe,CAAAlG,eAAe","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}