{"ast":null,"code":"import _objectSpread from\"C:/Users/Admin/Documents/GitHub/MVG_InventoryManagement/KinhDoanh/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";/**\r\n * Contract Creator - Tạo hợp đồng từ mẫu với dữ liệu khách hàng\r\n */import React,{useState,useEffect,useCallback}from'react';import{Modal,Form,Row,Col,Button,Alert,Tabs,Tab,Card}from'react-bootstrap';import{useAuth}from'../../contexts/AuthContext';import{useNotification}from'../../contexts/NotificationContext';import contractService from'../../services/contractService';import customerService from'../../services/customerService';import projectService from'../../services/projectService';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ContractCreator=_ref=>{let{show,onHide,onSuccess,initialCustomerId=''}=_ref;const{user}=useAuth();const{showSuccess,showError}=useNotification();const[loading,setLoading]=useState(false);const[activeTab,setActiveTab]=useState('basic');// Data states\nconst[customers,setCustomers]=useState([]);const[customersLoaded,setCustomersLoaded]=useState(false);const[templates,setTemplates]=useState([]);const[projects,setProjects]=useState([]);const[zones,setZones]=useState([]);const[selectedCustomer,setSelectedCustomer]=useState(null);const[selectedTemplate,setSelectedTemplate]=useState(null);const[selectedProject,setSelectedProject]=useState(null);const[selectedZone,setSelectedZone]=useState(null);const[templatesLoaded,setTemplatesLoaded]=useState(false);const[projectsLoaded,setProjectsLoaded]=useState(false);// Form data\nconst[formData,setFormData]=useState({// Basic contract info\ncontract_title:'',customer_id:'',customer_company_id:'',template_id:'',project_id:'',zone_id:'',// Party A (Lessor) - Bên cho thuê\nparty_a_name:'CÔNG TY KHO MVG',party_a_address:'Khu công nghiệp ABC, Bình Dương',party_a_representative:'Nguyễn Văn A',party_a_position:'Giám đốc',party_a_id_number:'123456789',// Contract terms\nwarehouse_location:'',warehouse_area:0,warehouse_purpose:'',rental_price:0,deposit_amount:0,service_fee:0,// Dates\nstart_date:'',end_date:'',auto_renewal:false,renewal_period:12,// Payment\npayment_cycle:'monthly',payment_due_date:5,payment_method:'Chuyển khoản',late_fee_percentage:2.0,// Additional terms\nspecial_terms:'',notes:'',assigned_to:(user===null||user===void 0?void 0:user.id)||'',// Template variables\nvariables:{}});const loadInitialData=useCallback(async()=>{try{var _customersResponse$da,_templatesResponse$da,_projectsResponse$dat,_projectsResponse$dat2;setLoading(true);const[customersResponse,templatesResponse,projectsResponse]=await Promise.all([customerService.getCustomers({limit:100}),contractService.getContractTemplates({is_active:true}),projectService.getProjects({limit:100})]);// Customers: API shape { success, data: { customers: [...] } }\nsetCustomers((customersResponse===null||customersResponse===void 0?void 0:(_customersResponse$da=customersResponse.data)===null||_customersResponse$da===void 0?void 0:_customersResponse$da.customers)||(customersResponse===null||customersResponse===void 0?void 0:customersResponse.customers)||[]);setCustomersLoaded(true);// Templates: API shape can be: { success, data: [...] } or { success, data: { templates: [...] } } or { templates: [...] }\nconst loadedTemplates=(templatesResponse===null||templatesResponse===void 0?void 0:(_templatesResponse$da=templatesResponse.data)===null||_templatesResponse$da===void 0?void 0:_templatesResponse$da.templates)||(templatesResponse===null||templatesResponse===void 0?void 0:templatesResponse.data)||(templatesResponse===null||templatesResponse===void 0?void 0:templatesResponse.templates)||templatesResponse||[];setTemplates(Array.isArray(loadedTemplates)?loadedTemplates:[]);setTemplatesLoaded(true);// Auto-select default template if available\nconst defaultTpl=Array.isArray(loadedTemplates)&&loadedTemplates.find(t=>t.is_default);if(defaultTpl){setSelectedTemplate(defaultTpl);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{template_id:String(defaultTpl.id)}));}// Projects: shape could be { success, data: { projects: [...] } } or { success, projects: [...] }\nconst loadedProjects=(projectsResponse===null||projectsResponse===void 0?void 0:(_projectsResponse$dat=projectsResponse.data)===null||_projectsResponse$dat===void 0?void 0:_projectsResponse$dat.projects)||(projectsResponse===null||projectsResponse===void 0?void 0:projectsResponse.projects)||(projectsResponse===null||projectsResponse===void 0?void 0:projectsResponse.data)||[];setProjects(Array.isArray(loadedProjects)?loadedProjects:Array.isArray(projectsResponse===null||projectsResponse===void 0?void 0:(_projectsResponse$dat2=projectsResponse.data)===null||_projectsResponse$dat2===void 0?void 0:_projectsResponse$dat2.projects)?projectsResponse.data.projects:[]);setProjectsLoaded(true);}catch(error){console.error('Error loading initial data:',error);showError('Không thể tải dữ liệu: '+error.message);}finally{setLoading(false);}},[showError]);// Load initial data\nuseEffect(()=>{if(show){loadInitialData();}},[show,loadInitialData]);// Read customer id from URL if not provided via props\nuseEffect(()=>{if(!show)return;if(initialCustomerId)return;try{const params=new URLSearchParams(window.location.search);const fromUrl=params.get('customer')||params.get('customer_id');if(fromUrl){handleCustomerSelect(fromUrl);}}catch(e){// no-op\n}},[show,initialCustomerId]);// If initialCustomerId is provided, preselect it after data loads\nuseEffect(()=>{async function ensureAndSelectInitialCustomer(){if(!show||!initialCustomerId)return;// If list already contains the customer, select it\nconst exists=customers.some(c=>String(c.id)===String(initialCustomerId));if(exists){handleCustomerSelect(initialCustomerId);return;}// Otherwise fetch it and add to list\ntry{var _customerResponse$dat;const customerResponse=await customerService.getCustomer(initialCustomerId);const customerData=(customerResponse===null||customerResponse===void 0?void 0:(_customerResponse$dat=customerResponse.data)===null||_customerResponse$dat===void 0?void 0:_customerResponse$dat.customer)||(customerResponse===null||customerResponse===void 0?void 0:customerResponse.data)||customerResponse;if(customerData&&customerData.id){setCustomers(prev=>{const already=prev.some(c=>String(c.id)===String(customerData.id));return already?prev:[customerData,...prev];});handleCustomerSelect(customerData.id);}}catch(e){console.warn('Could not preload initial customer',(e===null||e===void 0?void 0:e.message)||e);}}ensureAndSelectInitialCustomer();},[show,initialCustomerId,customers,customersLoaded]);// Load zones when project changes\nuseEffect(()=>{async function fetchZones(){if(formData.project_id){const zonesResponse=await projectService.getZones(formData.project_id);setZones(zonesResponse.zones||[]);}else{setZones([]);}}fetchZones();},[formData.project_id]);// Handle customer selection\nconst handleCustomerSelect=async customerId=>{try{var _customerResponse$dat2;const customer=customers.find(c=>c.id===parseInt(customerId));if(!customer)return;setSelectedCustomer(customer);// Load customer details\nconst customerResponse=await customerService.getCustomer(customerId);const customerData=(customerResponse===null||customerResponse===void 0?void 0:(_customerResponse$dat2=customerResponse.data)===null||_customerResponse$dat2===void 0?void 0:_customerResponse$dat2.customer)||(customerResponse===null||customerResponse===void 0?void 0:customerResponse.data)||customerResponse;// Auto-fill contract data based on available fields from API\nsetFormData(prev=>_objectSpread(_objectSpread({},prev),{},{customer_id:customerId,contract_title:\"H\\u1EE3p \\u0111\\u1ED3ng thu\\xEA kho - \".concat(customerData.name||customerData.full_name||'Khách hàng'),warehouse_purpose:customerData.warehouse_purpose||'Lưu kho hàng hóa',variables:_objectSpread(_objectSpread({},prev.variables),{},{// Auto-fill Party B info\nparty_b_name:customerData.name||customerData.full_name,party_b_address:customerData.address||'',party_b_representative:customerData.representative_name||customerData.full_name||'',party_b_position:'Giám đốc',party_b_tax_code:customerData.tax_code||'',warehouse_purpose:customerData.warehouse_purpose||'Lưu kho hàng hóa',payment_cycle:prev.payment_cycle==='monthly'?'Hàng tháng':prev.payment_cycle==='quarterly'?'Hàng quý':'Hàng năm',payment_due_date:prev.payment_due_date})}));}catch(error){showError('Không thể tải thông tin khách hàng: '+error.message);}};// Handle template selection\nconst handleTemplateSelect=templateId=>{if(!templateId){setSelectedTemplate(null);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{template_id:''}));return;}const template=templates.find(t=>t.id===parseInt(templateId));if(!template)return;setSelectedTemplate(template);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{template_id:templateId}));// Parse template variables\nif(template.variables){let templateVars=[];try{templateVars=typeof template.variables==='string'?JSON.parse(template.variables):Array.isArray(template.variables)?template.variables:[];}catch(e){console.warn('Invalid template variables JSON:',(e===null||e===void 0?void 0:e.message)||e);templateVars=[];}// Initialize variables with current form data\nconst newVariables=_objectSpread({},formData.variables);templateVars.forEach(variable=>{if(!newVariables[variable.name]){// Auto-populate common variables\nswitch(variable.name){case'party_a_name':newVariables[variable.name]=formData.party_a_name;break;case'party_a_representative':newVariables[variable.name]=formData.party_a_representative;break;case'start_date':newVariables[variable.name]=formData.start_date;break;case'end_date':newVariables[variable.name]=formData.end_date;break;case'warehouse_location':newVariables[variable.name]=formData.warehouse_location;break;case'rental_price':newVariables[variable.name]=formData.rental_price.toLocaleString('vi-VN')+' VNĐ';break;default:newVariables[variable.name]='';}}});setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{variables:newVariables}));// Move to variables tab to let user fill missing variables\nsetActiveTab('variables');}};// Generate contract number\nconst generateContractNumber=()=>{const now=new Date();const year=now.getFullYear();const month=(now.getMonth()+1).toString().padStart(2,'0');const random=Math.floor(Math.random()*10000).toString().padStart(4,'0');return\"HD\".concat(year).concat(month).concat(random);};// Calculate contract end date\nconst calculateEndDate=function(startDate){let months=arguments.length>1&&arguments[1]!==undefined?arguments[1]:12;const start=new Date(startDate);const end=new Date(start);end.setMonth(end.getMonth()+months);return end.toISOString().split('T')[0];};// Handle form submission\nconst handleSubmit=async e=>{e.preventDefault();try{setLoading(true);// Generate contract number if not provided\nif(!formData.variables.contract_number){formData.variables.contract_number=generateContractNumber();}// Create contract\nconst response=await contractService.createContract(formData);showSuccess('Tạo hợp đồng thành công');onSuccess===null||onSuccess===void 0?void 0:onSuccess(response.data);onHide();resetForm();}catch(error){showError('Lỗi tạo hợp đồng: '+error.message);}finally{setLoading(false);}};// Reset form\nconst resetForm=()=>{setFormData({contract_title:'',customer_id:'',customer_company_id:'',template_id:'',project_id:'',zone_id:'',party_a_name:'CÔNG TY KHO MVG',party_a_address:'Khu công nghiệp ABC, Bình Dương',party_a_representative:'Nguyễn Văn A',party_a_position:'Giám đốc',party_a_id_number:'123456789',warehouse_location:'',warehouse_area:0,warehouse_purpose:'',rental_price:0,deposit_amount:0,service_fee:0,start_date:'',end_date:'',auto_renewal:false,renewal_period:12,payment_cycle:'monthly',payment_due_date:5,payment_method:'Chuyển khoản',late_fee_percentage:2.0,special_terms:'',notes:'',assigned_to:(user===null||user===void 0?void 0:user.id)||'',variables:{}});setSelectedCustomer(null);setSelectedTemplate(null);setSelectedProject(null);setSelectedZone(null);setActiveTab('basic');};// Format currency for display (without currency symbol)\nconst formatCurrency=amount=>{return new Intl.NumberFormat('vi-VN').format(amount);};// Format currency for variables (with currency symbol)\nconst formatCurrencyForVariable=amount=>{return new Intl.NumberFormat('vi-VN').format(amount)+' VNĐ';};return/*#__PURE__*/_jsxs(Modal,{show:show,onHide:onHide,size:\"xl\",scrollable:true,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsxs(Modal.Title,{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-plus-circle me-2\"}),\"T\\u1EA1o h\\u1EE3p \\u0111\\u1ED3ng m\\u1EDBi\"]})}),/*#__PURE__*/_jsxs(Modal.Body,{children:[selectedCustomer&&/*#__PURE__*/_jsx(Alert,{variant:\"info\",className:\"mb-3\",children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{md:4,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Kh\\xE1ch h\\xE0ng:\"}),\" \",selectedCustomer.name||selectedCustomer.full_name]}),selectedCustomer.customer_code&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[\"M\\xE3 KH: \",selectedCustomer.customer_code]})})]}),/*#__PURE__*/_jsxs(Col,{md:4,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0110i\\u1EC7n tho\\u1EA1i:\"}),\" \",selectedCustomer.phone||selectedCustomer.representative_phone||'—']}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email:\"}),\" \",selectedCustomer.email||selectedCustomer.representative_email||'—']})]}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0110\\u1ECBa ch\\u1EC9:\"}),\" \",selectedCustomer.address||'—']})})]})}),/*#__PURE__*/_jsxs(Form,{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(Tabs,{activeKey:activeTab,onSelect:setActiveTab,className:\"mb-3\",children:[/*#__PURE__*/_jsx(Tab,{eventKey:\"basic\",title:\"Th\\xF4ng tin h\\u1EE3p \\u0111\\u1ED3ng\",children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{md:6,children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Ch\\u1ECDn kh\\xE1ch h\\xE0ng *\"}),/*#__PURE__*/_jsxs(Form.Select,{value:formData.customer_id,onChange:e=>handleCustomerSelect(e.target.value),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Ch\\u1ECDn kh\\xE1ch h\\xE0ng --\"}),customers.map(customer=>/*#__PURE__*/_jsxs(\"option\",{value:customer.id,children:[customer.name||customer.full_name||'Khách hàng',\" \",customer.customer_code?\"(\".concat(customer.customer_code,\")\"):'']},customer.id))]})]}),selectedCustomer&&/*#__PURE__*/_jsxs(Alert,{variant:\"info\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Th\\xF4ng tin kh\\xE1ch h\\xE0ng:\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"small\",{children:[\"S\\u0110T: \",selectedCustomer.phone,/*#__PURE__*/_jsx(\"br\",{}),\"Email: \",selectedCustomer.email,/*#__PURE__*/_jsx(\"br\",{}),\"\\u0110\\u1ECBa ch\\u1EC9: \",selectedCustomer.address]})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Ch\\u1ECDn d\\u1EF1 \\xE1n *\"}),/*#__PURE__*/_jsxs(Form.Select,{value:formData.project_id||'',onChange:e=>{const projectId=e.target.value;const project=projects.find(p=>p.id===parseInt(projectId));setSelectedProject(project||null);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{project_id:projectId,zone_id:'',warehouse_location:''}));},required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Ch\\u1ECDn d\\u1EF1 \\xE1n --\"}),projects.map(project=>/*#__PURE__*/_jsx(\"option\",{value:project.id,children:project.name},project.id))]})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"V\\u1ECB tr\\xED kho thu\\xEA *\"}),/*#__PURE__*/_jsxs(Form.Select,{value:formData.zone_id||'',onChange:e=>{const zoneId=e.target.value;const selectedZone=zones.find(z=>z.id===parseInt(zoneId));setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{zone_id:zoneId,warehouse_location:selectedZone?\"\".concat(selectedZone.zone_name||selectedZone.zone_code,\" - \").concat((selectedProject===null||selectedProject===void 0?void 0:selectedProject.name)||''):'',variables:_objectSpread(_objectSpread({},prev.variables),{},{warehouse_location:selectedZone?\"\".concat(selectedZone.zone_name||selectedZone.zone_code,\" - \").concat((selectedProject===null||selectedProject===void 0?void 0:selectedProject.name)||''):''})}));setSelectedZone(selectedZone||null);},required:true,disabled:!formData.project_id,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Ch\\u1ECDn kho --\"}),zones.map(zone=>/*#__PURE__*/_jsxs(\"option\",{value:zone.id,children:[zone.zone_name,\" (\",zone.zone_code,\")\"]},zone.id))]})]})]}),/*#__PURE__*/_jsxs(Col,{md:6,children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Ch\\u1ECDn m\\u1EABu h\\u1EE3p \\u0111\\u1ED3ng *\"}),/*#__PURE__*/_jsxs(Form.Select,{value:formData.template_id,onChange:e=>handleTemplateSelect(e.target.value),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Ch\\u1ECDn m\\u1EABu h\\u1EE3p \\u0111\\u1ED3ng --\"}),templates.map(template=>/*#__PURE__*/_jsxs(\"option\",{value:template.id,children:[template.template_name,template.is_default&&' (Mặc định)']},template.id))]})]}),selectedTemplate&&/*#__PURE__*/_jsxs(Alert,{variant:\"success\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"M\\u1EABu \\u0111\\xE3 ch\\u1ECDn:\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"small\",{children:[\"M\\xE3: \",selectedTemplate.template_code,/*#__PURE__*/_jsx(\"br\",{}),\"Phi\\xEAn b\\u1EA3n: \",selectedTemplate.version,/*#__PURE__*/_jsx(\"br\",{}),\"Lo\\u1EA1i: \",selectedTemplate.template_type]})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Ti\\xEAu \\u0111\\u1EC1 h\\u1EE3p \\u0111\\u1ED3ng *\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",value:formData.contract_title,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{contract_title:e.target.value})),placeholder:\"VD: H\\u1EE3p \\u0111\\u1ED3ng thu\\xEA kho - C\\xF4ng ty ABC\",required:true})]}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Di\\u1EC7n t\\xEDch (m\\xB2) *\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"number\",step:\"0.1\",min:\"0\",value:formData.warehouse_area,onChange:e=>{const value=parseFloat(e.target.value)||0;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{warehouse_area:value,variables:_objectSpread(_objectSpread({},prev.variables),{},{warehouse_area:value})}));},required:true})]})}),/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Gi\\xE1 thu\\xEA/th\\xE1ng (VN\\u0110) *\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",value:formData.rental_price?formatCurrency(formData.rental_price):'',onChange:e=>{// Remove all non-digits\nconst numericValue=e.target.value.replace(/\\D/g,'');const value=parseInt(numericValue)||0;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{rental_price:value,variables:_objectSpread(_objectSpread({},prev.variables),{},{rental_price:formatCurrencyForVariable(value)})}));},placeholder:\"VD: 10,000,000\",required:true}),formData.rental_price>0&&formData.warehouse_area>0&&/*#__PURE__*/_jsxs(Form.Text,{className:\"text-muted\",children:[\"Gi\\xE1/m\\xB2: \",formatCurrency(Math.round(formData.rental_price/formData.warehouse_area)),\" VN\\u0110/m\\xB2\"]})]})})]}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Ti\\u1EC1n c\\u1ECDc (VN\\u0110)\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",value:formData.deposit_amount?formatCurrency(formData.deposit_amount):'',onChange:e=>{// Remove all non-digits\nconst numericValue=e.target.value.replace(/\\D/g,'');const value=parseInt(numericValue)||0;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{deposit_amount:value,variables:_objectSpread(_objectSpread({},prev.variables),{},{deposit_amount:formatCurrencyForVariable(value)})}));},placeholder:\"VD: 5,000,000\"})]})}),/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Ph\\xED d\\u1ECBch v\\u1EE5 (VN\\u0110)\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",value:formData.service_fee?formatCurrency(formData.service_fee):'',onChange:e=>{// Remove all non-digits\nconst numericValue=e.target.value.replace(/\\D/g,'');const value=parseInt(numericValue)||0;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{service_fee:value,variables:_objectSpread(_objectSpread({},prev.variables),{},{service_fee:formatCurrencyForVariable(value)})}));},placeholder:\"VD: 500,000\"})]})})]}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Ng\\xE0y b\\u1EAFt \\u0111\\u1EA7u *\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"date\",value:formData.start_date,onChange:e=>{const startDate=e.target.value;const endDate=calculateEndDate(startDate,formData.renewal_period);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{start_date:startDate,end_date:endDate,variables:_objectSpread(_objectSpread({},prev.variables),{},{start_date:new Date(startDate).toLocaleDateString('vi-VN'),end_date:new Date(endDate).toLocaleDateString('vi-VN')})}));},required:true})]})}),/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Ng\\xE0y k\\u1EBFt th\\xFAc *\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"date\",value:formData.end_date,onChange:e=>{const value=e.target.value;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{end_date:value,variables:_objectSpread(_objectSpread({},prev.variables),{},{end_date:new Date(value).toLocaleDateString('vi-VN')})}));},min:formData.start_date,required:true})]})})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Chu k\\u1EF3 thanh to\\xE1n\"}),/*#__PURE__*/_jsxs(Form.Select,{value:formData.payment_cycle,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{payment_cycle:e.target.value,variables:_objectSpread(_objectSpread({},prev.variables),{},{payment_cycle:e.target.value==='monthly'?'Hàng tháng':e.target.value==='quarterly'?'Hàng quý':'Hàng năm'})})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"monthly\",children:\"H\\xE0ng th\\xE1ng\"}),/*#__PURE__*/_jsx(\"option\",{value:\"quarterly\",children:\"H\\xE0ng qu\\xFD\"}),/*#__PURE__*/_jsx(\"option\",{value:\"yearly\",children:\"H\\xE0ng n\\u0103m\"})]})]}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"H\\u1EA1n thanh to\\xE1n (ng\\xE0y)\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"number\",min:\"1\",max:\"31\",value:formData.payment_due_date,onChange:e=>{const value=parseInt(e.target.value)||5;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{payment_due_date:value,variables:_objectSpread(_objectSpread({},prev.variables),{},{payment_due_date:value})}));}})]})}),/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Ph\\xED tr\\u1EC5 h\\u1EA1n (%)\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"number\",step:\"0.1\",min:\"0\",max:\"10\",value:formData.late_fee_percentage,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{late_fee_percentage:parseFloat(e.target.value)||2.0}))})]})})]}),/*#__PURE__*/_jsx(Form.Group,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Form.Check,{type:\"checkbox\",id:\"auto_renewal\",label:\"T\\u1EF1 \\u0111\\u1ED9ng gia h\\u1EA1n\",checked:formData.auto_renewal,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{auto_renewal:e.target.checked}))})}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"M\\u1EE5c \\u0111\\xEDch s\\u1EED d\\u1EE5ng kho\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",value:formData.warehouse_purpose,onChange:e=>{const value=e.target.value;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{warehouse_purpose:value,variables:_objectSpread(_objectSpread({},prev.variables),{},{warehouse_purpose:value})}));},placeholder:\"VD: L\\u01B0u kho h\\xE0ng h\\xF3a, S\\u1EA3n xu\\u1EA5t, Ph\\xE2n ph\\u1ED1i...\"})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"\\u0110i\\u1EC1u kho\\u1EA3n \\u0111\\u1EB7c bi\\u1EC7t\"}),/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",rows:3,value:formData.special_terms,onChange:e=>{const value=e.target.value;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{special_terms:value,variables:_objectSpread(_objectSpread({},prev.variables),{},{special_terms:value})}));},placeholder:\"C\\xE1c \\u0111i\\u1EC1u kho\\u1EA3n \\u0111\\u1EB7c bi\\u1EC7t kh\\xE1c...\"})]})]})]})}),/*#__PURE__*/_jsx(Tab,{eventKey:\"variables\",title:\"Bi\\u1EBFn m\\u1EABu\",disabled:!selectedTemplate,children:selectedTemplate&&selectedTemplate.variables&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Alert,{variant:\"info\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-info-circle me-2\"}),\"C\\xE1c bi\\u1EBFn n\\xE0y s\\u1EBD \\u0111\\u01B0\\u1EE3c thay th\\u1EBF trong n\\u1ED9i dung h\\u1EE3p \\u0111\\u1ED3ng cu\\u1ED1i c\\xF9ng.\"]}),/*#__PURE__*/_jsx(Row,{children:(()=>{let vars=[];try{vars=typeof selectedTemplate.variables==='string'?JSON.parse(selectedTemplate.variables):Array.isArray(selectedTemplate.variables)?selectedTemplate.variables:[];}catch(e){vars=[];}return vars;})().map(variable=>/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(Form.Label,{children:[variable.description||variable.name,variable.required&&/*#__PURE__*/_jsx(\"span\",{className:\"text-danger\",children:\"*\"})]}),variable.type==='boolean'?/*#__PURE__*/_jsx(Form.Check,{type:\"checkbox\",checked:formData.variables[variable.name]==='true',onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{variables:_objectSpread(_objectSpread({},prev.variables),{},{[variable.name]:e.target.checked.toString()})}))}):/*#__PURE__*/_jsx(Form.Control,{type:variable.type==='date'?'date':variable.type==='number'?'number':'text',value:formData.variables[variable.name]||'',onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{variables:_objectSpread(_objectSpread({},prev.variables),{},{[variable.name]:e.target.value})})),required:variable.required,placeholder:\"{{\".concat(variable.name,\"}}\")}),/*#__PURE__*/_jsxs(Form.Text,{className:\"text-muted\",children:[\"Bi\\u1EBFn: \",/*#__PURE__*/_jsx(\"code\",{children:\"{{\".concat(variable.name,\"}}\")})]})]})},variable.name))})]})}),/*#__PURE__*/_jsx(Tab,{eventKey:\"preview\",title:\"Xem tr\\u01B0\\u1EDBc\",disabled:!selectedTemplate,children:selectedTemplate&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Alert,{variant:\"success\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-eye me-2\"}),\"Xem tr\\u01B0\\u1EDBc n\\u1ED9i dung h\\u1EE3p \\u0111\\u1ED3ng v\\u1EDBi d\\u1EEF li\\u1EC7u \\u0111\\xE3 nh\\u1EADp\"]}),/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsx(\"div\",{className:\"contract-preview\",dangerouslySetInnerHTML:{__html:String((selectedTemplate===null||selectedTemplate===void 0?void 0:selectedTemplate.template_content)||'').replace(/\\{\\{(\\w+)\\}\\}/g,(match,varName)=>formData.variables[varName]||\"[\".concat(varName,\"]\"))},style:{border:'1px solid #ddd',padding:'20px',backgroundColor:'white',fontFamily:'Times New Roman, serif'}})})})]})})]}),formData.customer_id&&formData.template_id&&/*#__PURE__*/_jsx(Alert,{variant:\"light\",children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{md:3,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Kh\\xE1ch h\\xE0ng:\"}),/*#__PURE__*/_jsx(\"br\",{}),(selectedCustomer===null||selectedCustomer===void 0?void 0:selectedCustomer.name)||(selectedCustomer===null||selectedCustomer===void 0?void 0:selectedCustomer.full_name)]}),/*#__PURE__*/_jsxs(Col,{md:3,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"M\\u1EABu h\\u1EE3p \\u0111\\u1ED3ng:\"}),/*#__PURE__*/_jsx(\"br\",{}),selectedTemplate===null||selectedTemplate===void 0?void 0:selectedTemplate.template_name]}),/*#__PURE__*/_jsxs(Col,{md:3,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Di\\u1EC7n t\\xEDch:\"}),/*#__PURE__*/_jsx(\"br\",{}),formData.warehouse_area,\" m\\xB2\"]}),/*#__PURE__*/_jsxs(Col,{md:3,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Gi\\xE1 thu\\xEA:\"}),/*#__PURE__*/_jsx(\"br\",{}),formatCurrency(formData.rental_price),\" VN\\u0110/th\\xE1ng\"]})]})})]})]}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:onHide,disabled:loading,children:\"H\\u1EE7y\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:handleSubmit,disabled:loading||!formData.customer_id||!formData.template_id,children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"spinner-border spinner-border-sm me-2\"}),\"\\u0110ang t\\u1EA1o...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-save me-2\"}),\"T\\u1EA1o h\\u1EE3p \\u0111\\u1ED3ng\"]})})]})]});};export default ContractCreator;","map":{"version":3,"names":["React","useState","useEffect","useCallback","Modal","Form","Row","Col","Button","Alert","Tabs","Tab","Card","useAuth","useNotification","contractService","customerService","projectService","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ContractCreator","_ref","show","onHide","onSuccess","initialCustomerId","user","showSuccess","showError","loading","setLoading","activeTab","setActiveTab","customers","setCustomers","customersLoaded","setCustomersLoaded","templates","setTemplates","projects","setProjects","zones","setZones","selectedCustomer","setSelectedCustomer","selectedTemplate","setSelectedTemplate","selectedProject","setSelectedProject","selectedZone","setSelectedZone","templatesLoaded","setTemplatesLoaded","projectsLoaded","setProjectsLoaded","formData","setFormData","contract_title","customer_id","customer_company_id","template_id","project_id","zone_id","party_a_name","party_a_address","party_a_representative","party_a_position","party_a_id_number","warehouse_location","warehouse_area","warehouse_purpose","rental_price","deposit_amount","service_fee","start_date","end_date","auto_renewal","renewal_period","payment_cycle","payment_due_date","payment_method","late_fee_percentage","special_terms","notes","assigned_to","id","variables","loadInitialData","_customersResponse$da","_templatesResponse$da","_projectsResponse$dat","_projectsResponse$dat2","customersResponse","templatesResponse","projectsResponse","Promise","all","getCustomers","limit","getContractTemplates","is_active","getProjects","data","loadedTemplates","Array","isArray","defaultTpl","find","t","is_default","prev","_objectSpread","String","loadedProjects","error","console","message","params","URLSearchParams","window","location","search","fromUrl","get","handleCustomerSelect","e","ensureAndSelectInitialCustomer","exists","some","c","_customerResponse$dat","customerResponse","getCustomer","customerData","customer","already","warn","fetchZones","zonesResponse","getZones","customerId","_customerResponse$dat2","parseInt","concat","name","full_name","party_b_name","party_b_address","address","party_b_representative","representative_name","party_b_position","party_b_tax_code","tax_code","handleTemplateSelect","templateId","template","templateVars","JSON","parse","newVariables","forEach","variable","toLocaleString","generateContractNumber","now","Date","year","getFullYear","month","getMonth","toString","padStart","random","Math","floor","calculateEndDate","startDate","months","arguments","length","undefined","start","end","setMonth","toISOString","split","handleSubmit","preventDefault","contract_number","response","createContract","resetForm","formatCurrency","amount","Intl","NumberFormat","format","formatCurrencyForVariable","size","scrollable","children","Header","closeButton","Title","className","Body","variant","md","customer_code","phone","representative_phone","email","representative_email","onSubmit","activeKey","onSelect","eventKey","title","Group","Label","Select","value","onChange","target","required","map","projectId","project","p","zoneId","z","zone_name","zone_code","disabled","zone","template_name","template_code","version","template_type","Control","type","placeholder","step","min","parseFloat","numericValue","replace","Text","round","endDate","toLocaleDateString","max","Check","label","checked","as","rows","vars","description","dangerouslySetInnerHTML","__html","template_content","match","varName","style","border","padding","backgroundColor","fontFamily","Footer","onClick"],"sources":["C:/Users/Admin/Documents/GitHub/MVG_InventoryManagement/KinhDoanh/client/src/components/Contracts/ContractCreator.js"],"sourcesContent":["/**\r\n * Contract Creator - Tạo hợp đồng từ mẫu với dữ liệu khách hàng\r\n */\r\n\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport { \r\n  Modal, Form, Row, Col, Button, Alert, Tabs, Tab,\r\n  Card \r\n} from 'react-bootstrap';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { useNotification } from '../../contexts/NotificationContext';\r\nimport contractService from '../../services/contractService';\r\nimport customerService from '../../services/customerService';\r\nimport projectService from '../../services/projectService';\r\n\r\nconst ContractCreator = ({ show, onHide, onSuccess, initialCustomerId = '' }) => {\r\n  const { user } = useAuth();\r\n  const { showSuccess, showError } = useNotification();\r\n  \r\n  const [loading, setLoading] = useState(false);\r\n  const [activeTab, setActiveTab] = useState('basic');\r\n  \r\n  // Data states\r\n  const [customers, setCustomers] = useState([]);\r\n  const [customersLoaded, setCustomersLoaded] = useState(false);\r\n  const [templates, setTemplates] = useState([]);\r\n  const [projects, setProjects] = useState([]);\r\n  const [zones, setZones] = useState([]);\r\n  const [selectedCustomer, setSelectedCustomer] = useState(null);\r\n  const [selectedTemplate, setSelectedTemplate] = useState(null);\r\n  const [selectedProject, setSelectedProject] = useState(null);\r\n  const [selectedZone, setSelectedZone] = useState(null);\r\n  const [templatesLoaded, setTemplatesLoaded] = useState(false);\r\n  const [projectsLoaded, setProjectsLoaded] = useState(false);\r\n  \r\n  \r\n  // Form data\r\n  const [formData, setFormData] = useState({\r\n    // Basic contract info\r\n    contract_title: '',\r\n    customer_id: '',\r\n    customer_company_id: '',\r\n    template_id: '',\r\n    project_id: '',\r\n    zone_id: '',\r\n    \r\n    // Party A (Lessor) - Bên cho thuê\r\n    party_a_name: 'CÔNG TY KHO MVG',\r\n    party_a_address: 'Khu công nghiệp ABC, Bình Dương',\r\n    party_a_representative: 'Nguyễn Văn A',\r\n    party_a_position: 'Giám đốc',\r\n    party_a_id_number: '123456789',\r\n    \r\n    // Contract terms\r\n    warehouse_location: '',\r\n    warehouse_area: 0,\r\n    warehouse_purpose: '',\r\n    rental_price: 0,\r\n    deposit_amount: 0,\r\n    service_fee: 0,\r\n    \r\n    // Dates\r\n    start_date: '',\r\n    end_date: '',\r\n    auto_renewal: false,\r\n    renewal_period: 12,\r\n    \r\n    // Payment\r\n    payment_cycle: 'monthly',\r\n    payment_due_date: 5,\r\n    payment_method: 'Chuyển khoản',\r\n    late_fee_percentage: 2.0,\r\n    \r\n    // Additional terms\r\n    special_terms: '',\r\n    notes: '',\r\n    assigned_to: user?.id || '',\r\n    \r\n    // Template variables\r\n    variables: {}\r\n  });\r\n\r\n  const loadInitialData = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      const [customersResponse, templatesResponse, projectsResponse] = await Promise.all([\r\n        customerService.getCustomers({ limit: 100 }),\r\n        contractService.getContractTemplates({ is_active: true }),\r\n        projectService.getProjects({ limit: 100 })\r\n      ]);\r\n      // Customers: API shape { success, data: { customers: [...] } }\r\n      setCustomers(customersResponse?.data?.customers || customersResponse?.customers || []);\r\n      setCustomersLoaded(true);\r\n      // Templates: API shape can be: { success, data: [...] } or { success, data: { templates: [...] } } or { templates: [...] }\r\n      const loadedTemplates = \r\n        templatesResponse?.data?.templates || \r\n        templatesResponse?.data || \r\n        templatesResponse?.templates || \r\n        templatesResponse || [];\r\n      setTemplates(Array.isArray(loadedTemplates) ? loadedTemplates : []);\r\n      setTemplatesLoaded(true);\r\n      // Auto-select default template if available\r\n      const defaultTpl = Array.isArray(loadedTemplates) && loadedTemplates.find(t => t.is_default);\r\n      if (defaultTpl) {\r\n        setSelectedTemplate(defaultTpl);\r\n        setFormData(prev => ({ ...prev, template_id: String(defaultTpl.id) }));\r\n      }\r\n      // Projects: shape could be { success, data: { projects: [...] } } or { success, projects: [...] }\r\n      const loadedProjects = \r\n        projectsResponse?.data?.projects || \r\n        projectsResponse?.projects || \r\n        projectsResponse?.data || [];\r\n      setProjects(Array.isArray(loadedProjects) ? loadedProjects : (Array.isArray(projectsResponse?.data?.projects) ? projectsResponse.data.projects : []));\r\n      setProjectsLoaded(true);\r\n    } catch (error) {\r\n      console.error('Error loading initial data:', error);\r\n      showError('Không thể tải dữ liệu: ' + error.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [showError]);\r\n\r\n  // Load initial data\r\n  useEffect(() => {\r\n    if (show) {\r\n      loadInitialData();\r\n    }\r\n  }, [show, loadInitialData]);\r\n\r\n  // Read customer id from URL if not provided via props\r\n  useEffect(() => {\r\n    if (!show) return;\r\n    if (initialCustomerId) return;\r\n    try {\r\n      const params = new URLSearchParams(window.location.search);\r\n      const fromUrl = params.get('customer') || params.get('customer_id');\r\n      if (fromUrl) {\r\n        handleCustomerSelect(fromUrl);\r\n      }\r\n    } catch (e) {\r\n      // no-op\r\n    }\r\n  }, [show, initialCustomerId]);\r\n\r\n  // If initialCustomerId is provided, preselect it after data loads\r\n  useEffect(() => {\r\n    async function ensureAndSelectInitialCustomer() {\r\n      if (!show || !initialCustomerId) return;\r\n      // If list already contains the customer, select it\r\n      const exists = customers.some(c => String(c.id) === String(initialCustomerId));\r\n      if (exists) {\r\n        handleCustomerSelect(initialCustomerId);\r\n        return;\r\n      }\r\n      // Otherwise fetch it and add to list\r\n      try {\r\n        const customerResponse = await customerService.getCustomer(initialCustomerId);\r\n        const customerData = customerResponse?.data?.customer || customerResponse?.data || customerResponse;\r\n        if (customerData && customerData.id) {\r\n          setCustomers(prev => {\r\n            const already = prev.some(c => String(c.id) === String(customerData.id));\r\n            return already ? prev : [customerData, ...prev];\r\n          });\r\n          handleCustomerSelect(customerData.id);\r\n        }\r\n      } catch (e) {\r\n        console.warn('Could not preload initial customer', e?.message || e);\r\n      }\r\n    }\r\n    ensureAndSelectInitialCustomer();\r\n  }, [show, initialCustomerId, customers, customersLoaded]);\r\n\r\n  // Load zones when project changes\r\n  useEffect(() => {\r\n    async function fetchZones() {\r\n      if (formData.project_id) {\r\n        const zonesResponse = await projectService.getZones(formData.project_id);\r\n        setZones(zonesResponse.zones || []);\r\n      } else {\r\n        setZones([]);\r\n      }\r\n    }\r\n    fetchZones();\r\n  }, [formData.project_id]);\r\n\r\n  // Handle customer selection\r\n  const handleCustomerSelect = async (customerId) => {\r\n    try {\r\n      const customer = customers.find(c => c.id === parseInt(customerId));\r\n      if (!customer) return;\r\n      \r\n      setSelectedCustomer(customer);\r\n      \r\n      // Load customer details\r\n      const customerResponse = await customerService.getCustomer(customerId);\r\n      const customerData = customerResponse?.data?.customer || customerResponse?.data || customerResponse;\r\n      \r\n      // Auto-fill contract data based on available fields from API\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        customer_id: customerId,\r\n        contract_title: `Hợp đồng thuê kho - ${customerData.name || customerData.full_name || 'Khách hàng'}`,\r\n        warehouse_purpose: customerData.warehouse_purpose || 'Lưu kho hàng hóa',\r\n        variables: {\r\n          ...prev.variables,\r\n          // Auto-fill Party B info\r\n          party_b_name: customerData.name || customerData.full_name,\r\n          party_b_address: customerData.address || '',\r\n          party_b_representative: customerData.representative_name || customerData.full_name || '',\r\n          party_b_position: 'Giám đốc',\r\n          party_b_tax_code: customerData.tax_code || '',\r\n          warehouse_purpose: customerData.warehouse_purpose || 'Lưu kho hàng hóa',\r\n          payment_cycle: prev.payment_cycle === 'monthly' ? 'Hàng tháng' :\r\n                        prev.payment_cycle === 'quarterly' ? 'Hàng quý' : 'Hàng năm',\r\n          payment_due_date: prev.payment_due_date\r\n        }\r\n      }));\r\n      \r\n    } catch (error) {\r\n      showError('Không thể tải thông tin khách hàng: ' + error.message);\r\n    }\r\n  };\r\n\r\n  // Handle template selection\r\n  const handleTemplateSelect = (templateId) => {\r\n    if (!templateId) {\r\n      setSelectedTemplate(null);\r\n      setFormData(prev => ({ ...prev, template_id: '' }));\r\n      return;\r\n    }\r\n    const template = templates.find(t => t.id === parseInt(templateId));\r\n    if (!template) return;\r\n    \r\n    setSelectedTemplate(template);\r\n    setFormData(prev => ({ ...prev, template_id: templateId }));\r\n    \r\n    // Parse template variables\r\n    if (template.variables) {\r\n      let templateVars = [];\r\n      try {\r\n        templateVars = typeof template.variables === 'string' \r\n          ? JSON.parse(template.variables) \r\n          : (Array.isArray(template.variables) ? template.variables : []);\r\n      } catch (e) {\r\n        console.warn('Invalid template variables JSON:', e?.message || e);\r\n        templateVars = [];\r\n      }\r\n      \r\n      // Initialize variables with current form data\r\n      const newVariables = { ...formData.variables };\r\n      templateVars.forEach(variable => {\r\n        if (!newVariables[variable.name]) {\r\n          // Auto-populate common variables\r\n          switch (variable.name) {\r\n            case 'party_a_name':\r\n              newVariables[variable.name] = formData.party_a_name;\r\n              break;\r\n            case 'party_a_representative':\r\n              newVariables[variable.name] = formData.party_a_representative;\r\n              break;\r\n            case 'start_date':\r\n              newVariables[variable.name] = formData.start_date;\r\n              break;\r\n            case 'end_date':\r\n              newVariables[variable.name] = formData.end_date;\r\n              break;\r\n            case 'warehouse_location':\r\n              newVariables[variable.name] = formData.warehouse_location;\r\n              break;\r\n            case 'rental_price':\r\n              newVariables[variable.name] = formData.rental_price.toLocaleString('vi-VN') + ' VNĐ';\r\n              break;\r\n            default:\r\n              newVariables[variable.name] = '';\r\n          }\r\n        }\r\n      });\r\n      \r\n      setFormData(prev => ({ ...prev, variables: newVariables }));\r\n      // Move to variables tab to let user fill missing variables\r\n      setActiveTab('variables');\r\n    }\r\n  };\r\n\r\n  // Generate contract number\r\n  const generateContractNumber = () => {\r\n    const now = new Date();\r\n    const year = now.getFullYear();\r\n    const month = (now.getMonth() + 1).toString().padStart(2, '0');\r\n    const random = Math.floor(Math.random() * 10000).toString().padStart(4, '0');\r\n    return `HD${year}${month}${random}`;\r\n  };\r\n\r\n  // Calculate contract end date\r\n  const calculateEndDate = (startDate, months = 12) => {\r\n    const start = new Date(startDate);\r\n    const end = new Date(start);\r\n    end.setMonth(end.getMonth() + months);\r\n    return end.toISOString().split('T')[0];\r\n  };\r\n\r\n  // Handle form submission\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    try {\r\n      setLoading(true);\r\n      \r\n      // Generate contract number if not provided\r\n      if (!formData.variables.contract_number) {\r\n        formData.variables.contract_number = generateContractNumber();\r\n      }\r\n      \r\n      // Create contract\r\n      const response = await contractService.createContract(formData);\r\n      \r\n      showSuccess('Tạo hợp đồng thành công');\r\n      onSuccess?.(response.data);\r\n      onHide();\r\n      resetForm();\r\n      \r\n    } catch (error) {\r\n      showError('Lỗi tạo hợp đồng: ' + error.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Reset form\r\n  const resetForm = () => {\r\n    setFormData({\r\n      contract_title: '',\r\n      customer_id: '',\r\n      customer_company_id: '',\r\n      template_id: '',\r\n      project_id: '',\r\n      zone_id: '',\r\n      party_a_name: 'CÔNG TY KHO MVG',\r\n      party_a_address: 'Khu công nghiệp ABC, Bình Dương',\r\n      party_a_representative: 'Nguyễn Văn A',\r\n      party_a_position: 'Giám đốc',\r\n      party_a_id_number: '123456789',\r\n      warehouse_location: '',\r\n      warehouse_area: 0,\r\n      warehouse_purpose: '',\r\n      rental_price: 0,\r\n      deposit_amount: 0,\r\n      service_fee: 0,\r\n      start_date: '',\r\n      end_date: '',\r\n      auto_renewal: false,\r\n      renewal_period: 12,\r\n      payment_cycle: 'monthly',\r\n      payment_due_date: 5,\r\n      payment_method: 'Chuyển khoản',\r\n      late_fee_percentage: 2.0,\r\n      special_terms: '',\r\n      notes: '',\r\n      assigned_to: user?.id || '',\r\n      variables: {}\r\n    });\r\n    setSelectedCustomer(null);\r\n    setSelectedTemplate(null);\r\n    setSelectedProject(null);\r\n    setSelectedZone(null);\r\n    setActiveTab('basic');\r\n  };\r\n\r\n  // Format currency for display (without currency symbol)\r\n  const formatCurrency = (amount) => {\r\n    return new Intl.NumberFormat('vi-VN').format(amount);\r\n  };\r\n\r\n  // Format currency for variables (with currency symbol)\r\n  const formatCurrencyForVariable = (amount) => {\r\n    return new Intl.NumberFormat('vi-VN').format(amount) + ' VNĐ';\r\n  };\r\n\r\n  return (\r\n    <Modal show={show} onHide={onHide} size=\"xl\" scrollable>\r\n      <Modal.Header closeButton>\r\n        <Modal.Title>\r\n          <i className=\"fas fa-plus-circle me-2\"></i>\r\n          Tạo hợp đồng mới\r\n        </Modal.Title>\r\n      </Modal.Header>\r\n      \r\n      <Modal.Body>\r\n        {selectedCustomer && (\r\n          <Alert variant=\"info\" className=\"mb-3\">\r\n            <Row>\r\n              <Col md={4}>\r\n                <div><strong>Khách hàng:</strong> {selectedCustomer.name || selectedCustomer.full_name}</div>\r\n                {selectedCustomer.customer_code && (\r\n                  <div><small className=\"text-muted\">Mã KH: {selectedCustomer.customer_code}</small></div>\r\n                )}\r\n              </Col>\r\n              <Col md={4}>\r\n                <div><strong>Điện thoại:</strong> {selectedCustomer.phone || selectedCustomer.representative_phone || '—'}</div>\r\n                <div><strong>Email:</strong> {selectedCustomer.email || selectedCustomer.representative_email || '—'}</div>\r\n              </Col>\r\n              <Col md={4}>\r\n                <div><strong>Địa chỉ:</strong> {selectedCustomer.address || '—'}</div>\r\n              </Col>\r\n            </Row>\r\n          </Alert>\r\n        )}\r\n        <Form onSubmit={handleSubmit}>\r\n          <Tabs activeKey={activeTab} onSelect={setActiveTab} className=\"mb-3\">\r\n            {/* Tab 1: Thông tin hợp đồng (gộp cơ bản + điều khoản) */}\r\n            <Tab eventKey=\"basic\" title=\"Thông tin hợp đồng\">\r\n              <Row>\r\n                <Col md={6}>\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Label>Chọn khách hàng *</Form.Label>\r\n                    <Form.Select\r\n                      value={formData.customer_id}\r\n                      onChange={e => handleCustomerSelect(e.target.value)}\r\n                      required\r\n                    >\r\n                      <option value=\"\">-- Chọn khách hàng --</option>\r\n                      {customers.map(customer => (\r\n                        <option key={customer.id} value={customer.id}>\r\n                          {(customer.name || customer.full_name || 'Khách hàng')} {customer.customer_code ? `(${customer.customer_code})` : ''}\r\n                        </option>\r\n                      ))}\r\n                    </Form.Select>\r\n                  </Form.Group>\r\n                  {selectedCustomer && (\r\n                    <Alert variant=\"info\">\r\n                      <strong>Thông tin khách hàng:</strong><br/>\r\n                      <small>\r\n                        SĐT: {selectedCustomer.phone}<br/>\r\n                        Email: {selectedCustomer.email}<br/>\r\n                        Địa chỉ: {selectedCustomer.address}\r\n                      </small>\r\n                    </Alert>\r\n                  )}\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Label>Chọn dự án *</Form.Label>\r\n                    <Form.Select\r\n                      value={formData.project_id || ''}\r\n                      onChange={e => {\r\n                        const projectId = e.target.value;\r\n                        const project = projects.find(p => p.id === parseInt(projectId));\r\n                        setSelectedProject(project || null);\r\n                        setFormData(prev => ({ ...prev, project_id: projectId, zone_id: '', warehouse_location: '' }));\r\n                      }}\r\n                      required\r\n                    >\r\n                      <option value=\"\">-- Chọn dự án --</option>\r\n                      {projects.map(project => (\r\n                        <option key={project.id} value={project.id}>{project.name}</option>\r\n                      ))}\r\n                    </Form.Select>\r\n                  </Form.Group>\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Label>Vị trí kho thuê *</Form.Label>\r\n                    <Form.Select\r\n                      value={formData.zone_id || ''}\r\n                      onChange={e => {\r\n                        const zoneId = e.target.value;\r\n                        const selectedZone = zones.find(z => z.id === parseInt(zoneId));\r\n                        setFormData(prev => ({\r\n                          ...prev,\r\n                          zone_id: zoneId,\r\n                          warehouse_location: selectedZone ? `${selectedZone.zone_name || selectedZone.zone_code} - ${selectedProject?.name || ''}` : '',\r\n                          variables: {\r\n                            ...prev.variables,\r\n                            warehouse_location: selectedZone ? `${selectedZone.zone_name || selectedZone.zone_code} - ${selectedProject?.name || ''}` : ''\r\n                          }\r\n                        }));\r\n                        setSelectedZone(selectedZone || null);\r\n                      }}\r\n                      required\r\n                      disabled={!formData.project_id}\r\n                    >\r\n                      <option value=\"\">-- Chọn kho --</option>\r\n                      {zones.map(zone => (\r\n                        <option key={zone.id} value={zone.id}>{zone.zone_name} ({zone.zone_code})</option>\r\n                      ))}\r\n                    </Form.Select>\r\n                  </Form.Group>\r\n                </Col>\r\n                <Col md={6}>\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Label>Chọn mẫu hợp đồng *</Form.Label>\r\n                    <Form.Select\r\n                      value={formData.template_id}\r\n                      onChange={e => handleTemplateSelect(e.target.value)}\r\n                      required\r\n                    >\r\n                      <option value=\"\">-- Chọn mẫu hợp đồng --</option>\r\n                      {templates.map(template => (\r\n                        <option key={template.id} value={template.id}>\r\n                          {template.template_name}\r\n                          {template.is_default && ' (Mặc định)'}\r\n                        </option>\r\n                      ))}\r\n                    </Form.Select>\r\n                  </Form.Group>\r\n                  {selectedTemplate && (\r\n                    <Alert variant=\"success\">\r\n                      <strong>Mẫu đã chọn:</strong><br/>\r\n                      <small>\r\n                        Mã: {selectedTemplate.template_code}<br/>\r\n                        Phiên bản: {selectedTemplate.version}<br/>\r\n                        Loại: {selectedTemplate.template_type}\r\n                      </small>\r\n                    </Alert>\r\n                  )}\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Label>Tiêu đề hợp đồng *</Form.Label>\r\n                    <Form.Control\r\n                      type=\"text\"\r\n                      value={formData.contract_title}\r\n                      onChange={e => setFormData(prev => ({ ...prev, contract_title: e.target.value }))}\r\n                      placeholder=\"VD: Hợp đồng thuê kho - Công ty ABC\"\r\n                      required\r\n                    />\r\n                  </Form.Group>\r\n\r\n                  <Row>\r\n                    <Col md={6}>\r\n                      <Form.Group className=\"mb-3\">\r\n                        <Form.Label>Diện tích (m²) *</Form.Label>\r\n                        <Form.Control\r\n                          type=\"number\"\r\n                          step=\"0.1\"\r\n                          min=\"0\"\r\n                          value={formData.warehouse_area}\r\n                          onChange={(e) => {\r\n                            const value = parseFloat(e.target.value) || 0;\r\n                            setFormData(prev => ({\r\n                              ...prev,\r\n                              warehouse_area: value,\r\n                              variables: {\r\n                                ...prev.variables,\r\n                                warehouse_area: value\r\n                              }\r\n                            }));\r\n                          }}\r\n                          required\r\n                        />\r\n                      </Form.Group>\r\n                    </Col>\r\n                    \r\n                    <Col md={6}>\r\n                      <Form.Group className=\"mb-3\">\r\n                        <Form.Label>Giá thuê/tháng (VNĐ) *</Form.Label>\r\n                        <Form.Control\r\n                          type=\"text\"\r\n                          value={formData.rental_price ? formatCurrency(formData.rental_price) : ''}\r\n                          onChange={(e) => {\r\n                            // Remove all non-digits\r\n                            const numericValue = e.target.value.replace(/\\D/g, '');\r\n                            const value = parseInt(numericValue) || 0;\r\n                            setFormData(prev => ({\r\n                              ...prev,\r\n                              rental_price: value,\r\n                              variables: {\r\n                                ...prev.variables,\r\n                                rental_price: formatCurrencyForVariable(value)\r\n                              }\r\n                            }));\r\n                          }}\r\n                          placeholder=\"VD: 10,000,000\"\r\n                          required\r\n                        />\r\n                        {formData.rental_price > 0 && formData.warehouse_area > 0 && (\r\n                          <Form.Text className=\"text-muted\">\r\n                            Giá/m²: {formatCurrency(Math.round(formData.rental_price / formData.warehouse_area))} VNĐ/m²\r\n                          </Form.Text>\r\n                        )}\r\n                      </Form.Group>\r\n                    </Col>\r\n                  </Row>\r\n\r\n                  <Row>\r\n                    <Col md={6}>\r\n                      <Form.Group className=\"mb-3\">\r\n                        <Form.Label>Tiền cọc (VNĐ)</Form.Label>\r\n                        <Form.Control\r\n                          type=\"text\"\r\n                          value={formData.deposit_amount ? formatCurrency(formData.deposit_amount) : ''}\r\n                          onChange={(e) => {\r\n                            // Remove all non-digits\r\n                            const numericValue = e.target.value.replace(/\\D/g, '');\r\n                            const value = parseInt(numericValue) || 0;\r\n                            setFormData(prev => ({\r\n                              ...prev,\r\n                              deposit_amount: value,\r\n                              variables: {\r\n                                ...prev.variables,\r\n                                deposit_amount: formatCurrencyForVariable(value)\r\n                              }\r\n                            }));\r\n                          }}\r\n                          placeholder=\"VD: 5,000,000\"\r\n                        />\r\n                      </Form.Group>\r\n                    </Col>\r\n                    \r\n                    <Col md={6}>\r\n                      <Form.Group className=\"mb-3\">\r\n                        <Form.Label>Phí dịch vụ (VNĐ)</Form.Label>\r\n                        <Form.Control\r\n                          type=\"text\"\r\n                          value={formData.service_fee ? formatCurrency(formData.service_fee) : ''}\r\n                          onChange={(e) => {\r\n                            // Remove all non-digits\r\n                            const numericValue = e.target.value.replace(/\\D/g, '');\r\n                            const value = parseInt(numericValue) || 0;\r\n                            setFormData(prev => ({\r\n                              ...prev,\r\n                              service_fee: value,\r\n                              variables: {\r\n                                ...prev.variables,\r\n                                service_fee: formatCurrencyForVariable(value)\r\n                              }\r\n                            }));\r\n                          }}\r\n                          placeholder=\"VD: 500,000\"\r\n                        />\r\n                      </Form.Group>\r\n                    </Col>\r\n                  </Row>\r\n\r\n                  <Row>\r\n                    <Col md={6}>\r\n                      <Form.Group className=\"mb-3\">\r\n                        <Form.Label>Ngày bắt đầu *</Form.Label>\r\n                        <Form.Control\r\n                          type=\"date\"\r\n                          value={formData.start_date}\r\n                          onChange={(e) => {\r\n                            const startDate = e.target.value;\r\n                            const endDate = calculateEndDate(startDate, formData.renewal_period);\r\n                            setFormData(prev => ({\r\n                              ...prev,\r\n                              start_date: startDate,\r\n                              end_date: endDate,\r\n                              variables: {\r\n                                ...prev.variables,\r\n                                start_date: new Date(startDate).toLocaleDateString('vi-VN'),\r\n                                end_date: new Date(endDate).toLocaleDateString('vi-VN')\r\n                              }\r\n                            }));\r\n                          }}\r\n                          required\r\n                        />\r\n                      </Form.Group>\r\n                    </Col>\r\n                    \r\n                    <Col md={6}>\r\n                      <Form.Group className=\"mb-3\">\r\n                        <Form.Label>Ngày kết thúc *</Form.Label>\r\n                        <Form.Control\r\n                          type=\"date\"\r\n                          value={formData.end_date}\r\n                          onChange={(e) => {\r\n                            const value = e.target.value;\r\n                            setFormData(prev => ({\r\n                              ...prev,\r\n                              end_date: value,\r\n                              variables: {\r\n                                ...prev.variables,\r\n                                end_date: new Date(value).toLocaleDateString('vi-VN')\r\n                              }\r\n                            }));\r\n                          }}\r\n                          min={formData.start_date}\r\n                          required\r\n                        />\r\n                      </Form.Group>\r\n                    </Col>\r\n                  </Row>\r\n\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Label>Chu kỳ thanh toán</Form.Label>\r\n                    <Form.Select\r\n                      value={formData.payment_cycle}\r\n                      onChange={(e) => setFormData(prev => ({\r\n                        ...prev,\r\n                        payment_cycle: e.target.value,\r\n                        variables: {\r\n                          ...prev.variables,\r\n                          payment_cycle: e.target.value === 'monthly' ? 'Hàng tháng' :\r\n                                        e.target.value === 'quarterly' ? 'Hàng quý' : 'Hàng năm'\r\n                        }\r\n                      }))}\r\n                    >\r\n                      <option value=\"monthly\">Hàng tháng</option>\r\n                      <option value=\"quarterly\">Hàng quý</option>\r\n                      <option value=\"yearly\">Hàng năm</option>\r\n                    </Form.Select>\r\n                  </Form.Group>\r\n\r\n                  <Row>\r\n                    <Col md={6}>\r\n                      <Form.Group className=\"mb-3\">\r\n                        <Form.Label>Hạn thanh toán (ngày)</Form.Label>\r\n                        <Form.Control\r\n                          type=\"number\"\r\n                          min=\"1\"\r\n                          max=\"31\"\r\n                          value={formData.payment_due_date}\r\n                          onChange={(e) => {\r\n                            const value = parseInt(e.target.value) || 5;\r\n                            setFormData(prev => ({\r\n                              ...prev,\r\n                              payment_due_date: value,\r\n                              variables: {\r\n                                ...prev.variables,\r\n                                payment_due_date: value\r\n                              }\r\n                            }));\r\n                          }}\r\n                        />\r\n                      </Form.Group>\r\n                    </Col>\r\n                    \r\n                    <Col md={6}>\r\n                      <Form.Group className=\"mb-3\">\r\n                        <Form.Label>Phí trễ hạn (%)</Form.Label>\r\n                        <Form.Control\r\n                          type=\"number\"\r\n                          step=\"0.1\"\r\n                          min=\"0\"\r\n                          max=\"10\"\r\n                          value={formData.late_fee_percentage}\r\n                          onChange={(e) => setFormData(prev => ({\r\n                            ...prev,\r\n                            late_fee_percentage: parseFloat(e.target.value) || 2.0\r\n                          }))}\r\n                        />\r\n                      </Form.Group>\r\n                    </Col>\r\n                  </Row>\r\n\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Check\r\n                      type=\"checkbox\"\r\n                      id=\"auto_renewal\"\r\n                      label=\"Tự động gia hạn\"\r\n                      checked={formData.auto_renewal}\r\n                      onChange={(e) => setFormData(prev => ({\r\n                        ...prev,\r\n                        auto_renewal: e.target.checked\r\n                      }))}\r\n                    />\r\n                  </Form.Group>\r\n\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Label>Mục đích sử dụng kho</Form.Label>\r\n                    <Form.Control\r\n                      type=\"text\"\r\n                      value={formData.warehouse_purpose}\r\n                      onChange={(e) => {\r\n                        const value = e.target.value;\r\n                        setFormData(prev => ({\r\n                          ...prev,\r\n                          warehouse_purpose: value,\r\n                          variables: {\r\n                            ...prev.variables,\r\n                            warehouse_purpose: value\r\n                          }\r\n                        }));\r\n                      }}\r\n                      placeholder=\"VD: Lưu kho hàng hóa, Sản xuất, Phân phối...\"\r\n                    />\r\n                  </Form.Group>\r\n\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Label>Điều khoản đặc biệt</Form.Label>\r\n                    <Form.Control\r\n                      as=\"textarea\"\r\n                      rows={3}\r\n                      value={formData.special_terms}\r\n                      onChange={(e) => {\r\n                        const value = e.target.value;\r\n                        setFormData(prev => ({\r\n                          ...prev,\r\n                          special_terms: value,\r\n                          variables: {\r\n                            ...prev.variables,\r\n                            special_terms: value\r\n                          }\r\n                        }));\r\n                      }}\r\n                      placeholder=\"Các điều khoản đặc biệt khác...\"\r\n                    />\r\n                  </Form.Group>\r\n                </Col>\r\n              </Row>\r\n            </Tab>\r\n\r\n            {/* Tab 2: Biến mẫu */}\r\n            <Tab eventKey=\"variables\" title=\"Biến mẫu\" disabled={!selectedTemplate}>\r\n              {selectedTemplate && selectedTemplate.variables && (\r\n                <div>\r\n                  <Alert variant=\"info\">\r\n                    <i className=\"fas fa-info-circle me-2\"></i>\r\n                    Các biến này sẽ được thay thế trong nội dung hợp đồng cuối cùng.\r\n                  </Alert>\r\n                  \r\n                  <Row>\r\n                    {(() => { let vars = []; try { vars = typeof selectedTemplate.variables === 'string' ? JSON.parse(selectedTemplate.variables) : (Array.isArray(selectedTemplate.variables) ? selectedTemplate.variables : []); } catch (e) { vars = []; } return vars; })().map(variable => (\r\n                      <Col md={6} key={variable.name}>\r\n                        <Form.Group className=\"mb-3\">\r\n                          <Form.Label>\r\n                            {variable.description || variable.name}\r\n                            {variable.required && <span className=\"text-danger\">*</span>}\r\n                          </Form.Label>\r\n                          \r\n                          {variable.type === 'boolean' ? (\r\n                            <Form.Check\r\n                              type=\"checkbox\"\r\n                              checked={formData.variables[variable.name] === 'true'}\r\n                              onChange={(e) => setFormData(prev => ({\r\n                                ...prev,\r\n                                variables: {\r\n                                  ...prev.variables,\r\n                                  [variable.name]: e.target.checked.toString()\r\n                                }\r\n                              }))}\r\n                            />\r\n                          ) : (\r\n                            <Form.Control\r\n                              type={variable.type === 'date' ? 'date' : \r\n                                   variable.type === 'number' ? 'number' : 'text'}\r\n                              value={formData.variables[variable.name] || ''}\r\n                              onChange={(e) => setFormData(prev => ({\r\n                                ...prev,\r\n                                variables: {\r\n                                  ...prev.variables,\r\n                                  [variable.name]: e.target.value\r\n                                }\r\n                              }))}\r\n                              required={variable.required}\r\n                              placeholder={`{{${variable.name}}}`}\r\n                            />\r\n                          )}\r\n                          \r\n                          <Form.Text className=\"text-muted\">\r\n                            Biến: <code>{`{{${variable.name}}}`}</code>\r\n                          </Form.Text>\r\n                        </Form.Group>\r\n                      </Col>\r\n                    ))}\r\n                  </Row>\r\n                </div>\r\n              )}\r\n            </Tab>\r\n\r\n            {/* Tab 3: Preview */}\r\n            <Tab eventKey=\"preview\" title=\"Xem trước\" disabled={!selectedTemplate}>\r\n              {selectedTemplate && (\r\n                <div>\r\n                  <Alert variant=\"success\">\r\n                    <i className=\"fas fa-eye me-2\"></i>\r\n                    Xem trước nội dung hợp đồng với dữ liệu đã nhập\r\n                  </Alert>\r\n                  \r\n                  <Card>\r\n                    <Card.Body>\r\n                      <div \r\n                        className=\"contract-preview\"\r\n                        dangerouslySetInnerHTML={{\r\n                          __html: String(selectedTemplate?.template_content || '').replace(\r\n                            /\\{\\{(\\w+)\\}\\}/g,\r\n                            (match, varName) => formData.variables[varName] || `[${varName}]`\r\n                          )\r\n                        }}\r\n                        style={{ \r\n                          border: '1px solid #ddd', \r\n                          padding: '20px',\r\n                          backgroundColor: 'white',\r\n                          fontFamily: 'Times New Roman, serif'\r\n                        }}\r\n                      />\r\n                    </Card.Body>\r\n                  </Card>\r\n                </div>\r\n              )}\r\n            </Tab>\r\n          </Tabs>\r\n\r\n          {/* Summary */}\r\n          {formData.customer_id && formData.template_id && (\r\n            <Alert variant=\"light\">\r\n              <Row>\r\n                <Col md={3}>\r\n                  <strong>Khách hàng:</strong><br/>\r\n                  {selectedCustomer?.name || selectedCustomer?.full_name}\r\n                </Col>\r\n                <Col md={3}>\r\n                  <strong>Mẫu hợp đồng:</strong><br/>\r\n                  {selectedTemplate?.template_name}\r\n                </Col>\r\n                <Col md={3}>\r\n                  <strong>Diện tích:</strong><br/>\r\n                  {formData.warehouse_area} m²\r\n                </Col>\r\n                <Col md={3}>\r\n                  <strong>Giá thuê:</strong><br/>\r\n                  {formatCurrency(formData.rental_price)} VNĐ/tháng\r\n                </Col>\r\n              </Row>\r\n            </Alert>\r\n          )}\r\n        </Form>\r\n      </Modal.Body>\r\n\r\n      <Modal.Footer>\r\n        <Button variant=\"secondary\" onClick={onHide} disabled={loading}>\r\n          Hủy\r\n        </Button>\r\n        \r\n        <Button \r\n          variant=\"primary\" \r\n          onClick={handleSubmit}\r\n          disabled={loading || !formData.customer_id || !formData.template_id}\r\n        >\r\n          {loading ? (\r\n            <>\r\n              <span className=\"spinner-border spinner-border-sm me-2\"></span>\r\n              Đang tạo...\r\n            </>\r\n          ) : (\r\n            <>\r\n              <i className=\"fas fa-save me-2\"></i>\r\n              Tạo hợp đồng\r\n            </>\r\n          )}\r\n        </Button>\r\n      </Modal.Footer>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default ContractCreator;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}