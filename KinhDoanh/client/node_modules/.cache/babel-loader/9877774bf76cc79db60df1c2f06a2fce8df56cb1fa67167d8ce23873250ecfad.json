{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Admin\\\\Documents\\\\GitHub\\\\MVG_InventoryManagement\\\\KinhDoanh\\\\client\\\\src\\\\components\\\\Contracts\\\\ContractCreator.js\",\n  _s = $RefreshSig$();\n/**\r\n * Contract Creator - Tạo hợp đồng từ mẫu với dữ liệu khách hàng\r\n */\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { Modal, Form, Row, Col, Button, Alert, Tabs, Tab, Card } from 'react-bootstrap';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { useNotification } from '../../contexts/NotificationContext';\nimport contractService from '../../services/contractService';\nimport customerService from '../../services/customerService';\nimport projectService from '../../services/projectService';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ContractCreator = ({\n  show,\n  onHide,\n  onSuccess,\n  initialCustomerId = ''\n}) => {\n  _s();\n  const {\n    user\n  } = useAuth();\n  const {\n    showSuccess,\n    showError\n  } = useNotification();\n  const [loading, setLoading] = useState(false);\n  const [activeTab, setActiveTab] = useState('basic');\n\n  // Data states\n  const [customers, setCustomers] = useState([]);\n  const [customersLoaded, setCustomersLoaded] = useState(false);\n  const [templates, setTemplates] = useState([]);\n  const [projects, setProjects] = useState([]);\n  const [zones, setZones] = useState([]);\n  const [selectedCustomer, setSelectedCustomer] = useState(null);\n  const [selectedTemplate, setSelectedTemplate] = useState(null);\n  const [selectedProject, setSelectedProject] = useState(null);\n  const [selectedZone, setSelectedZone] = useState(null);\n  const [templatesLoaded, setTemplatesLoaded] = useState(false);\n  const [projectsLoaded, setProjectsLoaded] = useState(false);\n\n  // Form data\n  const [formData, setFormData] = useState({\n    // Basic contract info\n    contract_title: '',\n    customer_id: '',\n    customer_company_id: '',\n    template_id: '',\n    project_id: '',\n    zone_id: '',\n    // Party A (Lessor) - Bên cho thuê\n    party_a_name: 'CÔNG TY KHO MVG',\n    party_a_address: 'Khu công nghiệp ABC, Bình Dương',\n    party_a_representative: 'Nguyễn Văn A',\n    party_a_position: 'Giám đốc',\n    party_a_id_number: '123456789',\n    // Contract terms\n    warehouse_location: '',\n    warehouse_area: 0,\n    rental_price: 0,\n    deposit_amount: 0,\n    service_fee: 0,\n    // Dates\n    start_date: '',\n    end_date: '',\n    auto_renewal: false,\n    renewal_period: 12,\n    // Payment\n    payment_cycle: 'monthly',\n    payment_due_date: 5,\n    payment_method: 'Chuyển khoản',\n    late_fee_percentage: 2.0,\n    // Additional terms\n    special_terms: '',\n    notes: '',\n    assigned_to: (user === null || user === void 0 ? void 0 : user.id) || '',\n    // Template variables\n    variables: {}\n  });\n  const loadInitialData = useCallback(async () => {\n    try {\n      var _customersResponse$da, _templatesResponse$da, _projectsResponse$dat, _projectsResponse$dat2;\n      setLoading(true);\n      const [customersResponse, templatesResponse, projectsResponse] = await Promise.all([customerService.getCustomers({\n        limit: 100\n      }), contractService.getContractTemplates({\n        is_active: true\n      }), projectService.getProjects({\n        limit: 100\n      })]);\n      // Customers: API shape { success, data: { customers: [...] } }\n      setCustomers((customersResponse === null || customersResponse === void 0 ? void 0 : (_customersResponse$da = customersResponse.data) === null || _customersResponse$da === void 0 ? void 0 : _customersResponse$da.customers) || (customersResponse === null || customersResponse === void 0 ? void 0 : customersResponse.customers) || []);\n      setCustomersLoaded(true);\n      // Templates: API shape can be: { success, data: [...] } or { success, data: { templates: [...] } } or { templates: [...] }\n      const loadedTemplates = (templatesResponse === null || templatesResponse === void 0 ? void 0 : (_templatesResponse$da = templatesResponse.data) === null || _templatesResponse$da === void 0 ? void 0 : _templatesResponse$da.templates) || (templatesResponse === null || templatesResponse === void 0 ? void 0 : templatesResponse.data) || (templatesResponse === null || templatesResponse === void 0 ? void 0 : templatesResponse.templates) || templatesResponse || [];\n      setTemplates(Array.isArray(loadedTemplates) ? loadedTemplates : []);\n      setTemplatesLoaded(true);\n      // Auto-select default template if available\n      const defaultTpl = Array.isArray(loadedTemplates) && loadedTemplates.find(t => t.is_default);\n      if (defaultTpl) {\n        setSelectedTemplate(defaultTpl);\n        setFormData(prev => ({\n          ...prev,\n          template_id: String(defaultTpl.id)\n        }));\n      }\n      // Projects: shape could be { success, data: { projects: [...] } } or { success, projects: [...] }\n      const loadedProjects = (projectsResponse === null || projectsResponse === void 0 ? void 0 : (_projectsResponse$dat = projectsResponse.data) === null || _projectsResponse$dat === void 0 ? void 0 : _projectsResponse$dat.projects) || (projectsResponse === null || projectsResponse === void 0 ? void 0 : projectsResponse.projects) || (projectsResponse === null || projectsResponse === void 0 ? void 0 : projectsResponse.data) || [];\n      setProjects(Array.isArray(loadedProjects) ? loadedProjects : Array.isArray(projectsResponse === null || projectsResponse === void 0 ? void 0 : (_projectsResponse$dat2 = projectsResponse.data) === null || _projectsResponse$dat2 === void 0 ? void 0 : _projectsResponse$dat2.projects) ? projectsResponse.data.projects : []);\n      setProjectsLoaded(true);\n    } catch (error) {\n      console.error('Error loading initial data:', error);\n      showError('Không thể tải dữ liệu: ' + error.message);\n    } finally {\n      setLoading(false);\n    }\n  }, [showError]);\n\n  // Load initial data\n  useEffect(() => {\n    if (show) {\n      loadInitialData();\n    }\n  }, [show, loadInitialData]);\n\n  // Read customer id from URL if not provided via props\n  useEffect(() => {\n    if (!show) return;\n    if (initialCustomerId) return;\n    try {\n      const params = new URLSearchParams(window.location.search);\n      const fromUrl = params.get('customer') || params.get('customer_id');\n      if (fromUrl) {\n        handleCustomerSelect(fromUrl);\n      }\n    } catch (e) {\n      // no-op\n    }\n  }, [show, initialCustomerId]);\n\n  // If initialCustomerId is provided, preselect it after data loads\n  useEffect(() => {\n    async function ensureAndSelectInitialCustomer() {\n      if (!show || !initialCustomerId) return;\n      // If list already contains the customer, select it\n      const exists = customers.some(c => String(c.id) === String(initialCustomerId));\n      if (exists) {\n        handleCustomerSelect(initialCustomerId);\n        return;\n      }\n      // Otherwise fetch it and add to list\n      try {\n        var _customerResponse$dat;\n        const customerResponse = await customerService.getCustomer(initialCustomerId);\n        const customerData = (customerResponse === null || customerResponse === void 0 ? void 0 : (_customerResponse$dat = customerResponse.data) === null || _customerResponse$dat === void 0 ? void 0 : _customerResponse$dat.customer) || (customerResponse === null || customerResponse === void 0 ? void 0 : customerResponse.data) || customerResponse;\n        if (customerData && customerData.id) {\n          setCustomers(prev => {\n            const already = prev.some(c => String(c.id) === String(customerData.id));\n            return already ? prev : [customerData, ...prev];\n          });\n          handleCustomerSelect(customerData.id);\n        }\n      } catch (e) {\n        console.warn('Could not preload initial customer', (e === null || e === void 0 ? void 0 : e.message) || e);\n      }\n    }\n    ensureAndSelectInitialCustomer();\n  }, [show, initialCustomerId, customers, customersLoaded]);\n\n  // Load zones when project changes\n  useEffect(() => {\n    async function fetchZones() {\n      if (formData.project_id) {\n        const zonesResponse = await projectService.getZones(formData.project_id);\n        setZones(zonesResponse.zones || []);\n      } else {\n        setZones([]);\n      }\n    }\n    fetchZones();\n  }, [formData.project_id]);\n\n  // Handle customer selection\n  const handleCustomerSelect = async customerId => {\n    try {\n      var _customerResponse$dat2;\n      const customer = customers.find(c => c.id === parseInt(customerId));\n      if (!customer) return;\n      setSelectedCustomer(customer);\n\n      // Load customer details\n      const customerResponse = await customerService.getCustomer(customerId);\n      const customerData = (customerResponse === null || customerResponse === void 0 ? void 0 : (_customerResponse$dat2 = customerResponse.data) === null || _customerResponse$dat2 === void 0 ? void 0 : _customerResponse$dat2.customer) || (customerResponse === null || customerResponse === void 0 ? void 0 : customerResponse.data) || customerResponse;\n\n      // Auto-fill contract data based on available fields from API\n      setFormData(prev => ({\n        ...prev,\n        customer_id: customerId,\n        contract_title: `Hợp đồng thuê kho - ${customerData.name || customerData.full_name || 'Khách hàng'}`,\n        warehouse_purpose: customerData.warehouse_purpose || 'Lưu kho hàng hóa',\n        variables: {\n          ...prev.variables,\n          // Auto-fill Party B info\n          party_b_name: customerData.name || customerData.full_name,\n          party_b_address: customerData.address || '',\n          party_b_representative: customerData.representative_name || customerData.full_name || '',\n          party_b_position: 'Giám đốc',\n          party_b_tax_code: customerData.tax_code || '',\n          warehouse_purpose: customerData.warehouse_purpose || 'Lưu kho hàng hóa',\n          payment_cycle: prev.payment_cycle === 'monthly' ? 'Hàng tháng' : prev.payment_cycle === 'quarterly' ? 'Hàng quý' : 'Hàng năm',\n          payment_due_date: prev.payment_due_date\n        }\n      }));\n    } catch (error) {\n      showError('Không thể tải thông tin khách hàng: ' + error.message);\n    }\n  };\n\n  // Handle template selection\n  const handleTemplateSelect = templateId => {\n    if (!templateId) {\n      setSelectedTemplate(null);\n      setFormData(prev => ({\n        ...prev,\n        template_id: ''\n      }));\n      return;\n    }\n    const template = templates.find(t => t.id === parseInt(templateId));\n    if (!template) return;\n    setSelectedTemplate(template);\n    setFormData(prev => ({\n      ...prev,\n      template_id: templateId\n    }));\n\n    // Parse template variables\n    if (template.variables) {\n      let templateVars = [];\n      try {\n        templateVars = typeof template.variables === 'string' ? JSON.parse(template.variables) : Array.isArray(template.variables) ? template.variables : [];\n      } catch (e) {\n        console.warn('Invalid template variables JSON:', (e === null || e === void 0 ? void 0 : e.message) || e);\n        templateVars = [];\n      }\n\n      // Initialize variables with current form data\n      const newVariables = {\n        ...formData.variables\n      };\n      templateVars.forEach(variable => {\n        if (!newVariables[variable.name]) {\n          // Auto-populate common variables\n          switch (variable.name) {\n            case 'party_a_name':\n              newVariables[variable.name] = formData.party_a_name;\n              break;\n            case 'party_a_representative':\n              newVariables[variable.name] = formData.party_a_representative;\n              break;\n            case 'start_date':\n              newVariables[variable.name] = formData.start_date;\n              break;\n            case 'end_date':\n              newVariables[variable.name] = formData.end_date;\n              break;\n            case 'warehouse_location':\n              newVariables[variable.name] = formData.warehouse_location;\n              break;\n            case 'rental_price':\n              newVariables[variable.name] = formData.rental_price.toLocaleString('vi-VN') + ' VNĐ';\n              break;\n            default:\n              newVariables[variable.name] = '';\n          }\n        }\n      });\n      setFormData(prev => ({\n        ...prev,\n        variables: newVariables\n      }));\n      // Move to variables tab to let user fill missing variables\n      setActiveTab('variables');\n    }\n  };\n\n  // Generate contract number\n  const generateContractNumber = () => {\n    const now = new Date();\n    const year = now.getFullYear();\n    const month = (now.getMonth() + 1).toString().padStart(2, '0');\n    const random = Math.floor(Math.random() * 10000).toString().padStart(4, '0');\n    return `HD${year}${month}${random}`;\n  };\n\n  // Calculate contract end date\n  const calculateEndDate = (startDate, months = 12) => {\n    const start = new Date(startDate);\n    const end = new Date(start);\n    end.setMonth(end.getMonth() + months);\n    return end.toISOString().split('T')[0];\n  };\n\n  // Handle form submission\n  const handleSubmit = async e => {\n    e.preventDefault();\n    try {\n      setLoading(true);\n\n      // Generate contract number if not provided\n      if (!formData.variables.contract_number) {\n        formData.variables.contract_number = generateContractNumber();\n      }\n\n      // Create contract\n      const response = await contractService.createContract(formData);\n      showSuccess('Tạo hợp đồng thành công');\n      onSuccess === null || onSuccess === void 0 ? void 0 : onSuccess(response.data);\n      onHide();\n      resetForm();\n    } catch (error) {\n      showError('Lỗi tạo hợp đồng: ' + error.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Reset form\n  const resetForm = () => {\n    setFormData({\n      contract_title: '',\n      customer_id: '',\n      customer_company_id: '',\n      template_id: '',\n      project_id: '',\n      zone_id: '',\n      party_a_name: 'CÔNG TY KHO MVG',\n      party_a_address: 'Khu công nghiệp ABC, Bình Dương',\n      party_a_representative: 'Nguyễn Văn A',\n      party_a_position: 'Giám đốc',\n      party_a_id_number: '123456789',\n      warehouse_location: '',\n      warehouse_area: 0,\n      rental_price: 0,\n      deposit_amount: 0,\n      service_fee: 0,\n      start_date: '',\n      end_date: '',\n      auto_renewal: false,\n      renewal_period: 12,\n      payment_cycle: 'monthly',\n      payment_due_date: 5,\n      payment_method: 'Chuyển khoản',\n      late_fee_percentage: 2.0,\n      special_terms: '',\n      notes: '',\n      assigned_to: (user === null || user === void 0 ? void 0 : user.id) || '',\n      variables: {}\n    });\n    setSelectedCustomer(null);\n    setSelectedTemplate(null);\n    setSelectedProject(null);\n    setSelectedZone(null);\n    setActiveTab('basic');\n  };\n\n  // Format currency for display (without currency symbol)\n  const formatCurrency = amount => {\n    return new Intl.NumberFormat('vi-VN').format(amount);\n  };\n\n  // Format currency for variables (with currency symbol)\n  const formatCurrencyForVariable = amount => {\n    return new Intl.NumberFormat('vi-VN').format(amount) + ' VNĐ';\n  };\n  return /*#__PURE__*/_jsxDEV(Modal, {\n    show: show,\n    onHide: onHide,\n    size: \"xl\",\n    scrollable: true,\n    children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n      closeButton: true,\n      children: /*#__PURE__*/_jsxDEV(Modal.Title, {\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-plus-circle me-2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 11\n        }, this), \"T\\u1EA1o h\\u1EE3p \\u0111\\u1ED3ng m\\u1EDBi\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 379,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {\n      children: [selectedCustomer && /*#__PURE__*/_jsxDEV(Alert, {\n        variant: \"info\",\n        className: \"mb-3\",\n        children: /*#__PURE__*/_jsxDEV(Row, {\n          children: [/*#__PURE__*/_jsxDEV(Col, {\n            md: 4,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Kh\\xE1ch h\\xE0ng:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 391,\n                columnNumber: 22\n              }, this), \" \", selectedCustomer.name || selectedCustomer.full_name]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 391,\n              columnNumber: 17\n            }, this), selectedCustomer.customer_code && /*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(\"small\", {\n                className: \"text-muted\",\n                children: [\"M\\xE3 KH: \", selectedCustomer.customer_code]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 393,\n                columnNumber: 24\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 393,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 390,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            md: 4,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u0110i\\u1EC7n tho\\u1EA1i:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 397,\n                columnNumber: 22\n              }, this), \" \", selectedCustomer.phone || selectedCustomer.representative_phone || '—']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 397,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Email:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 398,\n                columnNumber: 22\n              }, this), \" \", selectedCustomer.email || selectedCustomer.representative_email || '—']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 398,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 396,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            md: 4,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u0110\\u1ECBa ch\\u1EC9:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 401,\n                columnNumber: 22\n              }, this), \" \", selectedCustomer.address || '—']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 401,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 400,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 389,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 388,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Form, {\n        onSubmit: handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(Tabs, {\n          activeKey: activeTab,\n          onSelect: setActiveTab,\n          className: \"mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(Tab, {\n            eventKey: \"basic\",\n            title: \"Th\\xF4ng tin h\\u1EE3p \\u0111\\u1ED3ng\",\n            children: /*#__PURE__*/_jsxDEV(Row, {\n              children: [/*#__PURE__*/_jsxDEV(Col, {\n                md: 6,\n                children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n                  className: \"mb-3\",\n                  children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                    children: \"Ch\\u1ECDn kh\\xE1ch h\\xE0ng *\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 413,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Form.Select, {\n                    value: formData.customer_id,\n                    onChange: e => handleCustomerSelect(e.target.value),\n                    required: true,\n                    children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"\",\n                      children: \"-- Ch\\u1ECDn kh\\xE1ch h\\xE0ng --\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 419,\n                      columnNumber: 23\n                    }, this), customers.map(customer => /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: customer.id,\n                      children: [customer.name || customer.full_name || 'Khách hàng', \" \", customer.customer_code ? `(${customer.customer_code})` : '']\n                    }, customer.id, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 421,\n                      columnNumber: 25\n                    }, this))]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 414,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 412,\n                  columnNumber: 19\n                }, this), selectedCustomer && /*#__PURE__*/_jsxDEV(Alert, {\n                  variant: \"info\",\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Th\\xF4ng tin kh\\xE1ch h\\xE0ng:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 429,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 429,\n                    columnNumber: 61\n                  }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                    children: [\"S\\u0110T: \", selectedCustomer.phone, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 431,\n                      columnNumber: 54\n                    }, this), \"Email: \", selectedCustomer.email, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 432,\n                      columnNumber: 56\n                    }, this), \"\\u0110\\u1ECBa ch\\u1EC9: \", selectedCustomer.address]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 430,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 428,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n                  className: \"mb-3\",\n                  children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                    children: \"Ch\\u1ECDn d\\u1EF1 \\xE1n *\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 438,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Form.Select, {\n                    value: formData.project_id || '',\n                    onChange: e => {\n                      const projectId = e.target.value;\n                      const project = projects.find(p => p.id === parseInt(projectId));\n                      setSelectedProject(project || null);\n                      setFormData(prev => ({\n                        ...prev,\n                        project_id: projectId,\n                        zone_id: '',\n                        warehouse_location: ''\n                      }));\n                    },\n                    required: true,\n                    children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"\",\n                      children: \"-- Ch\\u1ECDn d\\u1EF1 \\xE1n --\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 449,\n                      columnNumber: 23\n                    }, this), projects.map(project => /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: project.id,\n                      children: project.name\n                    }, project.id, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 451,\n                      columnNumber: 25\n                    }, this))]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 439,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 437,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n                  className: \"mb-3\",\n                  children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                    children: \"V\\u1ECB tr\\xED kho thu\\xEA *\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 456,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Form.Select, {\n                    value: formData.zone_id || '',\n                    onChange: e => {\n                      const zoneId = e.target.value;\n                      const selectedZone = zones.find(z => z.id === parseInt(zoneId));\n                      setFormData(prev => ({\n                        ...prev,\n                        zone_id: zoneId,\n                        warehouse_location: selectedZone ? `${selectedZone.zone_name || selectedZone.zone_code} - ${(selectedProject === null || selectedProject === void 0 ? void 0 : selectedProject.name) || ''}` : '',\n                        variables: {\n                          ...prev.variables,\n                          warehouse_location: selectedZone ? `${selectedZone.zone_name || selectedZone.zone_code} - ${(selectedProject === null || selectedProject === void 0 ? void 0 : selectedProject.name) || ''}` : ''\n                        }\n                      }));\n                      setSelectedZone(selectedZone || null);\n                    },\n                    required: true,\n                    disabled: !formData.project_id,\n                    children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"\",\n                      children: \"-- Ch\\u1ECDn kho --\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 476,\n                      columnNumber: 23\n                    }, this), zones.map(zone => /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: zone.id,\n                      children: [zone.zone_name, \" (\", zone.zone_code, \")\"]\n                    }, zone.id, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 478,\n                      columnNumber: 25\n                    }, this))]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 457,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 455,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 411,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Col, {\n                md: 6,\n                children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n                  className: \"mb-3\",\n                  children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                    children: \"Ch\\u1ECDn m\\u1EABu h\\u1EE3p \\u0111\\u1ED3ng *\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 485,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Form.Select, {\n                    value: formData.template_id,\n                    onChange: e => handleTemplateSelect(e.target.value),\n                    required: true,\n                    children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"\",\n                      children: \"-- Ch\\u1ECDn m\\u1EABu h\\u1EE3p \\u0111\\u1ED3ng --\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 491,\n                      columnNumber: 23\n                    }, this), templates.map(template => /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: template.id,\n                      children: [template.template_name, template.is_default && ' (Mặc định)']\n                    }, template.id, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 493,\n                      columnNumber: 25\n                    }, this))]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 486,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 484,\n                  columnNumber: 19\n                }, this), selectedTemplate && /*#__PURE__*/_jsxDEV(Alert, {\n                  variant: \"success\",\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"M\\u1EABu \\u0111\\xE3 ch\\u1ECDn:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 502,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 502,\n                    columnNumber: 52\n                  }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                    children: [\"M\\xE3: \", selectedTemplate.template_code, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 504,\n                      columnNumber: 61\n                    }, this), \"Phi\\xEAn b\\u1EA3n: \", selectedTemplate.version, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 505,\n                      columnNumber: 62\n                    }, this), \"Lo\\u1EA1i: \", selectedTemplate.template_type]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 503,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 501,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n                  className: \"mb-3\",\n                  children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                    children: \"Ti\\xEAu \\u0111\\u1EC1 h\\u1EE3p \\u0111\\u1ED3ng *\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 511,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                    type: \"text\",\n                    value: formData.contract_title,\n                    onChange: e => setFormData(prev => ({\n                      ...prev,\n                      contract_title: e.target.value\n                    })),\n                    placeholder: \"VD: H\\u1EE3p \\u0111\\u1ED3ng thu\\xEA kho - C\\xF4ng ty ABC\",\n                    required: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 512,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 510,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    md: 6,\n                    children: /*#__PURE__*/_jsxDEV(Form.Group, {\n                      className: \"mb-3\",\n                      children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                        children: \"Di\\u1EC7n t\\xEDch (m\\xB2) *\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 524,\n                        columnNumber: 25\n                      }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                        type: \"number\",\n                        step: \"0.1\",\n                        min: \"0\",\n                        value: formData.warehouse_area,\n                        onChange: e => {\n                          const value = parseFloat(e.target.value) || 0;\n                          setFormData(prev => ({\n                            ...prev,\n                            warehouse_area: value,\n                            variables: {\n                              ...prev.variables,\n                              warehouse_area: value\n                            }\n                          }));\n                        },\n                        required: true\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 525,\n                        columnNumber: 25\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 523,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 522,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    md: 6,\n                    children: /*#__PURE__*/_jsxDEV(Form.Group, {\n                      className: \"mb-3\",\n                      children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                        children: \"Gi\\xE1 thu\\xEA/th\\xE1ng (VN\\u0110) *\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 548,\n                        columnNumber: 25\n                      }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                        type: \"text\",\n                        value: formData.rental_price ? formatCurrency(formData.rental_price) : '',\n                        onChange: e => {\n                          // Remove all non-digits\n                          const numericValue = e.target.value.replace(/\\D/g, '');\n                          const value = parseInt(numericValue) || 0;\n                          setFormData(prev => ({\n                            ...prev,\n                            rental_price: value,\n                            variables: {\n                              ...prev.variables,\n                              rental_price: formatCurrencyForVariable(value)\n                            }\n                          }));\n                        },\n                        placeholder: \"VD: 10,000,000\",\n                        required: true\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 549,\n                        columnNumber: 25\n                      }, this), formData.rental_price > 0 && formData.warehouse_area > 0 && /*#__PURE__*/_jsxDEV(Form.Text, {\n                        className: \"text-muted\",\n                        children: [\"Gi\\xE1/m\\xB2: \", formatCurrency(Math.round(formData.rental_price / formData.warehouse_area)), \" VN\\u0110/m\\xB2\"]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 569,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 547,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 546,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 521,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    md: 6,\n                    children: /*#__PURE__*/_jsxDEV(Form.Group, {\n                      className: \"mb-3\",\n                      children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                        children: \"Ti\\u1EC1n c\\u1ECDc (VN\\u0110)\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 580,\n                        columnNumber: 25\n                      }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                        type: \"text\",\n                        value: formData.deposit_amount ? formatCurrency(formData.deposit_amount) : '',\n                        onChange: e => {\n                          // Remove all non-digits\n                          const numericValue = e.target.value.replace(/\\D/g, '');\n                          const value = parseInt(numericValue) || 0;\n                          setFormData(prev => ({\n                            ...prev,\n                            deposit_amount: value,\n                            variables: {\n                              ...prev.variables,\n                              deposit_amount: formatCurrencyForVariable(value)\n                            }\n                          }));\n                        },\n                        placeholder: \"VD: 5,000,000\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 581,\n                        columnNumber: 25\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 579,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 578,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    md: 6,\n                    children: /*#__PURE__*/_jsxDEV(Form.Group, {\n                      className: \"mb-3\",\n                      children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                        children: \"Ph\\xED d\\u1ECBch v\\u1EE5 (VN\\u0110)\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 604,\n                        columnNumber: 25\n                      }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                        type: \"number\",\n                        min: \"0\",\n                        value: formData.service_fee,\n                        onChange: e => setFormData(prev => ({\n                          ...prev,\n                          service_fee: parseInt(e.target.value) || 0\n                        }))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 605,\n                        columnNumber: 25\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 603,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 602,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 577,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    md: 6,\n                    children: /*#__PURE__*/_jsxDEV(Form.Group, {\n                      className: \"mb-3\",\n                      children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                        children: \"Ng\\xE0y b\\u1EAFt \\u0111\\u1EA7u *\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 621,\n                        columnNumber: 25\n                      }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                        type: \"date\",\n                        value: formData.start_date,\n                        onChange: e => {\n                          const startDate = e.target.value;\n                          const endDate = calculateEndDate(startDate, formData.renewal_period);\n                          setFormData(prev => ({\n                            ...prev,\n                            start_date: startDate,\n                            end_date: endDate,\n                            variables: {\n                              ...prev.variables,\n                              start_date: new Date(startDate).toLocaleDateString('vi-VN'),\n                              end_date: new Date(endDate).toLocaleDateString('vi-VN')\n                            }\n                          }));\n                        },\n                        required: true\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 622,\n                        columnNumber: 25\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 620,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 619,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    md: 6,\n                    children: /*#__PURE__*/_jsxDEV(Form.Group, {\n                      className: \"mb-3\",\n                      children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                        children: \"Ng\\xE0y k\\u1EBFt th\\xFAc *\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 646,\n                        columnNumber: 25\n                      }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                        type: \"date\",\n                        value: formData.end_date,\n                        onChange: e => {\n                          const value = e.target.value;\n                          setFormData(prev => ({\n                            ...prev,\n                            end_date: value,\n                            variables: {\n                              ...prev.variables,\n                              end_date: new Date(value).toLocaleDateString('vi-VN')\n                            }\n                          }));\n                        },\n                        min: formData.start_date,\n                        required: true\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 647,\n                        columnNumber: 25\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 645,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 644,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 618,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n                  className: \"mb-3\",\n                  children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                    children: \"Chu k\\u1EF3 thanh to\\xE1n\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 669,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Form.Select, {\n                    value: formData.payment_cycle,\n                    onChange: e => setFormData(prev => ({\n                      ...prev,\n                      payment_cycle: e.target.value,\n                      variables: {\n                        ...prev.variables,\n                        payment_cycle: e.target.value === 'monthly' ? 'Hàng tháng' : e.target.value === 'quarterly' ? 'Hàng quý' : 'Hàng năm'\n                      }\n                    })),\n                    children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"monthly\",\n                      children: \"H\\xE0ng th\\xE1ng\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 682,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"quarterly\",\n                      children: \"H\\xE0ng qu\\xFD\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 683,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"yearly\",\n                      children: \"H\\xE0ng n\\u0103m\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 684,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 670,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 668,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Row, {\n                  children: [/*#__PURE__*/_jsxDEV(Col, {\n                    md: 6,\n                    children: /*#__PURE__*/_jsxDEV(Form.Group, {\n                      className: \"mb-3\",\n                      children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                        children: \"H\\u1EA1n thanh to\\xE1n (ng\\xE0y)\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 691,\n                        columnNumber: 25\n                      }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                        type: \"number\",\n                        min: \"1\",\n                        max: \"31\",\n                        value: formData.payment_due_date,\n                        onChange: e => {\n                          const value = parseInt(e.target.value) || 5;\n                          setFormData(prev => ({\n                            ...prev,\n                            payment_due_date: value,\n                            variables: {\n                              ...prev.variables,\n                              payment_due_date: value\n                            }\n                          }));\n                        }\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 692,\n                        columnNumber: 25\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 690,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 689,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Col, {\n                    md: 6,\n                    children: /*#__PURE__*/_jsxDEV(Form.Group, {\n                      className: \"mb-3\",\n                      children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                        children: \"Ph\\xED tr\\u1EC5 h\\u1EA1n (%)\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 714,\n                        columnNumber: 25\n                      }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                        type: \"number\",\n                        step: \"0.1\",\n                        min: \"0\",\n                        max: \"10\",\n                        value: formData.late_fee_percentage,\n                        onChange: e => setFormData(prev => ({\n                          ...prev,\n                          late_fee_percentage: parseFloat(e.target.value) || 2.0\n                        }))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 715,\n                        columnNumber: 25\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 713,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 712,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 688,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n                  className: \"mb-3\",\n                  children: /*#__PURE__*/_jsxDEV(Form.Check, {\n                    type: \"checkbox\",\n                    id: \"auto_renewal\",\n                    label: \"T\\u1EF1 \\u0111\\u1ED9ng gia h\\u1EA1n\",\n                    checked: formData.auto_renewal,\n                    onChange: e => setFormData(prev => ({\n                      ...prev,\n                      auto_renewal: e.target.checked\n                    }))\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 731,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 730,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n                  className: \"mb-3\",\n                  children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                    children: \"\\u0110i\\u1EC1u kho\\u1EA3n \\u0111\\u1EB7c bi\\u1EC7t\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 744,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                    as: \"textarea\",\n                    rows: 3,\n                    value: formData.special_terms,\n                    onChange: e => {\n                      const value = e.target.value;\n                      setFormData(prev => ({\n                        ...prev,\n                        special_terms: value,\n                        variables: {\n                          ...prev.variables,\n                          special_terms: value\n                        }\n                      }));\n                    },\n                    placeholder: \"C\\xE1c \\u0111i\\u1EC1u kho\\u1EA3n \\u0111\\u1EB7c bi\\u1EC7t kh\\xE1c...\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 745,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 743,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 483,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 410,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 409,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Tab, {\n            eventKey: \"variables\",\n            title: \"Bi\\u1EBFn m\\u1EABu\",\n            disabled: !selectedTemplate,\n            children: selectedTemplate && selectedTemplate.variables && /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(Alert, {\n                variant: \"info\",\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fas fa-info-circle me-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 772,\n                  columnNumber: 21\n                }, this), \"C\\xE1c bi\\u1EBFn n\\xE0y s\\u1EBD \\u0111\\u01B0\\u1EE3c thay th\\u1EBF trong n\\u1ED9i dung h\\u1EE3p \\u0111\\u1ED3ng cu\\u1ED1i c\\xF9ng.\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 771,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Row, {\n                children: (() => {\n                  let vars = [];\n                  try {\n                    vars = typeof selectedTemplate.variables === 'string' ? JSON.parse(selectedTemplate.variables) : Array.isArray(selectedTemplate.variables) ? selectedTemplate.variables : [];\n                  } catch (e) {\n                    vars = [];\n                  }\n                  return vars;\n                })().map(variable => /*#__PURE__*/_jsxDEV(Col, {\n                  md: 6,\n                  children: /*#__PURE__*/_jsxDEV(Form.Group, {\n                    className: \"mb-3\",\n                    children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                      children: [variable.description || variable.name, variable.required && /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text-danger\",\n                        children: \"*\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 782,\n                        columnNumber: 51\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 780,\n                      columnNumber: 27\n                    }, this), variable.type === 'boolean' ? /*#__PURE__*/_jsxDEV(Form.Check, {\n                      type: \"checkbox\",\n                      checked: formData.variables[variable.name] === 'true',\n                      onChange: e => setFormData(prev => ({\n                        ...prev,\n                        variables: {\n                          ...prev.variables,\n                          [variable.name]: e.target.checked.toString()\n                        }\n                      }))\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 786,\n                      columnNumber: 29\n                    }, this) : /*#__PURE__*/_jsxDEV(Form.Control, {\n                      type: variable.type === 'date' ? 'date' : variable.type === 'number' ? 'number' : 'text',\n                      value: formData.variables[variable.name] || '',\n                      onChange: e => setFormData(prev => ({\n                        ...prev,\n                        variables: {\n                          ...prev.variables,\n                          [variable.name]: e.target.value\n                        }\n                      })),\n                      required: variable.required,\n                      placeholder: `{{${variable.name}}}`\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 798,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(Form.Text, {\n                      className: \"text-muted\",\n                      children: [\"Bi\\u1EBFn: \", /*#__PURE__*/_jsxDEV(\"code\", {\n                        children: `{{${variable.name}}}`\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 815,\n                        columnNumber: 35\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 814,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 779,\n                    columnNumber: 25\n                  }, this)\n                }, variable.name, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 778,\n                  columnNumber: 23\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 776,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 770,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 768,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Tab, {\n            eventKey: \"preview\",\n            title: \"Xem tr\\u01B0\\u1EDBc\",\n            disabled: !selectedTemplate,\n            children: selectedTemplate && /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(Alert, {\n                variant: \"success\",\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fas fa-eye me-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 830,\n                  columnNumber: 21\n                }, this), \"Xem tr\\u01B0\\u1EDBc n\\u1ED9i dung h\\u1EE3p \\u0111\\u1ED3ng v\\u1EDBi d\\u1EEF li\\u1EC7u \\u0111\\xE3 nh\\u1EADp\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 829,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Card, {\n                children: /*#__PURE__*/_jsxDEV(Card.Body, {\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"contract-preview\",\n                    dangerouslySetInnerHTML: {\n                      __html: String((selectedTemplate === null || selectedTemplate === void 0 ? void 0 : selectedTemplate.template_content) || '').replace(/\\{\\{(\\w+)\\}\\}/g, (match, varName) => formData.variables[varName] || `[${varName}]`)\n                    },\n                    style: {\n                      border: '1px solid #ddd',\n                      padding: '20px',\n                      backgroundColor: 'white',\n                      fontFamily: 'Times New Roman, serif'\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 836,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 835,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 834,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 828,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 826,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 407,\n          columnNumber: 11\n        }, this), formData.customer_id && formData.template_id && /*#__PURE__*/_jsxDEV(Alert, {\n          variant: \"light\",\n          children: /*#__PURE__*/_jsxDEV(Row, {\n            children: [/*#__PURE__*/_jsxDEV(Col, {\n              md: 3,\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Kh\\xE1ch h\\xE0ng:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 863,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 863,\n                columnNumber: 47\n              }, this), (selectedCustomer === null || selectedCustomer === void 0 ? void 0 : selectedCustomer.name) || (selectedCustomer === null || selectedCustomer === void 0 ? void 0 : selectedCustomer.full_name)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 862,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              md: 3,\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"M\\u1EABu h\\u1EE3p \\u0111\\u1ED3ng:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 867,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 867,\n                columnNumber: 49\n              }, this), selectedTemplate === null || selectedTemplate === void 0 ? void 0 : selectedTemplate.template_name]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 866,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              md: 3,\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Di\\u1EC7n t\\xEDch:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 871,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 871,\n                columnNumber: 46\n              }, this), formData.warehouse_area, \" m\\xB2\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 870,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              md: 3,\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Gi\\xE1 thu\\xEA:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 875,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 875,\n                columnNumber: 45\n              }, this), formatCurrency(formData.rental_price), \" VN\\u0110/th\\xE1ng\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 874,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 861,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 860,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 406,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 386,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal.Footer, {\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        variant: \"secondary\",\n        onClick: onHide,\n        disabled: loading,\n        children: \"H\\u1EE7y\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 885,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"primary\",\n        onClick: handleSubmit,\n        disabled: loading || !formData.customer_id || !formData.template_id,\n        children: loading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"spinner-border spinner-border-sm me-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 896,\n            columnNumber: 15\n          }, this), \"\\u0110ang t\\u1EA1o...\"]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fas fa-save me-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 901,\n            columnNumber: 15\n          }, this), \"T\\u1EA1o h\\u1EE3p \\u0111\\u1ED3ng\"]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 889,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 884,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 378,\n    columnNumber: 5\n  }, this);\n};\n_s(ContractCreator, \"pAz/slauAwo/42w/Ji28kvel/mA=\", false, function () {\n  return [useAuth, useNotification];\n});\n_c = ContractCreator;\nexport default ContractCreator;\nvar _c;\n$RefreshReg$(_c, \"ContractCreator\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","Modal","Form","Row","Col","Button","Alert","Tabs","Tab","Card","useAuth","useNotification","contractService","customerService","projectService","jsxDEV","_jsxDEV","Fragment","_Fragment","ContractCreator","show","onHide","onSuccess","initialCustomerId","_s","user","showSuccess","showError","loading","setLoading","activeTab","setActiveTab","customers","setCustomers","customersLoaded","setCustomersLoaded","templates","setTemplates","projects","setProjects","zones","setZones","selectedCustomer","setSelectedCustomer","selectedTemplate","setSelectedTemplate","selectedProject","setSelectedProject","selectedZone","setSelectedZone","templatesLoaded","setTemplatesLoaded","projectsLoaded","setProjectsLoaded","formData","setFormData","contract_title","customer_id","customer_company_id","template_id","project_id","zone_id","party_a_name","party_a_address","party_a_representative","party_a_position","party_a_id_number","warehouse_location","warehouse_area","rental_price","deposit_amount","service_fee","start_date","end_date","auto_renewal","renewal_period","payment_cycle","payment_due_date","payment_method","late_fee_percentage","special_terms","notes","assigned_to","id","variables","loadInitialData","_customersResponse$da","_templatesResponse$da","_projectsResponse$dat","_projectsResponse$dat2","customersResponse","templatesResponse","projectsResponse","Promise","all","getCustomers","limit","getContractTemplates","is_active","getProjects","data","loadedTemplates","Array","isArray","defaultTpl","find","t","is_default","prev","String","loadedProjects","error","console","message","params","URLSearchParams","window","location","search","fromUrl","get","handleCustomerSelect","e","ensureAndSelectInitialCustomer","exists","some","c","_customerResponse$dat","customerResponse","getCustomer","customerData","customer","already","warn","fetchZones","zonesResponse","getZones","customerId","_customerResponse$dat2","parseInt","name","full_name","warehouse_purpose","party_b_name","party_b_address","address","party_b_representative","representative_name","party_b_position","party_b_tax_code","tax_code","handleTemplateSelect","templateId","template","templateVars","JSON","parse","newVariables","forEach","variable","toLocaleString","generateContractNumber","now","Date","year","getFullYear","month","getMonth","toString","padStart","random","Math","floor","calculateEndDate","startDate","months","start","end","setMonth","toISOString","split","handleSubmit","preventDefault","contract_number","response","createContract","resetForm","formatCurrency","amount","Intl","NumberFormat","format","formatCurrencyForVariable","size","scrollable","children","Header","closeButton","Title","className","fileName","_jsxFileName","lineNumber","columnNumber","Body","variant","md","customer_code","phone","representative_phone","email","representative_email","onSubmit","activeKey","onSelect","eventKey","title","Group","Label","Select","value","onChange","target","required","map","projectId","project","p","zoneId","z","zone_name","zone_code","disabled","zone","template_name","template_code","version","template_type","Control","type","placeholder","step","min","parseFloat","numericValue","replace","Text","round","endDate","toLocaleDateString","max","Check","label","checked","as","rows","vars","description","dangerouslySetInnerHTML","__html","template_content","match","varName","style","border","padding","backgroundColor","fontFamily","Footer","onClick","_c","$RefreshReg$"],"sources":["C:/Users/Admin/Documents/GitHub/MVG_InventoryManagement/KinhDoanh/client/src/components/Contracts/ContractCreator.js"],"sourcesContent":["/**\r\n * Contract Creator - Tạo hợp đồng từ mẫu với dữ liệu khách hàng\r\n */\r\n\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport { \r\n  Modal, Form, Row, Col, Button, Alert, Tabs, Tab,\r\n  Card \r\n} from 'react-bootstrap';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { useNotification } from '../../contexts/NotificationContext';\r\nimport contractService from '../../services/contractService';\r\nimport customerService from '../../services/customerService';\r\nimport projectService from '../../services/projectService';\r\n\r\nconst ContractCreator = ({ show, onHide, onSuccess, initialCustomerId = '' }) => {\r\n  const { user } = useAuth();\r\n  const { showSuccess, showError } = useNotification();\r\n  \r\n  const [loading, setLoading] = useState(false);\r\n  const [activeTab, setActiveTab] = useState('basic');\r\n  \r\n  // Data states\r\n  const [customers, setCustomers] = useState([]);\r\n  const [customersLoaded, setCustomersLoaded] = useState(false);\r\n  const [templates, setTemplates] = useState([]);\r\n  const [projects, setProjects] = useState([]);\r\n  const [zones, setZones] = useState([]);\r\n  const [selectedCustomer, setSelectedCustomer] = useState(null);\r\n  const [selectedTemplate, setSelectedTemplate] = useState(null);\r\n  const [selectedProject, setSelectedProject] = useState(null);\r\n  const [selectedZone, setSelectedZone] = useState(null);\r\n  const [templatesLoaded, setTemplatesLoaded] = useState(false);\r\n  const [projectsLoaded, setProjectsLoaded] = useState(false);\r\n  \r\n  \r\n  // Form data\r\n  const [formData, setFormData] = useState({\r\n    // Basic contract info\r\n    contract_title: '',\r\n    customer_id: '',\r\n    customer_company_id: '',\r\n    template_id: '',\r\n    project_id: '',\r\n    zone_id: '',\r\n    \r\n    // Party A (Lessor) - Bên cho thuê\r\n    party_a_name: 'CÔNG TY KHO MVG',\r\n    party_a_address: 'Khu công nghiệp ABC, Bình Dương',\r\n    party_a_representative: 'Nguyễn Văn A',\r\n    party_a_position: 'Giám đốc',\r\n    party_a_id_number: '123456789',\r\n    \r\n    // Contract terms\r\n    warehouse_location: '',\r\n    warehouse_area: 0,\r\n    rental_price: 0,\r\n    deposit_amount: 0,\r\n    service_fee: 0,\r\n    \r\n    // Dates\r\n    start_date: '',\r\n    end_date: '',\r\n    auto_renewal: false,\r\n    renewal_period: 12,\r\n    \r\n    // Payment\r\n    payment_cycle: 'monthly',\r\n    payment_due_date: 5,\r\n    payment_method: 'Chuyển khoản',\r\n    late_fee_percentage: 2.0,\r\n    \r\n    // Additional terms\r\n    special_terms: '',\r\n    notes: '',\r\n    assigned_to: user?.id || '',\r\n    \r\n    // Template variables\r\n    variables: {}\r\n  });\r\n\r\n  const loadInitialData = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      const [customersResponse, templatesResponse, projectsResponse] = await Promise.all([\r\n        customerService.getCustomers({ limit: 100 }),\r\n        contractService.getContractTemplates({ is_active: true }),\r\n        projectService.getProjects({ limit: 100 })\r\n      ]);\r\n      // Customers: API shape { success, data: { customers: [...] } }\r\n      setCustomers(customersResponse?.data?.customers || customersResponse?.customers || []);\r\n      setCustomersLoaded(true);\r\n      // Templates: API shape can be: { success, data: [...] } or { success, data: { templates: [...] } } or { templates: [...] }\r\n      const loadedTemplates = \r\n        templatesResponse?.data?.templates || \r\n        templatesResponse?.data || \r\n        templatesResponse?.templates || \r\n        templatesResponse || [];\r\n      setTemplates(Array.isArray(loadedTemplates) ? loadedTemplates : []);\r\n      setTemplatesLoaded(true);\r\n      // Auto-select default template if available\r\n      const defaultTpl = Array.isArray(loadedTemplates) && loadedTemplates.find(t => t.is_default);\r\n      if (defaultTpl) {\r\n        setSelectedTemplate(defaultTpl);\r\n        setFormData(prev => ({ ...prev, template_id: String(defaultTpl.id) }));\r\n      }\r\n      // Projects: shape could be { success, data: { projects: [...] } } or { success, projects: [...] }\r\n      const loadedProjects = \r\n        projectsResponse?.data?.projects || \r\n        projectsResponse?.projects || \r\n        projectsResponse?.data || [];\r\n      setProjects(Array.isArray(loadedProjects) ? loadedProjects : (Array.isArray(projectsResponse?.data?.projects) ? projectsResponse.data.projects : []));\r\n      setProjectsLoaded(true);\r\n    } catch (error) {\r\n      console.error('Error loading initial data:', error);\r\n      showError('Không thể tải dữ liệu: ' + error.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [showError]);\r\n\r\n  // Load initial data\r\n  useEffect(() => {\r\n    if (show) {\r\n      loadInitialData();\r\n    }\r\n  }, [show, loadInitialData]);\r\n\r\n  // Read customer id from URL if not provided via props\r\n  useEffect(() => {\r\n    if (!show) return;\r\n    if (initialCustomerId) return;\r\n    try {\r\n      const params = new URLSearchParams(window.location.search);\r\n      const fromUrl = params.get('customer') || params.get('customer_id');\r\n      if (fromUrl) {\r\n        handleCustomerSelect(fromUrl);\r\n      }\r\n    } catch (e) {\r\n      // no-op\r\n    }\r\n  }, [show, initialCustomerId]);\r\n\r\n  // If initialCustomerId is provided, preselect it after data loads\r\n  useEffect(() => {\r\n    async function ensureAndSelectInitialCustomer() {\r\n      if (!show || !initialCustomerId) return;\r\n      // If list already contains the customer, select it\r\n      const exists = customers.some(c => String(c.id) === String(initialCustomerId));\r\n      if (exists) {\r\n        handleCustomerSelect(initialCustomerId);\r\n        return;\r\n      }\r\n      // Otherwise fetch it and add to list\r\n      try {\r\n        const customerResponse = await customerService.getCustomer(initialCustomerId);\r\n        const customerData = customerResponse?.data?.customer || customerResponse?.data || customerResponse;\r\n        if (customerData && customerData.id) {\r\n          setCustomers(prev => {\r\n            const already = prev.some(c => String(c.id) === String(customerData.id));\r\n            return already ? prev : [customerData, ...prev];\r\n          });\r\n          handleCustomerSelect(customerData.id);\r\n        }\r\n      } catch (e) {\r\n        console.warn('Could not preload initial customer', e?.message || e);\r\n      }\r\n    }\r\n    ensureAndSelectInitialCustomer();\r\n  }, [show, initialCustomerId, customers, customersLoaded]);\r\n\r\n  // Load zones when project changes\r\n  useEffect(() => {\r\n    async function fetchZones() {\r\n      if (formData.project_id) {\r\n        const zonesResponse = await projectService.getZones(formData.project_id);\r\n        setZones(zonesResponse.zones || []);\r\n      } else {\r\n        setZones([]);\r\n      }\r\n    }\r\n    fetchZones();\r\n  }, [formData.project_id]);\r\n\r\n  // Handle customer selection\r\n  const handleCustomerSelect = async (customerId) => {\r\n    try {\r\n      const customer = customers.find(c => c.id === parseInt(customerId));\r\n      if (!customer) return;\r\n      \r\n      setSelectedCustomer(customer);\r\n      \r\n      // Load customer details\r\n      const customerResponse = await customerService.getCustomer(customerId);\r\n      const customerData = customerResponse?.data?.customer || customerResponse?.data || customerResponse;\r\n      \r\n      // Auto-fill contract data based on available fields from API\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        customer_id: customerId,\r\n        contract_title: `Hợp đồng thuê kho - ${customerData.name || customerData.full_name || 'Khách hàng'}`,\r\n        warehouse_purpose: customerData.warehouse_purpose || 'Lưu kho hàng hóa',\r\n        variables: {\r\n          ...prev.variables,\r\n          // Auto-fill Party B info\r\n          party_b_name: customerData.name || customerData.full_name,\r\n          party_b_address: customerData.address || '',\r\n          party_b_representative: customerData.representative_name || customerData.full_name || '',\r\n          party_b_position: 'Giám đốc',\r\n          party_b_tax_code: customerData.tax_code || '',\r\n          warehouse_purpose: customerData.warehouse_purpose || 'Lưu kho hàng hóa',\r\n          payment_cycle: prev.payment_cycle === 'monthly' ? 'Hàng tháng' :\r\n                        prev.payment_cycle === 'quarterly' ? 'Hàng quý' : 'Hàng năm',\r\n          payment_due_date: prev.payment_due_date\r\n        }\r\n      }));\r\n      \r\n    } catch (error) {\r\n      showError('Không thể tải thông tin khách hàng: ' + error.message);\r\n    }\r\n  };\r\n\r\n  // Handle template selection\r\n  const handleTemplateSelect = (templateId) => {\r\n    if (!templateId) {\r\n      setSelectedTemplate(null);\r\n      setFormData(prev => ({ ...prev, template_id: '' }));\r\n      return;\r\n    }\r\n    const template = templates.find(t => t.id === parseInt(templateId));\r\n    if (!template) return;\r\n    \r\n    setSelectedTemplate(template);\r\n    setFormData(prev => ({ ...prev, template_id: templateId }));\r\n    \r\n    // Parse template variables\r\n    if (template.variables) {\r\n      let templateVars = [];\r\n      try {\r\n        templateVars = typeof template.variables === 'string' \r\n          ? JSON.parse(template.variables) \r\n          : (Array.isArray(template.variables) ? template.variables : []);\r\n      } catch (e) {\r\n        console.warn('Invalid template variables JSON:', e?.message || e);\r\n        templateVars = [];\r\n      }\r\n      \r\n      // Initialize variables with current form data\r\n      const newVariables = { ...formData.variables };\r\n      templateVars.forEach(variable => {\r\n        if (!newVariables[variable.name]) {\r\n          // Auto-populate common variables\r\n          switch (variable.name) {\r\n            case 'party_a_name':\r\n              newVariables[variable.name] = formData.party_a_name;\r\n              break;\r\n            case 'party_a_representative':\r\n              newVariables[variable.name] = formData.party_a_representative;\r\n              break;\r\n            case 'start_date':\r\n              newVariables[variable.name] = formData.start_date;\r\n              break;\r\n            case 'end_date':\r\n              newVariables[variable.name] = formData.end_date;\r\n              break;\r\n            case 'warehouse_location':\r\n              newVariables[variable.name] = formData.warehouse_location;\r\n              break;\r\n            case 'rental_price':\r\n              newVariables[variable.name] = formData.rental_price.toLocaleString('vi-VN') + ' VNĐ';\r\n              break;\r\n            default:\r\n              newVariables[variable.name] = '';\r\n          }\r\n        }\r\n      });\r\n      \r\n      setFormData(prev => ({ ...prev, variables: newVariables }));\r\n      // Move to variables tab to let user fill missing variables\r\n      setActiveTab('variables');\r\n    }\r\n  };\r\n\r\n  // Generate contract number\r\n  const generateContractNumber = () => {\r\n    const now = new Date();\r\n    const year = now.getFullYear();\r\n    const month = (now.getMonth() + 1).toString().padStart(2, '0');\r\n    const random = Math.floor(Math.random() * 10000).toString().padStart(4, '0');\r\n    return `HD${year}${month}${random}`;\r\n  };\r\n\r\n  // Calculate contract end date\r\n  const calculateEndDate = (startDate, months = 12) => {\r\n    const start = new Date(startDate);\r\n    const end = new Date(start);\r\n    end.setMonth(end.getMonth() + months);\r\n    return end.toISOString().split('T')[0];\r\n  };\r\n\r\n  // Handle form submission\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    try {\r\n      setLoading(true);\r\n      \r\n      // Generate contract number if not provided\r\n      if (!formData.variables.contract_number) {\r\n        formData.variables.contract_number = generateContractNumber();\r\n      }\r\n      \r\n      // Create contract\r\n      const response = await contractService.createContract(formData);\r\n      \r\n      showSuccess('Tạo hợp đồng thành công');\r\n      onSuccess?.(response.data);\r\n      onHide();\r\n      resetForm();\r\n      \r\n    } catch (error) {\r\n      showError('Lỗi tạo hợp đồng: ' + error.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Reset form\r\n  const resetForm = () => {\r\n    setFormData({\r\n      contract_title: '',\r\n      customer_id: '',\r\n      customer_company_id: '',\r\n      template_id: '',\r\n      project_id: '',\r\n      zone_id: '',\r\n      party_a_name: 'CÔNG TY KHO MVG',\r\n      party_a_address: 'Khu công nghiệp ABC, Bình Dương',\r\n      party_a_representative: 'Nguyễn Văn A',\r\n      party_a_position: 'Giám đốc',\r\n      party_a_id_number: '123456789',\r\n      warehouse_location: '',\r\n      warehouse_area: 0,\r\n      rental_price: 0,\r\n      deposit_amount: 0,\r\n      service_fee: 0,\r\n      start_date: '',\r\n      end_date: '',\r\n      auto_renewal: false,\r\n      renewal_period: 12,\r\n      payment_cycle: 'monthly',\r\n      payment_due_date: 5,\r\n      payment_method: 'Chuyển khoản',\r\n      late_fee_percentage: 2.0,\r\n      special_terms: '',\r\n      notes: '',\r\n      assigned_to: user?.id || '',\r\n      variables: {}\r\n    });\r\n    setSelectedCustomer(null);\r\n    setSelectedTemplate(null);\r\n    setSelectedProject(null);\r\n    setSelectedZone(null);\r\n    setActiveTab('basic');\r\n  };\r\n\r\n  // Format currency for display (without currency symbol)\r\n  const formatCurrency = (amount) => {\r\n    return new Intl.NumberFormat('vi-VN').format(amount);\r\n  };\r\n\r\n  // Format currency for variables (with currency symbol)\r\n  const formatCurrencyForVariable = (amount) => {\r\n    return new Intl.NumberFormat('vi-VN').format(amount) + ' VNĐ';\r\n  };\r\n\r\n  return (\r\n    <Modal show={show} onHide={onHide} size=\"xl\" scrollable>\r\n      <Modal.Header closeButton>\r\n        <Modal.Title>\r\n          <i className=\"fas fa-plus-circle me-2\"></i>\r\n          Tạo hợp đồng mới\r\n        </Modal.Title>\r\n      </Modal.Header>\r\n      \r\n      <Modal.Body>\r\n        {selectedCustomer && (\r\n          <Alert variant=\"info\" className=\"mb-3\">\r\n            <Row>\r\n              <Col md={4}>\r\n                <div><strong>Khách hàng:</strong> {selectedCustomer.name || selectedCustomer.full_name}</div>\r\n                {selectedCustomer.customer_code && (\r\n                  <div><small className=\"text-muted\">Mã KH: {selectedCustomer.customer_code}</small></div>\r\n                )}\r\n              </Col>\r\n              <Col md={4}>\r\n                <div><strong>Điện thoại:</strong> {selectedCustomer.phone || selectedCustomer.representative_phone || '—'}</div>\r\n                <div><strong>Email:</strong> {selectedCustomer.email || selectedCustomer.representative_email || '—'}</div>\r\n              </Col>\r\n              <Col md={4}>\r\n                <div><strong>Địa chỉ:</strong> {selectedCustomer.address || '—'}</div>\r\n              </Col>\r\n            </Row>\r\n          </Alert>\r\n        )}\r\n        <Form onSubmit={handleSubmit}>\r\n          <Tabs activeKey={activeTab} onSelect={setActiveTab} className=\"mb-3\">\r\n            {/* Tab 1: Thông tin hợp đồng (gộp cơ bản + điều khoản) */}\r\n            <Tab eventKey=\"basic\" title=\"Thông tin hợp đồng\">\r\n              <Row>\r\n                <Col md={6}>\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Label>Chọn khách hàng *</Form.Label>\r\n                    <Form.Select\r\n                      value={formData.customer_id}\r\n                      onChange={e => handleCustomerSelect(e.target.value)}\r\n                      required\r\n                    >\r\n                      <option value=\"\">-- Chọn khách hàng --</option>\r\n                      {customers.map(customer => (\r\n                        <option key={customer.id} value={customer.id}>\r\n                          {(customer.name || customer.full_name || 'Khách hàng')} {customer.customer_code ? `(${customer.customer_code})` : ''}\r\n                        </option>\r\n                      ))}\r\n                    </Form.Select>\r\n                  </Form.Group>\r\n                  {selectedCustomer && (\r\n                    <Alert variant=\"info\">\r\n                      <strong>Thông tin khách hàng:</strong><br/>\r\n                      <small>\r\n                        SĐT: {selectedCustomer.phone}<br/>\r\n                        Email: {selectedCustomer.email}<br/>\r\n                        Địa chỉ: {selectedCustomer.address}\r\n                      </small>\r\n                    </Alert>\r\n                  )}\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Label>Chọn dự án *</Form.Label>\r\n                    <Form.Select\r\n                      value={formData.project_id || ''}\r\n                      onChange={e => {\r\n                        const projectId = e.target.value;\r\n                        const project = projects.find(p => p.id === parseInt(projectId));\r\n                        setSelectedProject(project || null);\r\n                        setFormData(prev => ({ ...prev, project_id: projectId, zone_id: '', warehouse_location: '' }));\r\n                      }}\r\n                      required\r\n                    >\r\n                      <option value=\"\">-- Chọn dự án --</option>\r\n                      {projects.map(project => (\r\n                        <option key={project.id} value={project.id}>{project.name}</option>\r\n                      ))}\r\n                    </Form.Select>\r\n                  </Form.Group>\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Label>Vị trí kho thuê *</Form.Label>\r\n                    <Form.Select\r\n                      value={formData.zone_id || ''}\r\n                      onChange={e => {\r\n                        const zoneId = e.target.value;\r\n                        const selectedZone = zones.find(z => z.id === parseInt(zoneId));\r\n                        setFormData(prev => ({\r\n                          ...prev,\r\n                          zone_id: zoneId,\r\n                          warehouse_location: selectedZone ? `${selectedZone.zone_name || selectedZone.zone_code} - ${selectedProject?.name || ''}` : '',\r\n                          variables: {\r\n                            ...prev.variables,\r\n                            warehouse_location: selectedZone ? `${selectedZone.zone_name || selectedZone.zone_code} - ${selectedProject?.name || ''}` : ''\r\n                          }\r\n                        }));\r\n                        setSelectedZone(selectedZone || null);\r\n                      }}\r\n                      required\r\n                      disabled={!formData.project_id}\r\n                    >\r\n                      <option value=\"\">-- Chọn kho --</option>\r\n                      {zones.map(zone => (\r\n                        <option key={zone.id} value={zone.id}>{zone.zone_name} ({zone.zone_code})</option>\r\n                      ))}\r\n                    </Form.Select>\r\n                  </Form.Group>\r\n                </Col>\r\n                <Col md={6}>\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Label>Chọn mẫu hợp đồng *</Form.Label>\r\n                    <Form.Select\r\n                      value={formData.template_id}\r\n                      onChange={e => handleTemplateSelect(e.target.value)}\r\n                      required\r\n                    >\r\n                      <option value=\"\">-- Chọn mẫu hợp đồng --</option>\r\n                      {templates.map(template => (\r\n                        <option key={template.id} value={template.id}>\r\n                          {template.template_name}\r\n                          {template.is_default && ' (Mặc định)'}\r\n                        </option>\r\n                      ))}\r\n                    </Form.Select>\r\n                  </Form.Group>\r\n                  {selectedTemplate && (\r\n                    <Alert variant=\"success\">\r\n                      <strong>Mẫu đã chọn:</strong><br/>\r\n                      <small>\r\n                        Mã: {selectedTemplate.template_code}<br/>\r\n                        Phiên bản: {selectedTemplate.version}<br/>\r\n                        Loại: {selectedTemplate.template_type}\r\n                      </small>\r\n                    </Alert>\r\n                  )}\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Label>Tiêu đề hợp đồng *</Form.Label>\r\n                    <Form.Control\r\n                      type=\"text\"\r\n                      value={formData.contract_title}\r\n                      onChange={e => setFormData(prev => ({ ...prev, contract_title: e.target.value }))}\r\n                      placeholder=\"VD: Hợp đồng thuê kho - Công ty ABC\"\r\n                      required\r\n                    />\r\n                  </Form.Group>\r\n\r\n                  <Row>\r\n                    <Col md={6}>\r\n                      <Form.Group className=\"mb-3\">\r\n                        <Form.Label>Diện tích (m²) *</Form.Label>\r\n                        <Form.Control\r\n                          type=\"number\"\r\n                          step=\"0.1\"\r\n                          min=\"0\"\r\n                          value={formData.warehouse_area}\r\n                          onChange={(e) => {\r\n                            const value = parseFloat(e.target.value) || 0;\r\n                            setFormData(prev => ({\r\n                              ...prev,\r\n                              warehouse_area: value,\r\n                              variables: {\r\n                                ...prev.variables,\r\n                                warehouse_area: value\r\n                              }\r\n                            }));\r\n                          }}\r\n                          required\r\n                        />\r\n                      </Form.Group>\r\n                    </Col>\r\n                    \r\n                    <Col md={6}>\r\n                      <Form.Group className=\"mb-3\">\r\n                        <Form.Label>Giá thuê/tháng (VNĐ) *</Form.Label>\r\n                        <Form.Control\r\n                          type=\"text\"\r\n                          value={formData.rental_price ? formatCurrency(formData.rental_price) : ''}\r\n                          onChange={(e) => {\r\n                            // Remove all non-digits\r\n                            const numericValue = e.target.value.replace(/\\D/g, '');\r\n                            const value = parseInt(numericValue) || 0;\r\n                            setFormData(prev => ({\r\n                              ...prev,\r\n                              rental_price: value,\r\n                              variables: {\r\n                                ...prev.variables,\r\n                                rental_price: formatCurrencyForVariable(value)\r\n                              }\r\n                            }));\r\n                          }}\r\n                          placeholder=\"VD: 10,000,000\"\r\n                          required\r\n                        />\r\n                        {formData.rental_price > 0 && formData.warehouse_area > 0 && (\r\n                          <Form.Text className=\"text-muted\">\r\n                            Giá/m²: {formatCurrency(Math.round(formData.rental_price / formData.warehouse_area))} VNĐ/m²\r\n                          </Form.Text>\r\n                        )}\r\n                      </Form.Group>\r\n                    </Col>\r\n                  </Row>\r\n\r\n                  <Row>\r\n                    <Col md={6}>\r\n                      <Form.Group className=\"mb-3\">\r\n                        <Form.Label>Tiền cọc (VNĐ)</Form.Label>\r\n                        <Form.Control\r\n                          type=\"text\"\r\n                          value={formData.deposit_amount ? formatCurrency(formData.deposit_amount) : ''}\r\n                          onChange={(e) => {\r\n                            // Remove all non-digits\r\n                            const numericValue = e.target.value.replace(/\\D/g, '');\r\n                            const value = parseInt(numericValue) || 0;\r\n                            setFormData(prev => ({\r\n                              ...prev,\r\n                              deposit_amount: value,\r\n                              variables: {\r\n                                ...prev.variables,\r\n                                deposit_amount: formatCurrencyForVariable(value)\r\n                              }\r\n                            }));\r\n                          }}\r\n                          placeholder=\"VD: 5,000,000\"\r\n                        />\r\n                      </Form.Group>\r\n                    </Col>\r\n                    \r\n                    <Col md={6}>\r\n                      <Form.Group className=\"mb-3\">\r\n                        <Form.Label>Phí dịch vụ (VNĐ)</Form.Label>\r\n                        <Form.Control\r\n                          type=\"number\"\r\n                          min=\"0\"\r\n                          value={formData.service_fee}\r\n                          onChange={(e) => setFormData(prev => ({\r\n                            ...prev,\r\n                            service_fee: parseInt(e.target.value) || 0\r\n                          }))}\r\n                        />\r\n                      </Form.Group>\r\n                    </Col>\r\n                  </Row>\r\n\r\n                  <Row>\r\n                    <Col md={6}>\r\n                      <Form.Group className=\"mb-3\">\r\n                        <Form.Label>Ngày bắt đầu *</Form.Label>\r\n                        <Form.Control\r\n                          type=\"date\"\r\n                          value={formData.start_date}\r\n                          onChange={(e) => {\r\n                            const startDate = e.target.value;\r\n                            const endDate = calculateEndDate(startDate, formData.renewal_period);\r\n                            setFormData(prev => ({\r\n                              ...prev,\r\n                              start_date: startDate,\r\n                              end_date: endDate,\r\n                              variables: {\r\n                                ...prev.variables,\r\n                                start_date: new Date(startDate).toLocaleDateString('vi-VN'),\r\n                                end_date: new Date(endDate).toLocaleDateString('vi-VN')\r\n                              }\r\n                            }));\r\n                          }}\r\n                          required\r\n                        />\r\n                      </Form.Group>\r\n                    </Col>\r\n                    \r\n                    <Col md={6}>\r\n                      <Form.Group className=\"mb-3\">\r\n                        <Form.Label>Ngày kết thúc *</Form.Label>\r\n                        <Form.Control\r\n                          type=\"date\"\r\n                          value={formData.end_date}\r\n                          onChange={(e) => {\r\n                            const value = e.target.value;\r\n                            setFormData(prev => ({\r\n                              ...prev,\r\n                              end_date: value,\r\n                              variables: {\r\n                                ...prev.variables,\r\n                                end_date: new Date(value).toLocaleDateString('vi-VN')\r\n                              }\r\n                            }));\r\n                          }}\r\n                          min={formData.start_date}\r\n                          required\r\n                        />\r\n                      </Form.Group>\r\n                    </Col>\r\n                  </Row>\r\n\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Label>Chu kỳ thanh toán</Form.Label>\r\n                    <Form.Select\r\n                      value={formData.payment_cycle}\r\n                      onChange={(e) => setFormData(prev => ({\r\n                        ...prev,\r\n                        payment_cycle: e.target.value,\r\n                        variables: {\r\n                          ...prev.variables,\r\n                          payment_cycle: e.target.value === 'monthly' ? 'Hàng tháng' :\r\n                                        e.target.value === 'quarterly' ? 'Hàng quý' : 'Hàng năm'\r\n                        }\r\n                      }))}\r\n                    >\r\n                      <option value=\"monthly\">Hàng tháng</option>\r\n                      <option value=\"quarterly\">Hàng quý</option>\r\n                      <option value=\"yearly\">Hàng năm</option>\r\n                    </Form.Select>\r\n                  </Form.Group>\r\n\r\n                  <Row>\r\n                    <Col md={6}>\r\n                      <Form.Group className=\"mb-3\">\r\n                        <Form.Label>Hạn thanh toán (ngày)</Form.Label>\r\n                        <Form.Control\r\n                          type=\"number\"\r\n                          min=\"1\"\r\n                          max=\"31\"\r\n                          value={formData.payment_due_date}\r\n                          onChange={(e) => {\r\n                            const value = parseInt(e.target.value) || 5;\r\n                            setFormData(prev => ({\r\n                              ...prev,\r\n                              payment_due_date: value,\r\n                              variables: {\r\n                                ...prev.variables,\r\n                                payment_due_date: value\r\n                              }\r\n                            }));\r\n                          }}\r\n                        />\r\n                      </Form.Group>\r\n                    </Col>\r\n                    \r\n                    <Col md={6}>\r\n                      <Form.Group className=\"mb-3\">\r\n                        <Form.Label>Phí trễ hạn (%)</Form.Label>\r\n                        <Form.Control\r\n                          type=\"number\"\r\n                          step=\"0.1\"\r\n                          min=\"0\"\r\n                          max=\"10\"\r\n                          value={formData.late_fee_percentage}\r\n                          onChange={(e) => setFormData(prev => ({\r\n                            ...prev,\r\n                            late_fee_percentage: parseFloat(e.target.value) || 2.0\r\n                          }))}\r\n                        />\r\n                      </Form.Group>\r\n                    </Col>\r\n                  </Row>\r\n\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Check\r\n                      type=\"checkbox\"\r\n                      id=\"auto_renewal\"\r\n                      label=\"Tự động gia hạn\"\r\n                      checked={formData.auto_renewal}\r\n                      onChange={(e) => setFormData(prev => ({\r\n                        ...prev,\r\n                        auto_renewal: e.target.checked\r\n                      }))}\r\n                    />\r\n                  </Form.Group>\r\n\r\n                  <Form.Group className=\"mb-3\">\r\n                    <Form.Label>Điều khoản đặc biệt</Form.Label>\r\n                    <Form.Control\r\n                      as=\"textarea\"\r\n                      rows={3}\r\n                      value={formData.special_terms}\r\n                      onChange={(e) => {\r\n                        const value = e.target.value;\r\n                        setFormData(prev => ({\r\n                          ...prev,\r\n                          special_terms: value,\r\n                          variables: {\r\n                            ...prev.variables,\r\n                            special_terms: value\r\n                          }\r\n                        }));\r\n                      }}\r\n                      placeholder=\"Các điều khoản đặc biệt khác...\"\r\n                    />\r\n                  </Form.Group>\r\n                </Col>\r\n              </Row>\r\n            </Tab>\r\n\r\n            {/* Tab 2: Biến mẫu */}\r\n            <Tab eventKey=\"variables\" title=\"Biến mẫu\" disabled={!selectedTemplate}>\r\n              {selectedTemplate && selectedTemplate.variables && (\r\n                <div>\r\n                  <Alert variant=\"info\">\r\n                    <i className=\"fas fa-info-circle me-2\"></i>\r\n                    Các biến này sẽ được thay thế trong nội dung hợp đồng cuối cùng.\r\n                  </Alert>\r\n                  \r\n                  <Row>\r\n                    {(() => { let vars = []; try { vars = typeof selectedTemplate.variables === 'string' ? JSON.parse(selectedTemplate.variables) : (Array.isArray(selectedTemplate.variables) ? selectedTemplate.variables : []); } catch (e) { vars = []; } return vars; })().map(variable => (\r\n                      <Col md={6} key={variable.name}>\r\n                        <Form.Group className=\"mb-3\">\r\n                          <Form.Label>\r\n                            {variable.description || variable.name}\r\n                            {variable.required && <span className=\"text-danger\">*</span>}\r\n                          </Form.Label>\r\n                          \r\n                          {variable.type === 'boolean' ? (\r\n                            <Form.Check\r\n                              type=\"checkbox\"\r\n                              checked={formData.variables[variable.name] === 'true'}\r\n                              onChange={(e) => setFormData(prev => ({\r\n                                ...prev,\r\n                                variables: {\r\n                                  ...prev.variables,\r\n                                  [variable.name]: e.target.checked.toString()\r\n                                }\r\n                              }))}\r\n                            />\r\n                          ) : (\r\n                            <Form.Control\r\n                              type={variable.type === 'date' ? 'date' : \r\n                                   variable.type === 'number' ? 'number' : 'text'}\r\n                              value={formData.variables[variable.name] || ''}\r\n                              onChange={(e) => setFormData(prev => ({\r\n                                ...prev,\r\n                                variables: {\r\n                                  ...prev.variables,\r\n                                  [variable.name]: e.target.value\r\n                                }\r\n                              }))}\r\n                              required={variable.required}\r\n                              placeholder={`{{${variable.name}}}`}\r\n                            />\r\n                          )}\r\n                          \r\n                          <Form.Text className=\"text-muted\">\r\n                            Biến: <code>{`{{${variable.name}}}`}</code>\r\n                          </Form.Text>\r\n                        </Form.Group>\r\n                      </Col>\r\n                    ))}\r\n                  </Row>\r\n                </div>\r\n              )}\r\n            </Tab>\r\n\r\n            {/* Tab 3: Preview */}\r\n            <Tab eventKey=\"preview\" title=\"Xem trước\" disabled={!selectedTemplate}>\r\n              {selectedTemplate && (\r\n                <div>\r\n                  <Alert variant=\"success\">\r\n                    <i className=\"fas fa-eye me-2\"></i>\r\n                    Xem trước nội dung hợp đồng với dữ liệu đã nhập\r\n                  </Alert>\r\n                  \r\n                  <Card>\r\n                    <Card.Body>\r\n                      <div \r\n                        className=\"contract-preview\"\r\n                        dangerouslySetInnerHTML={{\r\n                          __html: String(selectedTemplate?.template_content || '').replace(\r\n                            /\\{\\{(\\w+)\\}\\}/g,\r\n                            (match, varName) => formData.variables[varName] || `[${varName}]`\r\n                          )\r\n                        }}\r\n                        style={{ \r\n                          border: '1px solid #ddd', \r\n                          padding: '20px',\r\n                          backgroundColor: 'white',\r\n                          fontFamily: 'Times New Roman, serif'\r\n                        }}\r\n                      />\r\n                    </Card.Body>\r\n                  </Card>\r\n                </div>\r\n              )}\r\n            </Tab>\r\n          </Tabs>\r\n\r\n          {/* Summary */}\r\n          {formData.customer_id && formData.template_id && (\r\n            <Alert variant=\"light\">\r\n              <Row>\r\n                <Col md={3}>\r\n                  <strong>Khách hàng:</strong><br/>\r\n                  {selectedCustomer?.name || selectedCustomer?.full_name}\r\n                </Col>\r\n                <Col md={3}>\r\n                  <strong>Mẫu hợp đồng:</strong><br/>\r\n                  {selectedTemplate?.template_name}\r\n                </Col>\r\n                <Col md={3}>\r\n                  <strong>Diện tích:</strong><br/>\r\n                  {formData.warehouse_area} m²\r\n                </Col>\r\n                <Col md={3}>\r\n                  <strong>Giá thuê:</strong><br/>\r\n                  {formatCurrency(formData.rental_price)} VNĐ/tháng\r\n                </Col>\r\n              </Row>\r\n            </Alert>\r\n          )}\r\n        </Form>\r\n      </Modal.Body>\r\n\r\n      <Modal.Footer>\r\n        <Button variant=\"secondary\" onClick={onHide} disabled={loading}>\r\n          Hủy\r\n        </Button>\r\n        \r\n        <Button \r\n          variant=\"primary\" \r\n          onClick={handleSubmit}\r\n          disabled={loading || !formData.customer_id || !formData.template_id}\r\n        >\r\n          {loading ? (\r\n            <>\r\n              <span className=\"spinner-border spinner-border-sm me-2\"></span>\r\n              Đang tạo...\r\n            </>\r\n          ) : (\r\n            <>\r\n              <i className=\"fas fa-save me-2\"></i>\r\n              Tạo hợp đồng\r\n            </>\r\n          )}\r\n        </Button>\r\n      </Modal.Footer>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default ContractCreator;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}