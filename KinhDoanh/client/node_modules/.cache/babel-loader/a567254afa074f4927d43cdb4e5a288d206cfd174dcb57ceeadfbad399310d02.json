{"ast":null,"code":"/**\r\n * Customer Service - API calls for customer management\r\n */const API_BASE=process.env.REACT_APP_API_URL||'http://localhost:5001/api';class CustomerService{async getAuthHeaders(){let noCache=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;const token=localStorage.getItem('token');const headers={'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)};if(noCache){headers['Cache-Control']='no-cache';headers['Pragma']='no-cache';}return headers;}async handleResponse(response){const data=await response.json();if(!response.ok){throw new Error(data.message||\"HTTP error! status: \".concat(response.status));}return data;}// Lấy danh sách khách hàng\nasync getCustomers(){let params=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};const queryString=new URLSearchParams(params).toString();const url=\"\".concat(API_BASE,\"/customers\").concat(queryString?\"?\".concat(queryString):'');const response=await fetch(url,{method:'GET',headers:await this.getAuthHeaders(true)// Force no-cache for fresh data\n});return this.handleResponse(response);}// Lấy chi tiết khách hàng\nasync getCustomer(id){const response=await fetch(\"\".concat(API_BASE,\"/customers/\").concat(id),{method:'GET',headers:await this.getAuthHeaders()});return this.handleResponse(response);}// Tạo khách hàng mới\nasync createCustomer(customerData){const response=await fetch(\"\".concat(API_BASE,\"/customers\"),{method:'POST',headers:await this.getAuthHeaders(),body:JSON.stringify(customerData)});return this.handleResponse(response);}// Cập nhật khách hàng\nasync updateCustomer(id,customerData){const response=await fetch(\"\".concat(API_BASE,\"/customers/\").concat(id),{method:'PUT',headers:await this.getAuthHeaders(),body:JSON.stringify(customerData)});return this.handleResponse(response);}// Xóa khách hàng\nasync deleteCustomer(id){const response=await fetch(\"\".concat(API_BASE,\"/customers/\").concat(id),{method:'DELETE',headers:await this.getAuthHeaders()});return this.handleResponse(response);}// Lấy hợp đồng của khách hàng\nasync getCustomerContracts(customerId){let status=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;const params=status?{status}:{};const queryString=new URLSearchParams(params).toString();const url=\"\".concat(API_BASE,\"/customers/\").concat(customerId,\"/contracts\").concat(queryString?\"?\".concat(queryString):'');const response=await fetch(url,{method:'GET',headers:await this.getAuthHeaders()});return this.handleResponse(response);}// Tạo hợp đồng mới\nasync createContract(contractData){const response=await fetch(\"\".concat(API_BASE,\"/customers/contracts\"),{method:'POST',headers:await this.getAuthHeaders(),body:JSON.stringify(contractData)});return this.handleResponse(response);}// Lấy hợp đồng sắp hết hạn\nasync getExpiringContracts(){let days=arguments.length>0&&arguments[0]!==undefined?arguments[0]:30;const response=await fetch(\"\".concat(API_BASE,\"/customers/contracts/expiring?days=\").concat(days),{method:'GET',headers:await this.getAuthHeaders()});return this.handleResponse(response);}// Lấy thống kê khách hàng\nasync getCustomerStats(){const response=await fetch(\"\".concat(API_BASE,\"/customers/stats\"),{method:'GET',headers:await this.getAuthHeaders()});return this.handleResponse(response);}}const customerService=new CustomerService();export default customerService;","map":{"version":3,"names":["API_BASE","process","env","REACT_APP_API_URL","CustomerService","getAuthHeaders","noCache","arguments","length","undefined","token","localStorage","getItem","headers","concat","handleResponse","response","data","json","ok","Error","message","status","getCustomers","params","queryString","URLSearchParams","toString","url","fetch","method","getCustomer","id","createCustomer","customerData","body","JSON","stringify","updateCustomer","deleteCustomer","getCustomerContracts","customerId","createContract","contractData","getExpiringContracts","days","getCustomerStats","customerService"],"sources":["C:/KinhDoanh/client/src/services/customerService.js"],"sourcesContent":["/**\r\n * Customer Service - API calls for customer management\r\n */\r\n\r\nconst API_BASE = process.env.REACT_APP_API_URL || 'http://localhost:5001/api';\r\n\r\nclass CustomerService {\r\n  async getAuthHeaders(noCache = false) {\r\n    const token = localStorage.getItem('token');\r\n    const headers = {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': `Bearer ${token}`\r\n    };\r\n    \r\n    if (noCache) {\r\n      headers['Cache-Control'] = 'no-cache';\r\n      headers['Pragma'] = 'no-cache';\r\n    }\r\n    \r\n    return headers;\r\n  }\r\n\r\n  async handleResponse(response) {\r\n    const data = await response.json();\r\n    \r\n    if (!response.ok) {\r\n      throw new Error(data.message || `HTTP error! status: ${response.status}`);\r\n    }\r\n    \r\n    return data;\r\n  }\r\n\r\n  // Lấy danh sách khách hàng\r\n  async getCustomers(params = {}) {\r\n    const queryString = new URLSearchParams(params).toString();\r\n    const url = `${API_BASE}/customers${queryString ? `?${queryString}` : ''}`;\r\n    \r\n    const response = await fetch(url, {\r\n      method: 'GET',\r\n      headers: await this.getAuthHeaders(true) // Force no-cache for fresh data\r\n    });\r\n    \r\n    return this.handleResponse(response);\r\n  }\r\n\r\n  // Lấy chi tiết khách hàng\r\n  async getCustomer(id) {\r\n    const response = await fetch(`${API_BASE}/customers/${id}`, {\r\n      method: 'GET',\r\n      headers: await this.getAuthHeaders()\r\n    });\r\n    \r\n    return this.handleResponse(response);\r\n  }\r\n\r\n  // Tạo khách hàng mới\r\n  async createCustomer(customerData) {\r\n    const response = await fetch(`${API_BASE}/customers`, {\r\n      method: 'POST',\r\n      headers: await this.getAuthHeaders(),\r\n      body: JSON.stringify(customerData)\r\n    });\r\n    \r\n    return this.handleResponse(response);\r\n  }\r\n\r\n  // Cập nhật khách hàng\r\n  async updateCustomer(id, customerData) {\r\n    const response = await fetch(`${API_BASE}/customers/${id}`, {\r\n      method: 'PUT',\r\n      headers: await this.getAuthHeaders(),\r\n      body: JSON.stringify(customerData)\r\n    });\r\n    \r\n    return this.handleResponse(response);\r\n  }\r\n\r\n  // Xóa khách hàng\r\n  async deleteCustomer(id) {\r\n    const response = await fetch(`${API_BASE}/customers/${id}`, {\r\n      method: 'DELETE',\r\n      headers: await this.getAuthHeaders()\r\n    });\r\n    \r\n    return this.handleResponse(response);\r\n  }\r\n\r\n  // Lấy hợp đồng của khách hàng\r\n  async getCustomerContracts(customerId, status = null) {\r\n    const params = status ? { status } : {};\r\n    const queryString = new URLSearchParams(params).toString();\r\n    const url = `${API_BASE}/customers/${customerId}/contracts${queryString ? `?${queryString}` : ''}`;\r\n    \r\n    const response = await fetch(url, {\r\n      method: 'GET',\r\n      headers: await this.getAuthHeaders()\r\n    });\r\n    \r\n    return this.handleResponse(response);\r\n  }\r\n\r\n  // Tạo hợp đồng mới\r\n  async createContract(contractData) {\r\n    const response = await fetch(`${API_BASE}/customers/contracts`, {\r\n      method: 'POST',\r\n      headers: await this.getAuthHeaders(),\r\n      body: JSON.stringify(contractData)\r\n    });\r\n    \r\n    return this.handleResponse(response);\r\n  }\r\n\r\n  // Lấy hợp đồng sắp hết hạn\r\n  async getExpiringContracts(days = 30) {\r\n    const response = await fetch(`${API_BASE}/customers/contracts/expiring?days=${days}`, {\r\n      method: 'GET',\r\n      headers: await this.getAuthHeaders()\r\n    });\r\n    \r\n    return this.handleResponse(response);\r\n  }\r\n\r\n  // Lấy thống kê khách hàng\r\n  async getCustomerStats() {\r\n    const response = await fetch(`${API_BASE}/customers/stats`, {\r\n      method: 'GET',\r\n      headers: await this.getAuthHeaders()\r\n    });\r\n    \r\n    return this.handleResponse(response);\r\n  }\r\n}\r\n\r\nconst customerService = new CustomerService();\r\nexport default customerService;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}