{"ast":null,"code":"import _objectSpread from\"C:/Users/Admin/Documents/GitHub/MVG_InventoryManagement/KinhDoanh/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";/**\r\n * Customers Page - KHO MVG\r\n * Danh s√°ch v√† qu·∫£n l√Ω kh√°ch h√†ng\r\n */import React,{useState,useEffect,useCallback}from'react';import{Container,Row,Col,Card,Button,Table,Badge,Form,Modal}from'react-bootstrap';import{useNavigate}from'react-router-dom';import{useAuth}from'../../contexts/AuthContext';import{useNotification}from'../../contexts/NotificationContext';import LoadingSpinner from'../../components/Common/LoadingSpinner';import CustomerFormTabs from'../../components/Customers/CustomerFormTabs';import customerService from'../../services/customerService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Customers(){const navigate=useNavigate();const{hasPermission}=useAuth();const{showSuccess,showError}=useNotification();const[loading,setLoading]=useState(true);const[customers,setCustomers]=useState([]);const[filteredCustomers,setFilteredCustomers]=useState([]);const[showCreateModal,setShowCreateModal]=useState(false);const[showEditModal,setShowEditModal]=useState(false);const[editingCustomer,setEditingCustomer]=useState(null);const[formLoading,setFormLoading]=useState(false);const[pagination,setPagination]=useState({page:1,limit:20,total:0,pages:0});const[filters,setFilters]=useState({search:'',customer_type:'',credit_rating:''});// Load customers from API\nconst loadCustomers=useCallback(async function(){let page=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;try{setLoading(true);const params=_objectSpread({page,limit:pagination.limit},filters);// Remove empty filters\nObject.keys(params).forEach(key=>{if(!params[key])delete params[key];});const response=await customerService.getCustomers(params);setCustomers(response.data.customers);setFilteredCustomers(response.data.customers);setPagination(response.data.pagination);}catch(error){// showError('Kh√¥ng th·ªÉ t·∫£i danh s√°ch kh√°ch h√†ng: ' + error.message);\nconsole.warn('Customer loading error:',error.message);}finally{setLoading(false);}},[filters,pagination.limit,showError]);useEffect(()=>{if(hasPermission('customer_read')){loadCustomers(pagination.page);}},[hasPermission,loadCustomers,pagination.page]);useEffect(()=>{loadCustomers(pagination.page);},[]);// Handle filter changes\nuseEffect(()=>{// Debounce search to avoid too many API calls\nconst timeoutId=setTimeout(()=>{if(pagination.page===1){loadCustomers(1);}else{setPagination(prev=>_objectSpread(_objectSpread({},prev),{},{page:1}));loadCustomers(1);}},500);return()=>clearTimeout(timeoutId);},[filters]);const handleFilterChange=(key,value)=>{setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{[key]:value}));};const getCreditRatingBadge=rating=>{const ratingMap={A:{variant:'success',label:'A - T·ªët'},B:{variant:'primary',label:'B - Kh√°'},C:{variant:'warning',label:'C - Trung b√¨nh'},D:{variant:'danger',label:'D - K√©m'}};const ratingInfo=ratingMap[rating]||{variant:'secondary',label:rating};return/*#__PURE__*/_jsx(Badge,{bg:ratingInfo.variant,children:ratingInfo.label});};const getCustomerTypeBadge=type=>{return type==='company'?/*#__PURE__*/_jsx(Badge,{bg:\"info\",children:\"Doanh nghi\\u1EC7p\"}):/*#__PURE__*/_jsx(Badge,{bg:\"secondary\",children:\"C\\xE1 nh\\xE2n\"});};const formatCurrency=amount=>{return new Intl.NumberFormat('vi-VN',{style:'currency',currency:'VND'}).format(amount).replace('‚Ç´','ƒë');};const handleViewCustomer=customerId=>{navigate(\"/customers/\".concat(customerId));};const handleCreateCustomer=()=>{if(!hasPermission('customer_create')){showError('B·∫°n kh√¥ng c√≥ quy·ªÅn t·∫°o kh√°ch h√†ng m·ªõi');return;}setEditingCustomer(null);setShowCreateModal(true);};const handleEditCustomer=async customer=>{if(!hasPermission('customer_update')){showError('B·∫°n kh√¥ng c√≥ quy·ªÅn ch·ªânh s·ª≠a kh√°ch h√†ng');return;}try{setFormLoading(true);console.log('üîç Loading full customer data including contracts...');// Load full customer data with contracts from API\nconst fullCustomerData=await customerService.getCustomer(customer.id);console.log('‚úÖ Full customer data loaded:',fullCustomerData.data);// Merge customer info with contracts data\nconst customerWithContracts=_objectSpread(_objectSpread({},fullCustomerData.data.customer),{},{// Customer personal/company info\ncontracts:fullCustomerData.data.contracts||[],// Contracts array\nstatistics:fullCustomerData.data.statistics});console.log('‚úÖ Merged customer data for form:',customerWithContracts);setEditingCustomer(customerWithContracts);setShowEditModal(true);}catch(error){console.error('‚ùå Failed to load customer details:',error);// Fallback to using basic customer data if API fails\nsetEditingCustomer(customer);setShowEditModal(true);}finally{setFormLoading(false);}};const handleDeleteCustomer=async customer=>{if(!hasPermission('customer_delete')){showError('B·∫°n kh√¥ng c√≥ quy·ªÅn x√≥a kh√°ch h√†ng');return;}if(window.confirm(\"B\\u1EA1n c\\xF3 ch\\u1EAFc ch\\u1EAFn mu\\u1ED1n x\\xF3a kh\\xE1ch h\\xE0ng \\\"\".concat(customer.company_name||customer.contact_person,\"\\\"?\"))){try{await customerService.deleteCustomer(customer.id);showSuccess('X√≥a kh√°ch h√†ng th√†nh c√¥ng');loadCustomers(pagination.page);}catch(error){showError('Kh√¥ng th·ªÉ x√≥a kh√°ch h√†ng: '+error.message);}}};// Transform form data to API format\nconst transformFormDataToAPI=formData=>{console.log('üîç Raw form data received:',formData);// Safety checks for form data structure\nif(!formData||typeof formData!=='object'){console.error('‚ùå Invalid form data structure:',formData);throw new Error('Invalid form data received');}const{personal={},companies=[]}=formData;const primaryCompany=companies[0]||{};console.log('üìã Form data breakdown:',{personal,primaryCompany,companiesLength:companies.length});const apiData={// Map from personal tab\nname:primaryCompany.company_name||personal.full_name||'',full_name:personal.full_name||'',representative_name:personal.full_name||'',phone:personal.phone||'',email:personal.email||'',address:personal.address||primaryCompany.invoice_address||'',customer_type:personal.customer_type||'individual',notes:personal.notes||'',id_number:personal.id_number||'',warehouse_purpose:primaryCompany.warehouse_purpose||'',// Map from company tab  \ntax_code:primaryCompany.tax_code||'',representative_phone:personal.phone||'',representative_email:personal.email||''};console.log('üìä Field mapping details:');console.log('  personal.full_name ‚Üí',apiData.full_name,'& representative_name ‚Üí',apiData.representative_name);console.log('  personal.id_number ‚Üí',apiData.id_number);console.log('  personal.phone ‚Üí',apiData.phone);console.log('  personal.email ‚Üí',apiData.email);console.log('  personal.address ‚Üí',apiData.address);console.log('  primaryCompany.company_name ‚Üí',apiData.name);console.log('  primaryCompany.warehouse_purpose ‚Üí',apiData.warehouse_purpose);console.log('  primaryCompany.tax_code ‚Üí',apiData.tax_code);console.log('‚úÖ Transformed API data:',apiData);// Validation checks\nif(!apiData.representative_name||!apiData.phone){console.error('‚ùå Missing required fields:',{representative_name:apiData.representative_name,phone:apiData.phone});throw new Error('Missing required fields: representative_name or phone');}return apiData;};const handleSaveCustomer=async customerData=>{try{setFormLoading(true);// Transform the nested form data to flat API format\nconst apiData=transformFormDataToAPI(customerData);console.log('Transformed customer data:',apiData);if(editingCustomer){await customerService.updateCustomer(editingCustomer.id,apiData);showSuccess('C·∫≠p nh·∫≠t kh√°ch h√†ng th√†nh c√¥ng');setShowEditModal(false);// Force reload customer data to show updated info\nconsole.log('üîÑ Reloading customers list after update...');await loadCustomers(pagination.page);console.log('‚úÖ Customers list reloaded successfully');}else{await customerService.createCustomer(apiData);showSuccess('T·∫°o kh√°ch h√†ng m·ªõi th√†nh c√¥ng');setShowCreateModal(false);// Reload list to show new customer\nawait loadCustomers(pagination.page);}setEditingCustomer(null);}catch(error){throw error;// Let the form handle the error\n}finally{setFormLoading(false);}};// const handlePageChange = (newPage) => {\n//   setPagination(prev => ({ ...prev, page: newPage }));\n//   loadCustomers(newPage);\n// };\nconst totalRevenue=customers.reduce((sum,customer)=>sum+customer.monthly_revenue,0);const activeCustomers=customers.filter(c=>c.active_contracts>0).length;const averageRevenue=customers.length>0?totalRevenue/customers.length:0;if(loading){return/*#__PURE__*/_jsx(LoadingSpinner,{text:\"\\u0110ang t\\u1EA3i danh s\\xE1ch kh\\xE1ch h\\xE0ng...\"});}return/*#__PURE__*/_jsxs(Container,{fluid:true,className:\"p-4\",children:[/*#__PURE__*/_jsx(Row,{className:\"mb-4\",children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"mb-1\",children:\"Qu\\u1EA3n l\\xFD Kh\\xE1ch h\\xE0ng\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-0\",children:\"Qu\\u1EA3n l\\xFD th\\xF4ng tin kh\\xE1ch h\\xE0ng v\\xE0 h\\u1EE3p \\u0111\\u1ED3ng\"})]}),hasPermission('customer_create')&&/*#__PURE__*/_jsxs(Button,{variant:\"primary\",onClick:handleCreateCustomer,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-plus me-2\"}),\"Th\\xEAm kh\\xE1ch h\\xE0ng\"]})]})})}),/*#__PURE__*/_jsxs(Row,{className:\"mb-4\",children:[/*#__PURE__*/_jsx(Col,{md:3,className:\"mb-3\",children:/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h6\",{className:\"text-muted mb-1\",children:\"T\\u1ED5ng kh\\xE1ch h\\xE0ng\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"mb-0 text-primary\",children:customers.length})]}),/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-users fa-2x text-primary opacity-25\"})]})})})}),/*#__PURE__*/_jsx(Col,{md:3,className:\"mb-3\",children:/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h6\",{className:\"text-muted mb-1\",children:\"\\u0110ang ho\\u1EA1t \\u0111\\u1ED9ng\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"mb-0 text-success\",children:activeCustomers})]}),/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-user-check fa-2x text-success opacity-25\"})]})})})}),/*#__PURE__*/_jsx(Col,{md:3,className:\"mb-3\",children:/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h6\",{className:\"text-muted mb-1\",children:\"T\\u1ED5ng doanh thu/th\\xE1ng\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"mb-0 text-warning\",children:formatCurrency(totalRevenue)})]}),/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-chart-line fa-2x text-warning opacity-25\"})]})})})}),/*#__PURE__*/_jsx(Col,{md:3,className:\"mb-3\",children:/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h6\",{className:\"text-muted mb-1\",children:\"TB doanh thu/KH\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"mb-0 text-info\",children:formatCurrency(averageRevenue)})]}),/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-calculator fa-2x text-info opacity-25\"})]})})})})]}),/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm mb-4\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(Form.Label,{children:\"T\\xECm ki\\u1EBFm\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"T\\xECm theo m\\xE3, t\\xEAn, S\\u0110T, email...\",value:filters.search,onChange:e=>handleFilterChange('search',e.target.value)})]})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Lo\\u1EA1i kh\\xE1ch h\\xE0ng\"}),/*#__PURE__*/_jsxs(Form.Select,{value:filters.customer_type,onChange:e=>handleFilterChange('customer_type',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"T\\u1EA5t c\\u1EA3 lo\\u1EA1i\"}),/*#__PURE__*/_jsx(\"option\",{value:\"company\",children:\"Doanh nghi\\u1EC7p\"}),/*#__PURE__*/_jsx(\"option\",{value:\"individual\",children:\"C\\xE1 nh\\xE2n\"})]})]})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(Form.Label,{children:\"X\\u1EBFp h\\u1EA1ng t\\xEDn d\\u1EE5ng\"}),/*#__PURE__*/_jsxs(Form.Select,{value:filters.credit_rating,onChange:e=>handleFilterChange('credit_rating',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"T\\u1EA5t c\\u1EA3 x\\u1EBFp h\\u1EA1ng\"}),/*#__PURE__*/_jsx(\"option\",{value:\"A\",children:\"A - T\\u1ED1t\"}),/*#__PURE__*/_jsx(\"option\",{value:\"B\",children:\"B - Kh\\xE1\"}),/*#__PURE__*/_jsx(\"option\",{value:\"C\",children:\"C - Trung b\\xECnh\"}),/*#__PURE__*/_jsx(\"option\",{value:\"D\",children:\"D - K\\xE9m\"})]})]})})]})})}),/*#__PURE__*/_jsxs(Card,{className:\"border-0 shadow-sm\",children:[/*#__PURE__*/_jsx(Card.Header,{className:\"bg-white border-0\",children:/*#__PURE__*/_jsxs(\"h5\",{className:\"mb-0\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-list me-2\"}),\"Danh s\\xE1ch kh\\xE1ch h\\xE0ng (\",filteredCustomers.length,\")\"]})}),/*#__PURE__*/_jsx(Card.Body,{className:\"p-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(Table,{hover:true,className:\"mb-0\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-light\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Kh\\xE1ch h\\xE0ng\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Li\\xEAn h\\u1EC7\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Lo\\u1EA1i\"}),/*#__PURE__*/_jsx(\"th\",{children:\"X\\u1EBFp h\\u1EA1ng\"}),/*#__PURE__*/_jsx(\"th\",{children:\"H\\u1EE3p \\u0111\\u1ED3ng\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Doanh thu/th\\xE1ng\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Thao t\\xE1c\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:filteredCustomers.length>0?filteredCustomers.map(customer=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"fw-bold\",children:customer.company_name||customer.contact_person}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:customer.customer_code}),customer.company_name&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:customer.contact_person})})]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-phone fa-sm me-1\"}),customer.phone]}),customer.email&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-envelope fa-sm me-1\"}),/*#__PURE__*/_jsx(\"small\",{children:customer.email})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-muted\",children:/*#__PURE__*/_jsx(\"small\",{children:customer.address})})]})}),/*#__PURE__*/_jsx(\"td\",{children:getCustomerTypeBadge(customer.customer_type)}),/*#__PURE__*/_jsx(\"td\",{children:getCreditRatingBadge(customer.credit_rating)}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"fw-medium text-success\",children:customer.active_contracts}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-muted\",children:[\"/\",customer.total_contracts]})]}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"Hi\\u1EC7u l\\u1EF1c/T\\u1ED5ng\"})]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"fw-bold text-success\",children:formatCurrency(customer.monthly_revenue)})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"btn-group\",children:[/*#__PURE__*/_jsx(Button,{variant:\"outline-primary\",size:\"sm\",onClick:()=>handleViewCustomer(customer.id),children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-eye\"})}),hasPermission('customer_update')&&/*#__PURE__*/_jsx(Button,{variant:\"outline-secondary\",size:\"sm\",onClick:()=>handleEditCustomer(customer),title:\"Ch\\u1EC9nh s\\u1EEDa\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-edit\"})}),hasPermission('customer_delete')&&/*#__PURE__*/_jsx(Button,{variant:\"outline-danger\",size:\"sm\",className:\"ms-1\",onClick:()=>handleDeleteCustomer(customer),title:\"X\\xF3a kh\\xE1ch h\\xE0ng\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-trash\"})}),hasPermission('contract_create')&&/*#__PURE__*/_jsx(Button,{variant:\"outline-success\",size:\"sm\",onClick:()=>navigate(\"/contracts/create?customer=\".concat(customer.id)),title:\"T\\u1EA1o h\\u1EE3p \\u0111\\u1ED3ng m\\u1EDBi\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-file-contract\"})})]})})]},customer.id)):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:7,className:\"text-center py-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-muted\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-search fa-2x mb-3\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Kh\\xF4ng t\\xECm th\\u1EA5y kh\\xE1ch h\\xE0ng n\\xE0o ph\\xF9 h\\u1EE3p v\\u1EDBi b\\u1ED9 l\\u1ECDc\"})]})})})})]})})})]}),/*#__PURE__*/_jsxs(Row,{className:\"mt-4\",children:[/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Card,{className:\"border-0 shadow-sm\",children:[/*#__PURE__*/_jsx(Card.Header,{className:\"bg-white border-0\",children:/*#__PURE__*/_jsxs(\"h6\",{className:\"mb-0\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-exclamation-triangle text-warning me-2\"}),\"Kh\\xE1ch h\\xE0ng c\\u1EA7n ch\\xFA \\xFD\"]})}),/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"X\\u1EBFp h\\u1EA1ng D (K\\xE9m)\"}),/*#__PURE__*/_jsx(Badge,{bg:\"danger\",children:customers.filter(c=>c.credit_rating==='D').length})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Kh\\xF4ng c\\xF3 h\\u1EE3p \\u0111\\u1ED3ng hi\\u1EC7u l\\u1EF1c\"}),/*#__PURE__*/_jsx(Badge,{bg:\"warning\",children:customers.filter(c=>c.active_contracts===0).length})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Doanh thu = 0\"}),/*#__PURE__*/_jsx(Badge,{bg:\"secondary\",children:customers.filter(c=>c.monthly_revenue===0).length})]})]})]})}),/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Card,{className:\"border-0 shadow-sm\",children:[/*#__PURE__*/_jsx(Card.Header,{className:\"bg-white border-0\",children:/*#__PURE__*/_jsxs(\"h6\",{className:\"mb-0\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-chart-pie text-info me-2\"}),\"Th\\u1ED1ng k\\xEA nhanh\"]})}),/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Doanh nghi\\u1EC7p\"}),/*#__PURE__*/_jsxs(Badge,{bg:\"info\",children:[customers.filter(c=>c.customer_type==='company').length,/*#__PURE__*/_jsxs(\"span\",{className:\"ms-1\",children:[\"(\",Math.round(customers.filter(c=>c.customer_type==='company').length/customers.length*100),\"%)\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"C\\xE1 nh\\xE2n\"}),/*#__PURE__*/_jsxs(Badge,{bg:\"secondary\",children:[customers.filter(c=>c.customer_type==='individual').length,/*#__PURE__*/_jsxs(\"span\",{className:\"ms-1\",children:[\"(\",Math.round(customers.filter(c=>c.customer_type==='individual').length/customers.length*100),\"%)\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"X\\u1EBFp h\\u1EA1ng A (T\\u1ED1t)\"}),/*#__PURE__*/_jsx(Badge,{bg:\"success\",children:customers.filter(c=>c.credit_rating==='A').length})]})]})]})})]}),/*#__PURE__*/_jsxs(Modal,{show:showCreateModal,onHide:()=>setShowCreateModal(false),size:\"xl\",scrollable:true,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"Th\\xEAm kh\\xE1ch h\\xE0ng m\\u1EDBi\"})}),/*#__PURE__*/_jsx(Modal.Body,{className:\"p-0\",children:/*#__PURE__*/_jsx(\"div\",{style:{maxHeight:'80vh',overflowY:'auto',padding:'1rem'},children:/*#__PURE__*/_jsx(CustomerFormTabs,{customer:null,onSave:handleSaveCustomer,onCancel:()=>setShowCreateModal(false),isLoading:formLoading})})})]}),/*#__PURE__*/_jsxs(Modal,{show:showEditModal,onHide:()=>setShowEditModal(false),size:\"xl\",scrollable:true,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"Ch\\u1EC9nh s\\u1EEDa kh\\xE1ch h\\xE0ng\"})}),/*#__PURE__*/_jsx(Modal.Body,{className:\"p-0\",children:/*#__PURE__*/_jsx(\"div\",{style:{maxHeight:'80vh',overflowY:'auto',padding:'1rem'},children:/*#__PURE__*/_jsx(CustomerFormTabs,{customer:editingCustomer,onSave:handleSaveCustomer,onCancel:()=>setShowEditModal(false),isLoading:formLoading})})})]})]});}export default Customers;","map":{"version":3,"names":["React","useState","useEffect","useCallback","Container","Row","Col","Card","Button","Table","Badge","Form","Modal","useNavigate","useAuth","useNotification","LoadingSpinner","CustomerFormTabs","customerService","jsx","_jsx","jsxs","_jsxs","Customers","navigate","hasPermission","showSuccess","showError","loading","setLoading","customers","setCustomers","filteredCustomers","setFilteredCustomers","showCreateModal","setShowCreateModal","showEditModal","setShowEditModal","editingCustomer","setEditingCustomer","formLoading","setFormLoading","pagination","setPagination","page","limit","total","pages","filters","setFilters","search","customer_type","credit_rating","loadCustomers","arguments","length","undefined","params","_objectSpread","Object","keys","forEach","key","response","getCustomers","data","error","console","warn","message","timeoutId","setTimeout","prev","clearTimeout","handleFilterChange","value","getCreditRatingBadge","rating","ratingMap","A","variant","label","B","C","D","ratingInfo","bg","children","getCustomerTypeBadge","type","formatCurrency","amount","Intl","NumberFormat","style","currency","format","replace","handleViewCustomer","customerId","concat","handleCreateCustomer","handleEditCustomer","customer","log","fullCustomerData","getCustomer","id","customerWithContracts","contracts","statistics","handleDeleteCustomer","window","confirm","company_name","contact_person","deleteCustomer","transformFormDataToAPI","formData","Error","personal","companies","primaryCompany","companiesLength","apiData","name","full_name","representative_name","phone","email","address","invoice_address","notes","id_number","warehouse_purpose","tax_code","representative_phone","representative_email","handleSaveCustomer","customerData","updateCustomer","createCustomer","totalRevenue","reduce","sum","monthly_revenue","activeCustomers","filter","c","active_contracts","averageRevenue","text","fluid","className","onClick","md","Body","Group","Label","Control","placeholder","onChange","e","target","Select","Header","hover","map","customer_code","total_contracts","size","title","colSpan","Math","round","show","onHide","scrollable","closeButton","Title","maxHeight","overflowY","padding","onSave","onCancel","isLoading"],"sources":["C:/Users/Admin/Documents/GitHub/MVG_InventoryManagement/KinhDoanh/client/src/pages/Customers/index.js"],"sourcesContent":["/**\r\n * Customers Page - KHO MVG\r\n * Danh s√°ch v√† qu·∫£n l√Ω kh√°ch h√†ng\r\n */\r\n\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport { Container, Row, Col, Card, Button, Table, Badge, Form, Modal } from 'react-bootstrap';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { useNotification } from '../../contexts/NotificationContext';\r\nimport LoadingSpinner from '../../components/Common/LoadingSpinner';\r\nimport CustomerFormTabs from '../../components/Customers/CustomerFormTabs';\r\nimport customerService from '../../services/customerService';\r\n\r\nfunction Customers() {\r\n  const navigate = useNavigate();\r\n  const { hasPermission } = useAuth();\r\n  const { showSuccess, showError } = useNotification();\r\n  \r\n  const [loading, setLoading] = useState(true);\r\n  const [customers, setCustomers] = useState([]);\r\n  const [filteredCustomers, setFilteredCustomers] = useState([]);\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n  const [showEditModal, setShowEditModal] = useState(false);\r\n  const [editingCustomer, setEditingCustomer] = useState(null);\r\n  const [formLoading, setFormLoading] = useState(false);\r\n  const [pagination, setPagination] = useState({\r\n    page: 1,\r\n    limit: 20,\r\n    total: 0,\r\n    pages: 0\r\n  });\r\n  const [filters, setFilters] = useState({\r\n    search: '',\r\n    customer_type: '',\r\n    credit_rating: ''\r\n  });\r\n\r\n  // Load customers from API\r\n  const loadCustomers = useCallback(async (page = 1) => {\r\n    try {\r\n      setLoading(true);\r\n      const params = {\r\n        page,\r\n        limit: pagination.limit,\r\n        ...filters\r\n      };\r\n\r\n      // Remove empty filters\r\n      Object.keys(params).forEach(key => {\r\n        if (!params[key]) delete params[key];\r\n      });\r\n\r\n      const response = await customerService.getCustomers(params);\r\n      \r\n      setCustomers(response.data.customers);\r\n      setFilteredCustomers(response.data.customers);\r\n      setPagination(response.data.pagination);\r\n    } catch (error) {\r\n      // showError('Kh√¥ng th·ªÉ t·∫£i danh s√°ch kh√°ch h√†ng: ' + error.message);\r\n      console.warn('Customer loading error:', error.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [filters, pagination.limit, showError]);\r\n\r\n  useEffect(() => {\r\n    if (hasPermission('customer_read')) {\r\n      loadCustomers(pagination.page);\r\n    }\r\n  }, [hasPermission, loadCustomers, pagination.page]);\r\n\r\n  useEffect(() => {\r\n    loadCustomers(pagination.page);\r\n  }, []);\r\n\r\n  // Handle filter changes\r\n  useEffect(() => {\r\n    // Debounce search to avoid too many API calls\r\n    const timeoutId = setTimeout(() => {\r\n      if (pagination.page === 1) {\r\n        loadCustomers(1);\r\n      } else {\r\n        setPagination(prev => ({ ...prev, page: 1 }));\r\n        loadCustomers(1);\r\n      }\r\n    }, 500);\r\n\r\n    return () => clearTimeout(timeoutId);\r\n  }, [filters]);\r\n\r\n  const handleFilterChange = (key, value) => {\r\n    setFilters(prev => ({\r\n      ...prev,\r\n      [key]: value\r\n    }));\r\n  };\r\n\r\n  const getCreditRatingBadge = (rating) => {\r\n    const ratingMap = {\r\n      A: { variant: 'success', label: 'A - T·ªët' },\r\n      B: { variant: 'primary', label: 'B - Kh√°' },\r\n      C: { variant: 'warning', label: 'C - Trung b√¨nh' },\r\n      D: { variant: 'danger', label: 'D - K√©m' }\r\n    };\r\n    \r\n    const ratingInfo = ratingMap[rating] || { variant: 'secondary', label: rating };\r\n    return <Badge bg={ratingInfo.variant}>{ratingInfo.label}</Badge>;\r\n  };\r\n\r\n  const getCustomerTypeBadge = (type) => {\r\n    return type === 'company' ? \r\n      <Badge bg=\"info\">Doanh nghi·ªáp</Badge> : \r\n      <Badge bg=\"secondary\">C√° nh√¢n</Badge>;\r\n  };\r\n\r\n  const formatCurrency = (amount) => {\r\n    return new Intl.NumberFormat('vi-VN', {\r\n      style: 'currency',\r\n      currency: 'VND'\r\n    }).format(amount).replace('‚Ç´', 'ƒë');\r\n  };\r\n\r\n  const handleViewCustomer = (customerId) => {\r\n    navigate(`/customers/${customerId}`);\r\n  };\r\n\r\n  const handleCreateCustomer = () => {\r\n    if (!hasPermission('customer_create')) {\r\n      showError('B·∫°n kh√¥ng c√≥ quy·ªÅn t·∫°o kh√°ch h√†ng m·ªõi');\r\n      return;\r\n    }\r\n    setEditingCustomer(null);\r\n    setShowCreateModal(true);\r\n  };\r\n\r\n  const handleEditCustomer = async (customer) => {\r\n    if (!hasPermission('customer_update')) {\r\n      showError('B·∫°n kh√¥ng c√≥ quy·ªÅn ch·ªânh s·ª≠a kh√°ch h√†ng');\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      setFormLoading(true);\r\n      console.log('üîç Loading full customer data including contracts...');\r\n      \r\n      // Load full customer data with contracts from API\r\n      const fullCustomerData = await customerService.getCustomer(customer.id);\r\n      console.log('‚úÖ Full customer data loaded:', fullCustomerData.data);\r\n      \r\n      // Merge customer info with contracts data\r\n      const customerWithContracts = {\r\n        ...fullCustomerData.data.customer,  // Customer personal/company info\r\n        contracts: fullCustomerData.data.contracts || [],  // Contracts array\r\n        statistics: fullCustomerData.data.statistics\r\n      };\r\n      \r\n      console.log('‚úÖ Merged customer data for form:', customerWithContracts);\r\n      setEditingCustomer(customerWithContracts);\r\n      setShowEditModal(true);\r\n    } catch (error) {\r\n      console.error('‚ùå Failed to load customer details:', error);\r\n      // Fallback to using basic customer data if API fails\r\n      setEditingCustomer(customer);\r\n      setShowEditModal(true);\r\n    } finally {\r\n      setFormLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteCustomer = async (customer) => {\r\n    if (!hasPermission('customer_delete')) {\r\n      showError('B·∫°n kh√¥ng c√≥ quy·ªÅn x√≥a kh√°ch h√†ng');\r\n      return;\r\n    }\r\n\r\n    if (window.confirm(`B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a kh√°ch h√†ng \"${customer.company_name || customer.contact_person}\"?`)) {\r\n      try {\r\n        await customerService.deleteCustomer(customer.id);\r\n        showSuccess('X√≥a kh√°ch h√†ng th√†nh c√¥ng');\r\n        loadCustomers(pagination.page);\r\n      } catch (error) {\r\n        showError('Kh√¥ng th·ªÉ x√≥a kh√°ch h√†ng: ' + error.message);\r\n      }\r\n    }\r\n  };\r\n\r\n  // Transform form data to API format\r\n  const transformFormDataToAPI = (formData) => {\r\n    console.log('üîç Raw form data received:', formData);\r\n    \r\n    // Safety checks for form data structure\r\n    if (!formData || typeof formData !== 'object') {\r\n      console.error('‚ùå Invalid form data structure:', formData);\r\n      throw new Error('Invalid form data received');\r\n    }\r\n    \r\n    const { personal = {}, companies = [] } = formData;\r\n    const primaryCompany = companies[0] || {};\r\n    \r\n    console.log('üìã Form data breakdown:', {\r\n      personal,\r\n      primaryCompany,\r\n      companiesLength: companies.length\r\n    });\r\n    \r\n    const apiData = {\r\n      // Map from personal tab\r\n      name: primaryCompany.company_name || personal.full_name || '',\r\n      full_name: personal.full_name || '',\r\n      representative_name: personal.full_name || '',\r\n      phone: personal.phone || '',\r\n      email: personal.email || '',\r\n      address: personal.address || primaryCompany.invoice_address || '',\r\n      customer_type: personal.customer_type || 'individual', \r\n      notes: personal.notes || '',\r\n      id_number: personal.id_number || '',\r\n      warehouse_purpose: primaryCompany.warehouse_purpose || '',\r\n      \r\n      // Map from company tab  \r\n      tax_code: primaryCompany.tax_code || '',\r\n      representative_phone: personal.phone || '', \r\n      representative_email: personal.email || ''\r\n    };\r\n    \r\n    console.log('üìä Field mapping details:');\r\n    console.log('  personal.full_name ‚Üí', apiData.full_name, '& representative_name ‚Üí', apiData.representative_name);\r\n    console.log('  personal.id_number ‚Üí', apiData.id_number);\r\n    console.log('  personal.phone ‚Üí', apiData.phone);\r\n    console.log('  personal.email ‚Üí', apiData.email);\r\n    console.log('  personal.address ‚Üí', apiData.address);\r\n    console.log('  primaryCompany.company_name ‚Üí', apiData.name);\r\n    console.log('  primaryCompany.warehouse_purpose ‚Üí', apiData.warehouse_purpose);\r\n    console.log('  primaryCompany.tax_code ‚Üí', apiData.tax_code);\r\n    \r\n    console.log('‚úÖ Transformed API data:', apiData);\r\n    \r\n    // Validation checks\r\n    if (!apiData.representative_name || !apiData.phone) {\r\n      console.error('‚ùå Missing required fields:', {\r\n        representative_name: apiData.representative_name,\r\n        phone: apiData.phone\r\n      });\r\n      throw new Error('Missing required fields: representative_name or phone');\r\n    }\r\n    \r\n    return apiData;\r\n  };\r\n\r\n  const handleSaveCustomer = async (customerData) => {\r\n    try {\r\n      setFormLoading(true);\r\n      \r\n      // Transform the nested form data to flat API format\r\n      const apiData = transformFormDataToAPI(customerData);\r\n      console.log('Transformed customer data:', apiData);\r\n      \r\n      if (editingCustomer) {\r\n        await customerService.updateCustomer(editingCustomer.id, apiData);\r\n        showSuccess('C·∫≠p nh·∫≠t kh√°ch h√†ng th√†nh c√¥ng');\r\n        setShowEditModal(false);\r\n        \r\n        // Force reload customer data to show updated info\r\n        console.log('üîÑ Reloading customers list after update...');\r\n        await loadCustomers(pagination.page);\r\n        console.log('‚úÖ Customers list reloaded successfully');\r\n      } else {\r\n        await customerService.createCustomer(apiData);\r\n        showSuccess('T·∫°o kh√°ch h√†ng m·ªõi th√†nh c√¥ng');\r\n        setShowCreateModal(false);\r\n        \r\n        // Reload list to show new customer\r\n        await loadCustomers(pagination.page);\r\n      }\r\n      \r\n      setEditingCustomer(null);\r\n    } catch (error) {\r\n      throw error; // Let the form handle the error\r\n    } finally {\r\n      setFormLoading(false);\r\n    }\r\n  };\r\n\r\n  // const handlePageChange = (newPage) => {\r\n  //   setPagination(prev => ({ ...prev, page: newPage }));\r\n  //   loadCustomers(newPage);\r\n  // };\r\n\r\n  const totalRevenue = customers.reduce((sum, customer) => sum + customer.monthly_revenue, 0);\r\n  const activeCustomers = customers.filter(c => c.active_contracts > 0).length;\r\n  const averageRevenue = customers.length > 0 ? totalRevenue / customers.length : 0;\r\n\r\n  if (loading) {\r\n    return <LoadingSpinner text=\"ƒêang t·∫£i danh s√°ch kh√°ch h√†ng...\" />;\r\n  }\r\n\r\n  return (\r\n    <Container fluid className=\"p-4\">\r\n      {/* Page Header */}\r\n      <Row className=\"mb-4\">\r\n        <Col>\r\n          <div className=\"d-flex justify-content-between align-items-center\">\r\n            <div>\r\n              <h2 className=\"mb-1\">Qu·∫£n l√Ω Kh√°ch h√†ng</h2>\r\n              <p className=\"text-muted mb-0\">\r\n                Qu·∫£n l√Ω th√¥ng tin kh√°ch h√†ng v√† h·ª£p ƒë·ªìng\r\n              </p>\r\n            </div>\r\n            {hasPermission('customer_create') && (\r\n              <Button variant=\"primary\" onClick={handleCreateCustomer}>\r\n                <i className=\"fas fa-plus me-2\"></i>\r\n                Th√™m kh√°ch h√†ng\r\n              </Button>\r\n            )}\r\n          </div>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Statistics Cards */}\r\n      <Row className=\"mb-4\">\r\n        <Col md={3} className=\"mb-3\">\r\n          <Card className=\"border-0 shadow-sm\">\r\n            <Card.Body>\r\n              <div className=\"d-flex justify-content-between align-items-center\">\r\n                <div>\r\n                  <h6 className=\"text-muted mb-1\">T·ªïng kh√°ch h√†ng</h6>\r\n                  <h4 className=\"mb-0 text-primary\">{customers.length}</h4>\r\n                </div>\r\n                <i className=\"fas fa-users fa-2x text-primary opacity-25\"></i>\r\n              </div>\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n        <Col md={3} className=\"mb-3\">\r\n          <Card className=\"border-0 shadow-sm\">\r\n            <Card.Body>\r\n              <div className=\"d-flex justify-content-between align-items-center\">\r\n                <div>\r\n                  <h6 className=\"text-muted mb-1\">ƒêang ho·∫°t ƒë·ªông</h6>\r\n                  <h4 className=\"mb-0 text-success\">{activeCustomers}</h4>\r\n                </div>\r\n                <i className=\"fas fa-user-check fa-2x text-success opacity-25\"></i>\r\n              </div>\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n        <Col md={3} className=\"mb-3\">\r\n          <Card className=\"border-0 shadow-sm\">\r\n            <Card.Body>\r\n              <div className=\"d-flex justify-content-between align-items-center\">\r\n                <div>\r\n                  <h6 className=\"text-muted mb-1\">T·ªïng doanh thu/th√°ng</h6>\r\n                  <h4 className=\"mb-0 text-warning\">{formatCurrency(totalRevenue)}</h4>\r\n                </div>\r\n                <i className=\"fas fa-chart-line fa-2x text-warning opacity-25\"></i>\r\n              </div>\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n        <Col md={3} className=\"mb-3\">\r\n          <Card className=\"border-0 shadow-sm\">\r\n            <Card.Body>\r\n              <div className=\"d-flex justify-content-between align-items-center\">\r\n                <div>\r\n                  <h6 className=\"text-muted mb-1\">TB doanh thu/KH</h6>\r\n                  <h4 className=\"mb-0 text-info\">{formatCurrency(averageRevenue)}</h4>\r\n                </div>\r\n                <i className=\"fas fa-calculator fa-2x text-info opacity-25\"></i>\r\n              </div>\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Filters */}\r\n      <Card className=\"border-0 shadow-sm mb-4\">\r\n        <Card.Body>\r\n          <Row>\r\n            <Col md={4}>\r\n              <Form.Group>\r\n                <Form.Label>T√¨m ki·∫øm</Form.Label>\r\n                <Form.Control\r\n                  type=\"text\"\r\n                  placeholder=\"T√¨m theo m√£, t√™n, SƒêT, email...\"\r\n                  value={filters.search}\r\n                  onChange={(e) => handleFilterChange('search', e.target.value)}\r\n                />\r\n              </Form.Group>\r\n            </Col>\r\n            <Col md={4}>\r\n              <Form.Group>\r\n                <Form.Label>Lo·∫°i kh√°ch h√†ng</Form.Label>\r\n                <Form.Select\r\n                  value={filters.customer_type}\r\n                  onChange={(e) => handleFilterChange('customer_type', e.target.value)}\r\n                >\r\n                  <option value=\"\">T·∫•t c·∫£ lo·∫°i</option>\r\n                  <option value=\"company\">Doanh nghi·ªáp</option>\r\n                  <option value=\"individual\">C√° nh√¢n</option>\r\n                </Form.Select>\r\n              </Form.Group>\r\n            </Col>\r\n            <Col md={4}>\r\n              <Form.Group>\r\n                <Form.Label>X·∫øp h·∫°ng t√≠n d·ª•ng</Form.Label>\r\n                <Form.Select\r\n                  value={filters.credit_rating}\r\n                  onChange={(e) => handleFilterChange('credit_rating', e.target.value)}\r\n                >\r\n                  <option value=\"\">T·∫•t c·∫£ x·∫øp h·∫°ng</option>\r\n                  <option value=\"A\">A - T·ªët</option>\r\n                  <option value=\"B\">B - Kh√°</option>\r\n                  <option value=\"C\">C - Trung b√¨nh</option>\r\n                  <option value=\"D\">D - K√©m</option>\r\n                </Form.Select>\r\n              </Form.Group>\r\n            </Col>\r\n          </Row>\r\n        </Card.Body>\r\n      </Card>\r\n\r\n      {/* Customers Table */}\r\n      <Card className=\"border-0 shadow-sm\">\r\n        <Card.Header className=\"bg-white border-0\">\r\n          <h5 className=\"mb-0\">\r\n            <i className=\"fas fa-list me-2\"></i>\r\n            Danh s√°ch kh√°ch h√†ng ({filteredCustomers.length})\r\n          </h5>\r\n        </Card.Header>\r\n        <Card.Body className=\"p-0\">\r\n          <div className=\"table-responsive\">\r\n            <Table hover className=\"mb-0\">\r\n              <thead className=\"bg-light\">\r\n                <tr>\r\n                  <th>Kh√°ch h√†ng</th>\r\n                  <th>Li√™n h·ªá</th>\r\n                  <th>Lo·∫°i</th>\r\n                  <th>X·∫øp h·∫°ng</th>\r\n                  <th>H·ª£p ƒë·ªìng</th>\r\n                  <th>Doanh thu/th√°ng</th>\r\n                  <th>Thao t√°c</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {filteredCustomers.length > 0 ? (\r\n                  filteredCustomers.map((customer) => (\r\n                    <tr key={customer.id}>\r\n                      <td>\r\n                        <div>\r\n                          <div className=\"fw-bold\">\r\n                            {customer.company_name || customer.contact_person}\r\n                          </div>\r\n                          <small className=\"text-muted\">{customer.customer_code}</small>\r\n                          {customer.company_name && (\r\n                            <div>\r\n                              <small className=\"text-muted\">{customer.contact_person}</small>\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      </td>\r\n                      <td>\r\n                        <div>\r\n                          <div>\r\n                            <i className=\"fas fa-phone fa-sm me-1\"></i>\r\n                            {customer.phone}\r\n                          </div>\r\n                          {customer.email && (\r\n                            <div>\r\n                              <i className=\"fas fa-envelope fa-sm me-1\"></i>\r\n                              <small>{customer.email}</small>\r\n                            </div>\r\n                          )}\r\n                          <div className=\"text-muted\">\r\n                            <small>{customer.address}</small>\r\n                          </div>\r\n                        </div>\r\n                      </td>\r\n                      <td>{getCustomerTypeBadge(customer.customer_type)}</td>\r\n                      <td>{getCreditRatingBadge(customer.credit_rating)}</td>\r\n                      <td>\r\n                        <div>\r\n                          <div>\r\n                            <span className=\"fw-medium text-success\">\r\n                              {customer.active_contracts}\r\n                            </span>\r\n                            <span className=\"text-muted\">/{customer.total_contracts}</span>\r\n                          </div>\r\n                          <small className=\"text-muted\">Hi·ªáu l·ª±c/T·ªïng</small>\r\n                        </div>\r\n                      </td>\r\n                      <td>\r\n                        <div className=\"fw-bold text-success\">\r\n                          {formatCurrency(customer.monthly_revenue)}\r\n                        </div>\r\n                      </td>\r\n                      <td>\r\n                        <div className=\"btn-group\">\r\n                          <Button\r\n                            variant=\"outline-primary\"\r\n                            size=\"sm\"\r\n                            onClick={() => handleViewCustomer(customer.id)}\r\n                          >\r\n                            <i className=\"fas fa-eye\"></i>\r\n                          </Button>\r\n                          {hasPermission('customer_update') && (\r\n                            <Button\r\n                              variant=\"outline-secondary\"\r\n                              size=\"sm\"\r\n                              onClick={() => handleEditCustomer(customer)}\r\n                              title=\"Ch·ªânh s·ª≠a\"\r\n                            >\r\n                              <i className=\"fas fa-edit\"></i>\r\n                            </Button>\r\n                          )}\r\n                          {hasPermission('customer_delete') && (\r\n                            <Button\r\n                              variant=\"outline-danger\"\r\n                              size=\"sm\"\r\n                              className=\"ms-1\"\r\n                              onClick={() => handleDeleteCustomer(customer)}\r\n                              title=\"X√≥a kh√°ch h√†ng\"\r\n                            >\r\n                              <i className=\"fas fa-trash\"></i>\r\n                            </Button>\r\n                          )}\r\n                          {hasPermission('contract_create') && (\r\n                            <Button\r\n                              variant=\"outline-success\"\r\n                              size=\"sm\"\r\n                              onClick={() => navigate(`/contracts/create?customer=${customer.id}`)}\r\n                              title=\"T·∫°o h·ª£p ƒë·ªìng m·ªõi\"\r\n                            >\r\n                              <i className=\"fas fa-file-contract\"></i>\r\n                            </Button>\r\n                          )}\r\n                        </div>\r\n                      </td>\r\n                    </tr>\r\n                  ))\r\n                ) : (\r\n                  <tr>\r\n                    <td colSpan={7} className=\"text-center py-4\">\r\n                      <div className=\"text-muted\">\r\n                        <i className=\"fas fa-search fa-2x mb-3\"></i>\r\n                        <p>Kh√¥ng t√¨m th·∫•y kh√°ch h√†ng n√†o ph√π h·ª£p v·ªõi b·ªô l·ªçc</p>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                )}\r\n              </tbody>\r\n            </Table>\r\n          </div>\r\n        </Card.Body>\r\n      </Card>\r\n\r\n      {/* Quick Actions */}\r\n      <Row className=\"mt-4\">\r\n        <Col md={6}>\r\n          <Card className=\"border-0 shadow-sm\">\r\n            <Card.Header className=\"bg-white border-0\">\r\n              <h6 className=\"mb-0\">\r\n                <i className=\"fas fa-exclamation-triangle text-warning me-2\"></i>\r\n                Kh√°ch h√†ng c·∫ßn ch√∫ √Ω\r\n              </h6>\r\n            </Card.Header>\r\n            <Card.Body>\r\n              <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n                <span>X·∫øp h·∫°ng D (K√©m)</span>\r\n                <Badge bg=\"danger\">{customers.filter(c => c.credit_rating === 'D').length}</Badge>\r\n              </div>\r\n              <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n                <span>Kh√¥ng c√≥ h·ª£p ƒë·ªìng hi·ªáu l·ª±c</span>\r\n                <Badge bg=\"warning\">{customers.filter(c => c.active_contracts === 0).length}</Badge>\r\n              </div>\r\n              <div className=\"d-flex justify-content-between align-items-center\">\r\n                <span>Doanh thu = 0</span>\r\n                <Badge bg=\"secondary\">{customers.filter(c => c.monthly_revenue === 0).length}</Badge>\r\n              </div>\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n        \r\n        <Col md={6}>\r\n          <Card className=\"border-0 shadow-sm\">\r\n            <Card.Header className=\"bg-white border-0\">\r\n              <h6 className=\"mb-0\">\r\n                <i className=\"fas fa-chart-pie text-info me-2\"></i>\r\n                Th·ªëng k√™ nhanh\r\n              </h6>\r\n            </Card.Header>\r\n            <Card.Body>\r\n              <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n                <span>Doanh nghi·ªáp</span>\r\n                <Badge bg=\"info\">\r\n                  {customers.filter(c => c.customer_type === 'company').length}\r\n                  <span className=\"ms-1\">\r\n                    ({Math.round(customers.filter(c => c.customer_type === 'company').length / customers.length * 100)}%)\r\n                  </span>\r\n                </Badge>\r\n              </div>\r\n              <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n                <span>C√° nh√¢n</span>\r\n                <Badge bg=\"secondary\">\r\n                  {customers.filter(c => c.customer_type === 'individual').length}\r\n                  <span className=\"ms-1\">\r\n                    ({Math.round(customers.filter(c => c.customer_type === 'individual').length / customers.length * 100)}%)\r\n                  </span>\r\n                </Badge>\r\n              </div>\r\n              <div className=\"d-flex justify-content-between align-items-center\">\r\n                <span>X·∫øp h·∫°ng A (T·ªët)</span>\r\n                <Badge bg=\"success\">{customers.filter(c => c.credit_rating === 'A').length}</Badge>\r\n              </div>\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Create Customer Modal */}\r\n      <Modal show={showCreateModal} onHide={() => setShowCreateModal(false)} size=\"xl\" scrollable>\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Th√™m kh√°ch h√†ng m·ªõi</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body className=\"p-0\">\r\n          <div style={{ maxHeight: '80vh', overflowY: 'auto', padding: '1rem' }}>\r\n            <CustomerFormTabs\r\n              customer={null}\r\n              onSave={handleSaveCustomer}\r\n              onCancel={() => setShowCreateModal(false)}\r\n              isLoading={formLoading}\r\n            />\r\n          </div>\r\n        </Modal.Body>\r\n      </Modal>\r\n\r\n      {/* Edit Customer Modal */}\r\n      <Modal show={showEditModal} onHide={() => setShowEditModal(false)} size=\"xl\" scrollable>\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Ch·ªânh s·ª≠a kh√°ch h√†ng</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body className=\"p-0\">\r\n          <div style={{ maxHeight: '80vh', overflowY: 'auto', padding: '1rem' }}>\r\n            <CustomerFormTabs\r\n              customer={editingCustomer}\r\n              onSave={handleSaveCustomer}\r\n              onCancel={() => setShowEditModal(false)}\r\n              isLoading={formLoading}\r\n            />\r\n          </div>\r\n        </Modal.Body>\r\n      </Modal>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default Customers;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}