{"ast":null,"code":"import _objectSpread from\"C:/KinhDoanh/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";/**\r\n * Customers Page - KHO MVG\r\n * Danh sách và quản lý khách hàng\r\n */import React,{useState,useEffect,useCallback}from'react';import{Container,Row,Col,Card,Button,Table,Badge,Form,Modal}from'react-bootstrap';import{useNavigate}from'react-router-dom';import{useAuth}from'../../contexts/AuthContext';import{useNotification}from'../../contexts/NotificationContext';import LoadingSpinner from'../../components/Common/LoadingSpinner';import CustomerFormTabs from'../../components/Customers/CustomerFormTabs';import customerService from'../../services/customerService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Customers(){const navigate=useNavigate();const{hasPermission}=useAuth();const{showSuccess,showError}=useNotification();const[loading,setLoading]=useState(true);const[customers,setCustomers]=useState([]);const[filteredCustomers,setFilteredCustomers]=useState([]);const[showCreateModal,setShowCreateModal]=useState(false);const[showEditModal,setShowEditModal]=useState(false);const[editingCustomer,setEditingCustomer]=useState(null);const[formLoading,setFormLoading]=useState(false);const[pagination,setPagination]=useState({page:1,limit:20,total:0,pages:0});const[filters,setFilters]=useState({search:'',customer_type:'',credit_rating:''});// Load customers from API\nconst loadCustomers=useCallback(async function(){let page=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;try{setLoading(true);const params=_objectSpread({page,limit:pagination.limit},filters);// Remove empty filters\nObject.keys(params).forEach(key=>{if(!params[key])delete params[key];});const response=await customerService.getCustomers(params);setCustomers(response.data.customers);setFilteredCustomers(response.data.customers);setPagination(response.data.pagination);}catch(error){// showError('Không thể tải danh sách khách hàng: ' + error.message);\nconsole.warn('Customer loading error:',error.message);}finally{setLoading(false);}},[filters,pagination.limit,showError]);useEffect(()=>{if(hasPermission('customer_read')){loadCustomers(pagination.page);}},[hasPermission,loadCustomers,pagination.page]);useEffect(()=>{loadCustomers(pagination.page);},[]);// Handle filter changes\nuseEffect(()=>{// Debounce search to avoid too many API calls\nconst timeoutId=setTimeout(()=>{if(pagination.page===1){loadCustomers(1);}else{setPagination(prev=>_objectSpread(_objectSpread({},prev),{},{page:1}));loadCustomers(1);}},500);return()=>clearTimeout(timeoutId);},[filters]);const handleFilterChange=(key,value)=>{setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{[key]:value}));};const getCreditRatingBadge=rating=>{const ratingMap={A:{variant:'success',label:'A - Tốt'},B:{variant:'primary',label:'B - Khá'},C:{variant:'warning',label:'C - Trung bình'},D:{variant:'danger',label:'D - Kém'}};const ratingInfo=ratingMap[rating]||{variant:'secondary',label:rating};return/*#__PURE__*/_jsx(Badge,{bg:ratingInfo.variant,children:ratingInfo.label});};const getCustomerTypeBadge=type=>{return type==='company'?/*#__PURE__*/_jsx(Badge,{bg:\"info\",children:\"Doanh nghi\\u1EC7p\"}):/*#__PURE__*/_jsx(Badge,{bg:\"secondary\",children:\"C\\xE1 nh\\xE2n\"});};const formatCurrency=amount=>{return new Intl.NumberFormat('vi-VN',{style:'currency',currency:'VND'}).format(amount).replace('₫','đ');};const handleViewCustomer=customerId=>{navigate(\"/customers/\".concat(customerId));};const handleCreateCustomer=()=>{if(!hasPermission('customer_create')){showError('Bạn không có quyền tạo khách hàng mới');return;}setEditingCustomer(null);setShowCreateModal(true);};const handleEditCustomer=customer=>{if(!hasPermission('customer_update')){showError('Bạn không có quyền chỉnh sửa khách hàng');return;}setEditingCustomer(customer);setShowEditModal(true);};const handleDeleteCustomer=async customer=>{if(!hasPermission('customer_delete')){showError('Bạn không có quyền xóa khách hàng');return;}if(window.confirm(\"B\\u1EA1n c\\xF3 ch\\u1EAFc ch\\u1EAFn mu\\u1ED1n x\\xF3a kh\\xE1ch h\\xE0ng \\\"\".concat(customer.company_name||customer.contact_person,\"\\\"?\"))){try{await customerService.deleteCustomer(customer.id);showSuccess('Xóa khách hàng thành công');loadCustomers(pagination.page);}catch(error){showError('Không thể xóa khách hàng: '+error.message);}}};const handleSaveCustomer=async customerData=>{try{setFormLoading(true);if(editingCustomer){await customerService.updateCustomer(editingCustomer.id,customerData);showSuccess('Cập nhật khách hàng thành công');setShowEditModal(false);}else{await customerService.createCustomer(customerData);showSuccess('Tạo khách hàng mới thành công');setShowCreateModal(false);}setEditingCustomer(null);loadCustomers(pagination.page);}catch(error){throw error;// Let the form handle the error\n}finally{setFormLoading(false);}};// const handlePageChange = (newPage) => {\n//   setPagination(prev => ({ ...prev, page: newPage }));\n//   loadCustomers(newPage);\n// };\nconst totalRevenue=customers.reduce((sum,customer)=>sum+customer.monthly_revenue,0);const activeCustomers=customers.filter(c=>c.active_contracts>0).length;const averageRevenue=customers.length>0?totalRevenue/customers.length:0;if(loading){return/*#__PURE__*/_jsx(LoadingSpinner,{text:\"\\u0110ang t\\u1EA3i danh s\\xE1ch kh\\xE1ch h\\xE0ng...\"});}return/*#__PURE__*/_jsxs(Container,{fluid:true,className:\"p-4\",children:[/*#__PURE__*/_jsx(Row,{className:\"mb-4\",children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"mb-1\",children:\"Qu\\u1EA3n l\\xFD Kh\\xE1ch h\\xE0ng\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-0\",children:\"Qu\\u1EA3n l\\xFD th\\xF4ng tin kh\\xE1ch h\\xE0ng v\\xE0 h\\u1EE3p \\u0111\\u1ED3ng\"})]}),hasPermission('customer_create')&&/*#__PURE__*/_jsxs(Button,{variant:\"primary\",onClick:handleCreateCustomer,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-plus me-2\"}),\"Th\\xEAm kh\\xE1ch h\\xE0ng\"]})]})})}),/*#__PURE__*/_jsxs(Row,{className:\"mb-4\",children:[/*#__PURE__*/_jsx(Col,{md:3,className:\"mb-3\",children:/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h6\",{className:\"text-muted mb-1\",children:\"T\\u1ED5ng kh\\xE1ch h\\xE0ng\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"mb-0 text-primary\",children:customers.length})]}),/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-users fa-2x text-primary opacity-25\"})]})})})}),/*#__PURE__*/_jsx(Col,{md:3,className:\"mb-3\",children:/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h6\",{className:\"text-muted mb-1\",children:\"\\u0110ang ho\\u1EA1t \\u0111\\u1ED9ng\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"mb-0 text-success\",children:activeCustomers})]}),/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-user-check fa-2x text-success opacity-25\"})]})})})}),/*#__PURE__*/_jsx(Col,{md:3,className:\"mb-3\",children:/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h6\",{className:\"text-muted mb-1\",children:\"T\\u1ED5ng doanh thu/th\\xE1ng\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"mb-0 text-warning\",children:formatCurrency(totalRevenue)})]}),/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-chart-line fa-2x text-warning opacity-25\"})]})})})}),/*#__PURE__*/_jsx(Col,{md:3,className:\"mb-3\",children:/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h6\",{className:\"text-muted mb-1\",children:\"TB doanh thu/KH\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"mb-0 text-info\",children:formatCurrency(averageRevenue)})]}),/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-calculator fa-2x text-info opacity-25\"})]})})})})]}),/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm mb-4\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(Form.Label,{children:\"T\\xECm ki\\u1EBFm\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"T\\xECm theo m\\xE3, t\\xEAn, S\\u0110T, email...\",value:filters.search,onChange:e=>handleFilterChange('search',e.target.value)})]})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Lo\\u1EA1i kh\\xE1ch h\\xE0ng\"}),/*#__PURE__*/_jsxs(Form.Select,{value:filters.customer_type,onChange:e=>handleFilterChange('customer_type',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"T\\u1EA5t c\\u1EA3 lo\\u1EA1i\"}),/*#__PURE__*/_jsx(\"option\",{value:\"company\",children:\"Doanh nghi\\u1EC7p\"}),/*#__PURE__*/_jsx(\"option\",{value:\"individual\",children:\"C\\xE1 nh\\xE2n\"})]})]})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(Form.Label,{children:\"X\\u1EBFp h\\u1EA1ng t\\xEDn d\\u1EE5ng\"}),/*#__PURE__*/_jsxs(Form.Select,{value:filters.credit_rating,onChange:e=>handleFilterChange('credit_rating',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"T\\u1EA5t c\\u1EA3 x\\u1EBFp h\\u1EA1ng\"}),/*#__PURE__*/_jsx(\"option\",{value:\"A\",children:\"A - T\\u1ED1t\"}),/*#__PURE__*/_jsx(\"option\",{value:\"B\",children:\"B - Kh\\xE1\"}),/*#__PURE__*/_jsx(\"option\",{value:\"C\",children:\"C - Trung b\\xECnh\"}),/*#__PURE__*/_jsx(\"option\",{value:\"D\",children:\"D - K\\xE9m\"})]})]})})]})})}),/*#__PURE__*/_jsxs(Card,{className:\"border-0 shadow-sm\",children:[/*#__PURE__*/_jsx(Card.Header,{className:\"bg-white border-0\",children:/*#__PURE__*/_jsxs(\"h5\",{className:\"mb-0\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-list me-2\"}),\"Danh s\\xE1ch kh\\xE1ch h\\xE0ng (\",filteredCustomers.length,\")\"]})}),/*#__PURE__*/_jsx(Card.Body,{className:\"p-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(Table,{hover:true,className:\"mb-0\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-light\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Kh\\xE1ch h\\xE0ng\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Li\\xEAn h\\u1EC7\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Lo\\u1EA1i\"}),/*#__PURE__*/_jsx(\"th\",{children:\"X\\u1EBFp h\\u1EA1ng\"}),/*#__PURE__*/_jsx(\"th\",{children:\"H\\u1EE3p \\u0111\\u1ED3ng\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Doanh thu/th\\xE1ng\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Thao t\\xE1c\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:filteredCustomers.length>0?filteredCustomers.map(customer=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"fw-bold\",children:customer.company_name||customer.contact_person}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:customer.customer_code}),customer.company_name&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:customer.contact_person})})]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-phone fa-sm me-1\"}),customer.phone]}),customer.email&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-envelope fa-sm me-1\"}),/*#__PURE__*/_jsx(\"small\",{children:customer.email})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-muted\",children:/*#__PURE__*/_jsx(\"small\",{children:customer.address})})]})}),/*#__PURE__*/_jsx(\"td\",{children:getCustomerTypeBadge(customer.customer_type)}),/*#__PURE__*/_jsx(\"td\",{children:getCreditRatingBadge(customer.credit_rating)}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"fw-medium text-success\",children:customer.active_contracts}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-muted\",children:[\"/\",customer.total_contracts]})]}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"Hi\\u1EC7u l\\u1EF1c/T\\u1ED5ng\"})]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"fw-bold text-success\",children:formatCurrency(customer.monthly_revenue)})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"btn-group\",children:[/*#__PURE__*/_jsx(Button,{variant:\"outline-primary\",size:\"sm\",onClick:()=>handleViewCustomer(customer.id),children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-eye\"})}),hasPermission('customer_update')&&/*#__PURE__*/_jsx(Button,{variant:\"outline-secondary\",size:\"sm\",onClick:()=>handleEditCustomer(customer),title:\"Ch\\u1EC9nh s\\u1EEDa\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-edit\"})}),hasPermission('customer_delete')&&/*#__PURE__*/_jsx(Button,{variant:\"outline-danger\",size:\"sm\",className:\"ms-1\",onClick:()=>handleDeleteCustomer(customer),title:\"X\\xF3a kh\\xE1ch h\\xE0ng\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-trash\"})}),hasPermission('contract_create')&&/*#__PURE__*/_jsx(Button,{variant:\"outline-success\",size:\"sm\",onClick:()=>navigate(\"/contracts/create?customer=\".concat(customer.id)),title:\"T\\u1EA1o h\\u1EE3p \\u0111\\u1ED3ng m\\u1EDBi\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-file-contract\"})})]})})]},customer.id)):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:7,className:\"text-center py-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-muted\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-search fa-2x mb-3\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Kh\\xF4ng t\\xECm th\\u1EA5y kh\\xE1ch h\\xE0ng n\\xE0o ph\\xF9 h\\u1EE3p v\\u1EDBi b\\u1ED9 l\\u1ECDc\"})]})})})})]})})})]}),/*#__PURE__*/_jsxs(Row,{className:\"mt-4\",children:[/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Card,{className:\"border-0 shadow-sm\",children:[/*#__PURE__*/_jsx(Card.Header,{className:\"bg-white border-0\",children:/*#__PURE__*/_jsxs(\"h6\",{className:\"mb-0\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-exclamation-triangle text-warning me-2\"}),\"Kh\\xE1ch h\\xE0ng c\\u1EA7n ch\\xFA \\xFD\"]})}),/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"X\\u1EBFp h\\u1EA1ng D (K\\xE9m)\"}),/*#__PURE__*/_jsx(Badge,{bg:\"danger\",children:customers.filter(c=>c.credit_rating==='D').length})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Kh\\xF4ng c\\xF3 h\\u1EE3p \\u0111\\u1ED3ng hi\\u1EC7u l\\u1EF1c\"}),/*#__PURE__*/_jsx(Badge,{bg:\"warning\",children:customers.filter(c=>c.active_contracts===0).length})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Doanh thu = 0\"}),/*#__PURE__*/_jsx(Badge,{bg:\"secondary\",children:customers.filter(c=>c.monthly_revenue===0).length})]})]})]})}),/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Card,{className:\"border-0 shadow-sm\",children:[/*#__PURE__*/_jsx(Card.Header,{className:\"bg-white border-0\",children:/*#__PURE__*/_jsxs(\"h6\",{className:\"mb-0\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-chart-pie text-info me-2\"}),\"Th\\u1ED1ng k\\xEA nhanh\"]})}),/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Doanh nghi\\u1EC7p\"}),/*#__PURE__*/_jsxs(Badge,{bg:\"info\",children:[customers.filter(c=>c.customer_type==='company').length,/*#__PURE__*/_jsxs(\"span\",{className:\"ms-1\",children:[\"(\",Math.round(customers.filter(c=>c.customer_type==='company').length/customers.length*100),\"%)\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"C\\xE1 nh\\xE2n\"}),/*#__PURE__*/_jsxs(Badge,{bg:\"secondary\",children:[customers.filter(c=>c.customer_type==='individual').length,/*#__PURE__*/_jsxs(\"span\",{className:\"ms-1\",children:[\"(\",Math.round(customers.filter(c=>c.customer_type==='individual').length/customers.length*100),\"%)\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"X\\u1EBFp h\\u1EA1ng A (T\\u1ED1t)\"}),/*#__PURE__*/_jsx(Badge,{bg:\"success\",children:customers.filter(c=>c.credit_rating==='A').length})]})]})]})})]}),/*#__PURE__*/_jsxs(Modal,{show:showCreateModal,onHide:()=>setShowCreateModal(false),size:\"xl\",scrollable:true,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"Th\\xEAm kh\\xE1ch h\\xE0ng m\\u1EDBi\"})}),/*#__PURE__*/_jsx(Modal.Body,{className:\"p-0\",children:/*#__PURE__*/_jsx(\"div\",{style:{maxHeight:'80vh',overflowY:'auto',padding:'1rem'},children:/*#__PURE__*/_jsx(CustomerFormTabs,{customer:null,onSave:handleSaveCustomer,onCancel:()=>setShowCreateModal(false),isLoading:formLoading})})})]}),/*#__PURE__*/_jsxs(Modal,{show:showEditModal,onHide:()=>setShowEditModal(false),size:\"xl\",scrollable:true,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"Ch\\u1EC9nh s\\u1EEDa kh\\xE1ch h\\xE0ng\"})}),/*#__PURE__*/_jsx(Modal.Body,{className:\"p-0\",children:/*#__PURE__*/_jsx(\"div\",{style:{maxHeight:'80vh',overflowY:'auto',padding:'1rem'},children:/*#__PURE__*/_jsx(CustomerFormTabs,{customer:editingCustomer,onSave:handleSaveCustomer,onCancel:()=>setShowEditModal(false),isLoading:formLoading})})})]})]});}export default Customers;","map":{"version":3,"names":["React","useState","useEffect","useCallback","Container","Row","Col","Card","Button","Table","Badge","Form","Modal","useNavigate","useAuth","useNotification","LoadingSpinner","CustomerFormTabs","customerService","jsx","_jsx","jsxs","_jsxs","Customers","navigate","hasPermission","showSuccess","showError","loading","setLoading","customers","setCustomers","filteredCustomers","setFilteredCustomers","showCreateModal","setShowCreateModal","showEditModal","setShowEditModal","editingCustomer","setEditingCustomer","formLoading","setFormLoading","pagination","setPagination","page","limit","total","pages","filters","setFilters","search","customer_type","credit_rating","loadCustomers","arguments","length","undefined","params","_objectSpread","Object","keys","forEach","key","response","getCustomers","data","error","console","warn","message","timeoutId","setTimeout","prev","clearTimeout","handleFilterChange","value","getCreditRatingBadge","rating","ratingMap","A","variant","label","B","C","D","ratingInfo","bg","children","getCustomerTypeBadge","type","formatCurrency","amount","Intl","NumberFormat","style","currency","format","replace","handleViewCustomer","customerId","concat","handleCreateCustomer","handleEditCustomer","customer","handleDeleteCustomer","window","confirm","company_name","contact_person","deleteCustomer","id","handleSaveCustomer","customerData","updateCustomer","createCustomer","totalRevenue","reduce","sum","monthly_revenue","activeCustomers","filter","c","active_contracts","averageRevenue","text","fluid","className","onClick","md","Body","Group","Label","Control","placeholder","onChange","e","target","Select","Header","hover","map","customer_code","phone","email","address","total_contracts","size","title","colSpan","Math","round","show","onHide","scrollable","closeButton","Title","maxHeight","overflowY","padding","onSave","onCancel","isLoading"],"sources":["C:/KinhDoanh/client/src/pages/Customers/index.js"],"sourcesContent":["/**\r\n * Customers Page - KHO MVG\r\n * Danh sách và quản lý khách hàng\r\n */\r\n\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport { Container, Row, Col, Card, Button, Table, Badge, Form, Modal } from 'react-bootstrap';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { useNotification } from '../../contexts/NotificationContext';\r\nimport LoadingSpinner from '../../components/Common/LoadingSpinner';\r\nimport CustomerFormTabs from '../../components/Customers/CustomerFormTabs';\r\nimport customerService from '../../services/customerService';\r\n\r\nfunction Customers() {\r\n  const navigate = useNavigate();\r\n  const { hasPermission } = useAuth();\r\n  const { showSuccess, showError } = useNotification();\r\n  \r\n  const [loading, setLoading] = useState(true);\r\n  const [customers, setCustomers] = useState([]);\r\n  const [filteredCustomers, setFilteredCustomers] = useState([]);\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n  const [showEditModal, setShowEditModal] = useState(false);\r\n  const [editingCustomer, setEditingCustomer] = useState(null);\r\n  const [formLoading, setFormLoading] = useState(false);\r\n  const [pagination, setPagination] = useState({\r\n    page: 1,\r\n    limit: 20,\r\n    total: 0,\r\n    pages: 0\r\n  });\r\n  const [filters, setFilters] = useState({\r\n    search: '',\r\n    customer_type: '',\r\n    credit_rating: ''\r\n  });\r\n\r\n  // Load customers from API\r\n  const loadCustomers = useCallback(async (page = 1) => {\r\n    try {\r\n      setLoading(true);\r\n      const params = {\r\n        page,\r\n        limit: pagination.limit,\r\n        ...filters\r\n      };\r\n\r\n      // Remove empty filters\r\n      Object.keys(params).forEach(key => {\r\n        if (!params[key]) delete params[key];\r\n      });\r\n\r\n      const response = await customerService.getCustomers(params);\r\n      \r\n      setCustomers(response.data.customers);\r\n      setFilteredCustomers(response.data.customers);\r\n      setPagination(response.data.pagination);\r\n    } catch (error) {\r\n      // showError('Không thể tải danh sách khách hàng: ' + error.message);\r\n      console.warn('Customer loading error:', error.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [filters, pagination.limit, showError]);\r\n\r\n  useEffect(() => {\r\n    if (hasPermission('customer_read')) {\r\n      loadCustomers(pagination.page);\r\n    }\r\n  }, [hasPermission, loadCustomers, pagination.page]);\r\n\r\n  useEffect(() => {\r\n    loadCustomers(pagination.page);\r\n  }, []);\r\n\r\n  // Handle filter changes\r\n  useEffect(() => {\r\n    // Debounce search to avoid too many API calls\r\n    const timeoutId = setTimeout(() => {\r\n      if (pagination.page === 1) {\r\n        loadCustomers(1);\r\n      } else {\r\n        setPagination(prev => ({ ...prev, page: 1 }));\r\n        loadCustomers(1);\r\n      }\r\n    }, 500);\r\n\r\n    return () => clearTimeout(timeoutId);\r\n  }, [filters]);\r\n\r\n  const handleFilterChange = (key, value) => {\r\n    setFilters(prev => ({\r\n      ...prev,\r\n      [key]: value\r\n    }));\r\n  };\r\n\r\n  const getCreditRatingBadge = (rating) => {\r\n    const ratingMap = {\r\n      A: { variant: 'success', label: 'A - Tốt' },\r\n      B: { variant: 'primary', label: 'B - Khá' },\r\n      C: { variant: 'warning', label: 'C - Trung bình' },\r\n      D: { variant: 'danger', label: 'D - Kém' }\r\n    };\r\n    \r\n    const ratingInfo = ratingMap[rating] || { variant: 'secondary', label: rating };\r\n    return <Badge bg={ratingInfo.variant}>{ratingInfo.label}</Badge>;\r\n  };\r\n\r\n  const getCustomerTypeBadge = (type) => {\r\n    return type === 'company' ? \r\n      <Badge bg=\"info\">Doanh nghiệp</Badge> : \r\n      <Badge bg=\"secondary\">Cá nhân</Badge>;\r\n  };\r\n\r\n  const formatCurrency = (amount) => {\r\n    return new Intl.NumberFormat('vi-VN', {\r\n      style: 'currency',\r\n      currency: 'VND'\r\n    }).format(amount).replace('₫', 'đ');\r\n  };\r\n\r\n  const handleViewCustomer = (customerId) => {\r\n    navigate(`/customers/${customerId}`);\r\n  };\r\n\r\n  const handleCreateCustomer = () => {\r\n    if (!hasPermission('customer_create')) {\r\n      showError('Bạn không có quyền tạo khách hàng mới');\r\n      return;\r\n    }\r\n    setEditingCustomer(null);\r\n    setShowCreateModal(true);\r\n  };\r\n\r\n  const handleEditCustomer = (customer) => {\r\n    if (!hasPermission('customer_update')) {\r\n      showError('Bạn không có quyền chỉnh sửa khách hàng');\r\n      return;\r\n    }\r\n    setEditingCustomer(customer);\r\n    setShowEditModal(true);\r\n  };\r\n\r\n  const handleDeleteCustomer = async (customer) => {\r\n    if (!hasPermission('customer_delete')) {\r\n      showError('Bạn không có quyền xóa khách hàng');\r\n      return;\r\n    }\r\n\r\n    if (window.confirm(`Bạn có chắc chắn muốn xóa khách hàng \"${customer.company_name || customer.contact_person}\"?`)) {\r\n      try {\r\n        await customerService.deleteCustomer(customer.id);\r\n        showSuccess('Xóa khách hàng thành công');\r\n        loadCustomers(pagination.page);\r\n      } catch (error) {\r\n        showError('Không thể xóa khách hàng: ' + error.message);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleSaveCustomer = async (customerData) => {\r\n    try {\r\n      setFormLoading(true);\r\n      \r\n      if (editingCustomer) {\r\n        await customerService.updateCustomer(editingCustomer.id, customerData);\r\n        showSuccess('Cập nhật khách hàng thành công');\r\n        setShowEditModal(false);\r\n      } else {\r\n        await customerService.createCustomer(customerData);\r\n        showSuccess('Tạo khách hàng mới thành công');\r\n        setShowCreateModal(false);\r\n      }\r\n      \r\n      setEditingCustomer(null);\r\n      loadCustomers(pagination.page);\r\n    } catch (error) {\r\n      throw error; // Let the form handle the error\r\n    } finally {\r\n      setFormLoading(false);\r\n    }\r\n  };\r\n\r\n  // const handlePageChange = (newPage) => {\r\n  //   setPagination(prev => ({ ...prev, page: newPage }));\r\n  //   loadCustomers(newPage);\r\n  // };\r\n\r\n  const totalRevenue = customers.reduce((sum, customer) => sum + customer.monthly_revenue, 0);\r\n  const activeCustomers = customers.filter(c => c.active_contracts > 0).length;\r\n  const averageRevenue = customers.length > 0 ? totalRevenue / customers.length : 0;\r\n\r\n  if (loading) {\r\n    return <LoadingSpinner text=\"Đang tải danh sách khách hàng...\" />;\r\n  }\r\n\r\n  return (\r\n    <Container fluid className=\"p-4\">\r\n      {/* Page Header */}\r\n      <Row className=\"mb-4\">\r\n        <Col>\r\n          <div className=\"d-flex justify-content-between align-items-center\">\r\n            <div>\r\n              <h2 className=\"mb-1\">Quản lý Khách hàng</h2>\r\n              <p className=\"text-muted mb-0\">\r\n                Quản lý thông tin khách hàng và hợp đồng\r\n              </p>\r\n            </div>\r\n            {hasPermission('customer_create') && (\r\n              <Button variant=\"primary\" onClick={handleCreateCustomer}>\r\n                <i className=\"fas fa-plus me-2\"></i>\r\n                Thêm khách hàng\r\n              </Button>\r\n            )}\r\n          </div>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Statistics Cards */}\r\n      <Row className=\"mb-4\">\r\n        <Col md={3} className=\"mb-3\">\r\n          <Card className=\"border-0 shadow-sm\">\r\n            <Card.Body>\r\n              <div className=\"d-flex justify-content-between align-items-center\">\r\n                <div>\r\n                  <h6 className=\"text-muted mb-1\">Tổng khách hàng</h6>\r\n                  <h4 className=\"mb-0 text-primary\">{customers.length}</h4>\r\n                </div>\r\n                <i className=\"fas fa-users fa-2x text-primary opacity-25\"></i>\r\n              </div>\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n        <Col md={3} className=\"mb-3\">\r\n          <Card className=\"border-0 shadow-sm\">\r\n            <Card.Body>\r\n              <div className=\"d-flex justify-content-between align-items-center\">\r\n                <div>\r\n                  <h6 className=\"text-muted mb-1\">Đang hoạt động</h6>\r\n                  <h4 className=\"mb-0 text-success\">{activeCustomers}</h4>\r\n                </div>\r\n                <i className=\"fas fa-user-check fa-2x text-success opacity-25\"></i>\r\n              </div>\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n        <Col md={3} className=\"mb-3\">\r\n          <Card className=\"border-0 shadow-sm\">\r\n            <Card.Body>\r\n              <div className=\"d-flex justify-content-between align-items-center\">\r\n                <div>\r\n                  <h6 className=\"text-muted mb-1\">Tổng doanh thu/tháng</h6>\r\n                  <h4 className=\"mb-0 text-warning\">{formatCurrency(totalRevenue)}</h4>\r\n                </div>\r\n                <i className=\"fas fa-chart-line fa-2x text-warning opacity-25\"></i>\r\n              </div>\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n        <Col md={3} className=\"mb-3\">\r\n          <Card className=\"border-0 shadow-sm\">\r\n            <Card.Body>\r\n              <div className=\"d-flex justify-content-between align-items-center\">\r\n                <div>\r\n                  <h6 className=\"text-muted mb-1\">TB doanh thu/KH</h6>\r\n                  <h4 className=\"mb-0 text-info\">{formatCurrency(averageRevenue)}</h4>\r\n                </div>\r\n                <i className=\"fas fa-calculator fa-2x text-info opacity-25\"></i>\r\n              </div>\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Filters */}\r\n      <Card className=\"border-0 shadow-sm mb-4\">\r\n        <Card.Body>\r\n          <Row>\r\n            <Col md={4}>\r\n              <Form.Group>\r\n                <Form.Label>Tìm kiếm</Form.Label>\r\n                <Form.Control\r\n                  type=\"text\"\r\n                  placeholder=\"Tìm theo mã, tên, SĐT, email...\"\r\n                  value={filters.search}\r\n                  onChange={(e) => handleFilterChange('search', e.target.value)}\r\n                />\r\n              </Form.Group>\r\n            </Col>\r\n            <Col md={4}>\r\n              <Form.Group>\r\n                <Form.Label>Loại khách hàng</Form.Label>\r\n                <Form.Select\r\n                  value={filters.customer_type}\r\n                  onChange={(e) => handleFilterChange('customer_type', e.target.value)}\r\n                >\r\n                  <option value=\"\">Tất cả loại</option>\r\n                  <option value=\"company\">Doanh nghiệp</option>\r\n                  <option value=\"individual\">Cá nhân</option>\r\n                </Form.Select>\r\n              </Form.Group>\r\n            </Col>\r\n            <Col md={4}>\r\n              <Form.Group>\r\n                <Form.Label>Xếp hạng tín dụng</Form.Label>\r\n                <Form.Select\r\n                  value={filters.credit_rating}\r\n                  onChange={(e) => handleFilterChange('credit_rating', e.target.value)}\r\n                >\r\n                  <option value=\"\">Tất cả xếp hạng</option>\r\n                  <option value=\"A\">A - Tốt</option>\r\n                  <option value=\"B\">B - Khá</option>\r\n                  <option value=\"C\">C - Trung bình</option>\r\n                  <option value=\"D\">D - Kém</option>\r\n                </Form.Select>\r\n              </Form.Group>\r\n            </Col>\r\n          </Row>\r\n        </Card.Body>\r\n      </Card>\r\n\r\n      {/* Customers Table */}\r\n      <Card className=\"border-0 shadow-sm\">\r\n        <Card.Header className=\"bg-white border-0\">\r\n          <h5 className=\"mb-0\">\r\n            <i className=\"fas fa-list me-2\"></i>\r\n            Danh sách khách hàng ({filteredCustomers.length})\r\n          </h5>\r\n        </Card.Header>\r\n        <Card.Body className=\"p-0\">\r\n          <div className=\"table-responsive\">\r\n            <Table hover className=\"mb-0\">\r\n              <thead className=\"bg-light\">\r\n                <tr>\r\n                  <th>Khách hàng</th>\r\n                  <th>Liên hệ</th>\r\n                  <th>Loại</th>\r\n                  <th>Xếp hạng</th>\r\n                  <th>Hợp đồng</th>\r\n                  <th>Doanh thu/tháng</th>\r\n                  <th>Thao tác</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {filteredCustomers.length > 0 ? (\r\n                  filteredCustomers.map((customer) => (\r\n                    <tr key={customer.id}>\r\n                      <td>\r\n                        <div>\r\n                          <div className=\"fw-bold\">\r\n                            {customer.company_name || customer.contact_person}\r\n                          </div>\r\n                          <small className=\"text-muted\">{customer.customer_code}</small>\r\n                          {customer.company_name && (\r\n                            <div>\r\n                              <small className=\"text-muted\">{customer.contact_person}</small>\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      </td>\r\n                      <td>\r\n                        <div>\r\n                          <div>\r\n                            <i className=\"fas fa-phone fa-sm me-1\"></i>\r\n                            {customer.phone}\r\n                          </div>\r\n                          {customer.email && (\r\n                            <div>\r\n                              <i className=\"fas fa-envelope fa-sm me-1\"></i>\r\n                              <small>{customer.email}</small>\r\n                            </div>\r\n                          )}\r\n                          <div className=\"text-muted\">\r\n                            <small>{customer.address}</small>\r\n                          </div>\r\n                        </div>\r\n                      </td>\r\n                      <td>{getCustomerTypeBadge(customer.customer_type)}</td>\r\n                      <td>{getCreditRatingBadge(customer.credit_rating)}</td>\r\n                      <td>\r\n                        <div>\r\n                          <div>\r\n                            <span className=\"fw-medium text-success\">\r\n                              {customer.active_contracts}\r\n                            </span>\r\n                            <span className=\"text-muted\">/{customer.total_contracts}</span>\r\n                          </div>\r\n                          <small className=\"text-muted\">Hiệu lực/Tổng</small>\r\n                        </div>\r\n                      </td>\r\n                      <td>\r\n                        <div className=\"fw-bold text-success\">\r\n                          {formatCurrency(customer.monthly_revenue)}\r\n                        </div>\r\n                      </td>\r\n                      <td>\r\n                        <div className=\"btn-group\">\r\n                          <Button\r\n                            variant=\"outline-primary\"\r\n                            size=\"sm\"\r\n                            onClick={() => handleViewCustomer(customer.id)}\r\n                          >\r\n                            <i className=\"fas fa-eye\"></i>\r\n                          </Button>\r\n                          {hasPermission('customer_update') && (\r\n                            <Button\r\n                              variant=\"outline-secondary\"\r\n                              size=\"sm\"\r\n                              onClick={() => handleEditCustomer(customer)}\r\n                              title=\"Chỉnh sửa\"\r\n                            >\r\n                              <i className=\"fas fa-edit\"></i>\r\n                            </Button>\r\n                          )}\r\n                          {hasPermission('customer_delete') && (\r\n                            <Button\r\n                              variant=\"outline-danger\"\r\n                              size=\"sm\"\r\n                              className=\"ms-1\"\r\n                              onClick={() => handleDeleteCustomer(customer)}\r\n                              title=\"Xóa khách hàng\"\r\n                            >\r\n                              <i className=\"fas fa-trash\"></i>\r\n                            </Button>\r\n                          )}\r\n                          {hasPermission('contract_create') && (\r\n                            <Button\r\n                              variant=\"outline-success\"\r\n                              size=\"sm\"\r\n                              onClick={() => navigate(`/contracts/create?customer=${customer.id}`)}\r\n                              title=\"Tạo hợp đồng mới\"\r\n                            >\r\n                              <i className=\"fas fa-file-contract\"></i>\r\n                            </Button>\r\n                          )}\r\n                        </div>\r\n                      </td>\r\n                    </tr>\r\n                  ))\r\n                ) : (\r\n                  <tr>\r\n                    <td colSpan={7} className=\"text-center py-4\">\r\n                      <div className=\"text-muted\">\r\n                        <i className=\"fas fa-search fa-2x mb-3\"></i>\r\n                        <p>Không tìm thấy khách hàng nào phù hợp với bộ lọc</p>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                )}\r\n              </tbody>\r\n            </Table>\r\n          </div>\r\n        </Card.Body>\r\n      </Card>\r\n\r\n      {/* Quick Actions */}\r\n      <Row className=\"mt-4\">\r\n        <Col md={6}>\r\n          <Card className=\"border-0 shadow-sm\">\r\n            <Card.Header className=\"bg-white border-0\">\r\n              <h6 className=\"mb-0\">\r\n                <i className=\"fas fa-exclamation-triangle text-warning me-2\"></i>\r\n                Khách hàng cần chú ý\r\n              </h6>\r\n            </Card.Header>\r\n            <Card.Body>\r\n              <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n                <span>Xếp hạng D (Kém)</span>\r\n                <Badge bg=\"danger\">{customers.filter(c => c.credit_rating === 'D').length}</Badge>\r\n              </div>\r\n              <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n                <span>Không có hợp đồng hiệu lực</span>\r\n                <Badge bg=\"warning\">{customers.filter(c => c.active_contracts === 0).length}</Badge>\r\n              </div>\r\n              <div className=\"d-flex justify-content-between align-items-center\">\r\n                <span>Doanh thu = 0</span>\r\n                <Badge bg=\"secondary\">{customers.filter(c => c.monthly_revenue === 0).length}</Badge>\r\n              </div>\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n        \r\n        <Col md={6}>\r\n          <Card className=\"border-0 shadow-sm\">\r\n            <Card.Header className=\"bg-white border-0\">\r\n              <h6 className=\"mb-0\">\r\n                <i className=\"fas fa-chart-pie text-info me-2\"></i>\r\n                Thống kê nhanh\r\n              </h6>\r\n            </Card.Header>\r\n            <Card.Body>\r\n              <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n                <span>Doanh nghiệp</span>\r\n                <Badge bg=\"info\">\r\n                  {customers.filter(c => c.customer_type === 'company').length}\r\n                  <span className=\"ms-1\">\r\n                    ({Math.round(customers.filter(c => c.customer_type === 'company').length / customers.length * 100)}%)\r\n                  </span>\r\n                </Badge>\r\n              </div>\r\n              <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n                <span>Cá nhân</span>\r\n                <Badge bg=\"secondary\">\r\n                  {customers.filter(c => c.customer_type === 'individual').length}\r\n                  <span className=\"ms-1\">\r\n                    ({Math.round(customers.filter(c => c.customer_type === 'individual').length / customers.length * 100)}%)\r\n                  </span>\r\n                </Badge>\r\n              </div>\r\n              <div className=\"d-flex justify-content-between align-items-center\">\r\n                <span>Xếp hạng A (Tốt)</span>\r\n                <Badge bg=\"success\">{customers.filter(c => c.credit_rating === 'A').length}</Badge>\r\n              </div>\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Create Customer Modal */}\r\n      <Modal show={showCreateModal} onHide={() => setShowCreateModal(false)} size=\"xl\" scrollable>\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Thêm khách hàng mới</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body className=\"p-0\">\r\n          <div style={{ maxHeight: '80vh', overflowY: 'auto', padding: '1rem' }}>\r\n            <CustomerFormTabs\r\n              customer={null}\r\n              onSave={handleSaveCustomer}\r\n              onCancel={() => setShowCreateModal(false)}\r\n              isLoading={formLoading}\r\n            />\r\n          </div>\r\n        </Modal.Body>\r\n      </Modal>\r\n\r\n      {/* Edit Customer Modal */}\r\n      <Modal show={showEditModal} onHide={() => setShowEditModal(false)} size=\"xl\" scrollable>\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Chỉnh sửa khách hàng</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body className=\"p-0\">\r\n          <div style={{ maxHeight: '80vh', overflowY: 'auto', padding: '1rem' }}>\r\n            <CustomerFormTabs\r\n              customer={editingCustomer}\r\n              onSave={handleSaveCustomer}\r\n              onCancel={() => setShowEditModal(false)}\r\n              isLoading={formLoading}\r\n            />\r\n          </div>\r\n        </Modal.Body>\r\n      </Modal>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default Customers;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}