{"ast":null,"code":"import _objectSpread from\"C:/Users/Admin/Documents/GitHub/MVG_InventoryManagement/KinhDoanh/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";/**\r\n * User Management Page - KHO MVG\r\n * Phân hệ 2.4 - Quản lý User nâng cao\r\n */import React,{useState,useEffect,useCallback}from'react';import{Container,Row,Col,Card,Button,Table,Badge,Form,Modal,Alert,Tab,Nav}from'react-bootstrap';import{useAuth}from'../../contexts/AuthContext';import{useNotification}from'../../contexts/NotificationContext';import LoadingSpinner from'../../components/Common/LoadingSpinner';import PermissionManager from'../../components/Users/PermissionManager';import AIConfigManager from'../../components/Users/AIConfigManagerComplete';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function UserManagement(){var _selectedUser$project,_selectedUser$ai_conf,_selectedUser$user,_selectedUser$user2;const{isAdmin,hasPermission}=useAuth();const{showSuccess,showError}=useNotification();const[loading,setLoading]=useState(true);const[users,setUsers]=useState([]);const[selectedUser,setSelectedUser]=useState(null);const[showUserModal,setShowUserModal]=useState(false);const[showPermissionModal,setShowPermissionModal]=useState(false);const[showAIConfigModal,setShowAIConfigModal]=useState(false);// const [showActivityModal, setShowActivityModal] = useState(false);\nconst[activeTab,setActiveTab]=useState('list');// Filter states\nconst[filters,setFilters]=useState({search:'',role:'',page:1,limit:20});useEffect(()=>{if(hasPermission('user_view')||isAdmin()){loadUsers();}},[filters]);const loadUsers=useCallback(async()=>{try{setLoading(true);const token=localStorage.getItem('token');console.log('Loading users with token:',token?'Present':'Missing');console.log('Filters:',filters);const response=await axios.get('/api/users',{params:filters,headers:{'Authorization':\"Bearer \".concat(token)}});console.log('Users API response:',response.data);if(response.data.success){setUsers(response.data.data.users||[]);}else{throw new Error(response.data.message||'Failed to load users');}}catch(error){var _error$response,_error$response$data;console.error('Error loading users:',error);showError(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||error.message||'Lỗi tải danh sách người dùng');setUsers([]);}finally{setLoading(false);}},[filters,showError]);useEffect(()=>{if(hasPermission('user_read')||isAdmin){loadUsers();}},[hasPermission,isAdmin,loadUsers]);const handleViewUser=async userId=>{try{const token=localStorage.getItem('token');console.log('Viewing user:',userId);const response=await axios.get(\"/api/users/\".concat(userId),{headers:{'Authorization':\"Bearer \".concat(token)}});console.log('User details response:',response.data);setSelectedUser(response.data.data||response.data.user);setShowUserModal(true);}catch(error){var _error$response2,_error$response2$data;console.error('Error viewing user:',error);showError(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'Lỗi tải thông tin người dùng');}};const handleShowPermissions=async userId=>{try{const token=localStorage.getItem('token');console.log('Loading permissions for user:',userId);// Get user info first\nconst response=await axios.get(\"/api/users/\".concat(userId),{headers:{'Authorization':\"Bearer \".concat(token)}});console.log('User permissions response:',response.data);if(response.data.success){const userData=response.data.data;console.log('Setting selected user data:',userData);setSelectedUser(userData);setShowPermissionModal(true);}else{throw new Error('Failed to load user data');}}catch(error){var _error$response3,_error$response3$data;console.error('Error loading user permissions:',error);showError(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.message)||'Lỗi tải quyền hạn người dùng');}};const handleShowAIConfigs=async userId=>{try{const token=localStorage.getItem('token');console.log('Loading AI configs for user:',userId);// Get user info first\nconst userResponse=await axios.get(\"/api/users/\".concat(userId),{headers:{'Authorization':\"Bearer \".concat(token)}});// Then try to get AI configs\ntry{const aiResponse=await axios.get(\"/api/ai-assistant/user-configs\",{params:{user_id:userId},headers:{'Authorization':\"Bearer \".concat(token)}});setSelectedUser(_objectSpread(_objectSpread({},userResponse.data.data),{},{ai_configurations:aiResponse.data.data||[]}));}catch(aiError){console.log('AI configs endpoint not found, using basic user data');setSelectedUser(userResponse.data.data);}setShowAIConfigModal(true);}catch(error){var _error$response4,_error$response4$data;console.error('Error loading AI configs:',error);showError(((_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.message)||'Lỗi tải cấu hình AI');}};const handleShowActivity=async userId=>{try{const response=await axios.get(\"/api/users/\".concat(userId,\"/activity-logs\"));setSelectedUser(prev=>_objectSpread(_objectSpread({},prev),{},{activity_logs:response.data.data.logs}));// setShowActivityModal(true);\n}catch(error){showError('Lỗi tải lịch sử hoạt động');}};// Add AI configuration for user\n// const handleAddAIConfig = async (userId, configData) => {\n//   try {\n//     await axios.post(`/api/users/${userId}/ai-configs`, configData);\n//     showSuccess('Thêm cấu hình AI thành công');\n//     handleShowAIConfigs(userId); // Refresh configs\n//   } catch (error) {\n//     showError(error.response?.data?.message || 'Lỗi thêm cấu hình AI');\n//   }\n// };\nconst getRoleBadge=role=>{const roleMap={admin:{variant:'danger',label:'Admin'},manager:{variant:'success',label:'Manager'},staff:{variant:'primary',label:'Staff'},viewer:{variant:'secondary',label:'Viewer'}};const roleInfo=roleMap[role]||{variant:'secondary',label:role};return/*#__PURE__*/_jsx(Badge,{bg:roleInfo.variant,children:roleInfo.label});};const getStatusBadge=isActive=>{return isActive?/*#__PURE__*/_jsx(Badge,{bg:\"success\",children:\"Ho\\u1EA1t \\u0111\\u1ED9ng\"}):/*#__PURE__*/_jsx(Badge,{bg:\"secondary\",children:\"V\\xF4 hi\\u1EC7u h\\xF3a\"});};if(loading){return/*#__PURE__*/_jsx(LoadingSpinner,{text:\"\\u0110ang t\\u1EA3i danh s\\xE1ch ng\\u01B0\\u1EDDi d\\xF9ng...\"});}if(!isAdmin()&&!hasPermission('user_view')){return/*#__PURE__*/_jsx(Container,{className:\"mt-5\",children:/*#__PURE__*/_jsxs(Alert,{variant:\"danger\",className:\"text-center\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Kh\\xF4ng c\\xF3 quy\\u1EC1n truy c\\u1EADp\"}),/*#__PURE__*/_jsx(\"p\",{children:\"B\\u1EA1n kh\\xF4ng c\\xF3 quy\\u1EC1n qu\\u1EA3n l\\xFD ng\\u01B0\\u1EDDi d\\xF9ng.\"})]})});}return/*#__PURE__*/_jsxs(Container,{fluid:true,className:\"p-4\",children:[/*#__PURE__*/_jsx(Row,{className:\"mb-4\",children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"mb-1\",children:\"Qu\\u1EA3n l\\xFD Ng\\u01B0\\u1EDDi d\\xF9ng\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-0\",children:\"Ph\\xE2n h\\u1EC7 2.4 - Qu\\u1EA3n l\\xFD ng\\u01B0\\u1EDDi d\\xF9ng v\\xE0 ph\\xE2n quy\\u1EC1n n\\xE2ng cao\"})]}),hasPermission('user_create')&&/*#__PURE__*/_jsxs(Button,{variant:\"primary\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-plus me-2\"}),\"Th\\xEAm ng\\u01B0\\u1EDDi d\\xF9ng\"]})]})})}),/*#__PURE__*/_jsxs(Card,{className:\"border-0 shadow-sm\",children:[/*#__PURE__*/_jsx(Card.Header,{className:\"bg-white border-0\",children:/*#__PURE__*/_jsxs(Nav,{variant:\"tabs\",className:\"border-0\",activeKey:activeTab,onSelect:setActiveTab,children:[/*#__PURE__*/_jsx(Nav.Item,{children:/*#__PURE__*/_jsxs(Nav.Link,{eventKey:\"list\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-users me-2\"}),\"Danh s\\xE1ch ng\\u01B0\\u1EDDi d\\xF9ng\"]})}),isAdmin()&&/*#__PURE__*/_jsx(Nav.Item,{children:/*#__PURE__*/_jsxs(Nav.Link,{eventKey:\"activity\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-history me-2\"}),\"L\\u1ECBch s\\u1EED ho\\u1EA1t \\u0111\\u1ED9ng\"]})}),/*#__PURE__*/_jsx(Nav.Item,{children:/*#__PURE__*/_jsxs(Nav.Link,{eventKey:\"ai-stats\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-robot me-2\"}),\"Th\\u1ED1ng k\\xEA AI\"]})})]})}),/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(Tab.Content,{children:[/*#__PURE__*/_jsxs(Tab.Pane,{eventKey:\"list\",className:activeTab==='list'?'show active':'',children:[/*#__PURE__*/_jsxs(Row,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"T\\xECm ki\\u1EBFm ng\\u01B0\\u1EDDi d\\xF9ng...\",value:filters.search,onChange:e=>setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{search:e.target.value}))})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(Form.Select,{value:filters.role,onChange:e=>setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{role:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"T\\u1EA5t c\\u1EA3 vai tr\\xF2\"}),/*#__PURE__*/_jsx(\"option\",{value:\"admin\",children:\"Admin\"}),/*#__PURE__*/_jsx(\"option\",{value:\"manager\",children:\"Manager\"}),/*#__PURE__*/_jsx(\"option\",{value:\"staff\",children:\"Staff\"}),/*#__PURE__*/_jsx(\"option\",{value:\"viewer\",children:\"Viewer\"})]})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(Button,{variant:\"outline-secondary\",onClick:()=>setFilters({search:'',role:'',page:1,limit:20}),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-times me-2\"}),\"X\\xF3a b\\u1ED9 l\\u1ECDc\"]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(Table,{hover:true,children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-light\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Ng\\u01B0\\u1EDDi d\\xF9ng\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Vai tr\\xF2\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Tr\\u1EA1ng th\\xE1i\"}),/*#__PURE__*/_jsx(\"th\",{children:\"D\\u1EF1 \\xE1n \\u0111\\u01B0\\u1EE3c g\\xE1n\"}),/*#__PURE__*/_jsx(\"th\",{children:\"AI Configs\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Ho\\u1EA1t \\u0111\\u1ED9ng cu\\u1ED1i\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Thao t\\xE1c\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:users.map(userItem=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"fw-bold\",children:userItem.full_name}),/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[userItem.username,\" \\u2022 \",userItem.email]})]})}),/*#__PURE__*/_jsx(\"td\",{children:getRoleBadge(userItem.role)}),/*#__PURE__*/_jsx(\"td\",{children:getStatusBadge(userItem.is_active)}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Badge,{bg:\"info\",children:userItem.assigned_projects||0})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Badge,{bg:\"warning\",children:userItem.ai_configs_count||0})}),/*#__PURE__*/_jsx(\"td\",{children:userItem.last_activity?new Date(userItem.last_activity).toLocaleDateString('vi-VN'):'Chưa có'}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"btn-group\",children:[/*#__PURE__*/_jsx(Button,{variant:\"outline-primary\",size:\"sm\",onClick:()=>handleViewUser(userItem.id),children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-eye\"})}),hasPermission('user_permissions_manage')&&/*#__PURE__*/_jsx(Button,{variant:\"outline-success\",size:\"sm\",onClick:()=>handleShowPermissions(userItem.id),title:\"Qu\\u1EA3n l\\xFD quy\\u1EC1n h\\u1EA1n\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-key\"})}),hasPermission('user_ai_manage')&&/*#__PURE__*/_jsx(Button,{variant:\"outline-warning\",size:\"sm\",onClick:()=>handleShowAIConfigs(userItem.id),title:\"C\\u1EA5u h\\xECnh AI\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-robot\"})}),(isAdmin()||hasPermission('user_logs_view'))&&/*#__PURE__*/_jsx(Button,{variant:\"outline-info\",size:\"sm\",onClick:()=>handleShowActivity(userItem.id),title:\"L\\u1ECBch s\\u1EED ho\\u1EA1t \\u0111\\u1ED9ng\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-history\"})})]})})]},userItem.id))})]})})]}),isAdmin()&&/*#__PURE__*/_jsx(Tab.Pane,{eventKey:\"activity\",className:activeTab==='activity'?'show active':'',children:/*#__PURE__*/_jsxs(Alert,{variant:\"info\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-info-circle me-2\"}),\"T\\xEDnh n\\u0103ng xem l\\u1ECBch s\\u1EED ho\\u1EA1t \\u0111\\u1ED9ng t\\u1ED5ng h\\u1EE3p s\\u1EBD \\u0111\\u01B0\\u1EE3c tri\\u1EC3n khai \\u1EDF component ri\\xEAng\"]})}),/*#__PURE__*/_jsxs(Tab.Pane,{eventKey:\"ai-stats\",className:activeTab==='ai-stats'?'show active':'',children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm text-center\",children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-users fa-2x text-primary mb-2\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"mb-1\",children:users.filter(u=>u.ai_configs_count>0).length}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-0\",children:\"Users c\\xF3 AI config\"})]})})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm text-center\",children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-robot fa-2x text-success mb-2\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"mb-1\",children:users.reduce((sum,u)=>sum+(u.ai_configs_count||0),0)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-0\",children:\"T\\u1ED5ng AI configs\"})]})})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm text-center\",children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-chart-line fa-2x text-warning mb-2\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"mb-1\",children:\"$0.00\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-0\",children:\"Chi ph\\xED AI th\\xE1ng n\\xE0y\"})]})})})]}),/*#__PURE__*/_jsxs(Card,{className:\"mt-4\",children:[/*#__PURE__*/_jsx(Card.Header,{children:/*#__PURE__*/_jsx(\"h6\",{className:\"mb-0\",children:\"Ph\\xE2n b\\u1ED1 AI Providers\"})}),/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsx(Alert,{variant:\"info\",children:\"Chart th\\u1ED1ng k\\xEA AI providers s\\u1EBD \\u0111\\u01B0\\u1EE3c tri\\u1EC3n khai v\\u1EDBi d\\u1EEF li\\u1EC7u th\\u1EF1c t\\u1EBF\"})})]})]})]})})]}),/*#__PURE__*/_jsxs(Modal,{show:showUserModal,onHide:()=>setShowUserModal(false),size:\"lg\",children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"Chi ti\\u1EBFt ng\\u01B0\\u1EDDi d\\xF9ng\"})}),/*#__PURE__*/_jsx(Modal.Body,{children:selectedUser&&/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{md:6,children:[/*#__PURE__*/_jsx(\"h6\",{children:\"Th\\xF4ng tin c\\u01A1 b\\u1EA3n\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-group\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"T\\xEAn:\"}),\" \",selectedUser.user.full_name]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Username:\"}),\" \",selectedUser.user.username]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email:\"}),\" \",selectedUser.user.email]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Vai tr\\xF2:\"}),\" \",getRoleBadge(selectedUser.user.role)]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Tr\\u1EA1ng th\\xE1i:\"}),\" \",getStatusBadge(selectedUser.user.is_active)]})]})]}),/*#__PURE__*/_jsxs(Col,{md:6,children:[/*#__PURE__*/_jsx(\"h6\",{children:\"Th\\u1ED1ng k\\xEA\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-group\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"D\\u1EF1 \\xE1n \\u0111\\u01B0\\u1EE3c g\\xE1n:\"}),\" \",((_selectedUser$project=selectedUser.project_permissions)===null||_selectedUser$project===void 0?void 0:_selectedUser$project.length)||0]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"AI Configs:\"}),\" \",((_selectedUser$ai_conf=selectedUser.ai_configurations)===null||_selectedUser$ai_conf===void 0?void 0:_selectedUser$ai_conf.length)||0]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Ng\\xE0y t\\u1EA1o:\"}),\" \",new Date(selectedUser.user.created_at).toLocaleDateString('vi-VN')]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0110\\u0103ng nh\\u1EADp cu\\u1ED1i:\"}),\" \",selectedUser.user.last_login?new Date(selectedUser.user.last_login).toLocaleDateString('vi-VN'):'Chưa có']})]})]})]})}),/*#__PURE__*/_jsx(Modal.Footer,{children:/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>setShowUserModal(false),children:\"\\u0110\\xF3ng\"})})]}),/*#__PURE__*/_jsx(AIConfigManager,{user:selectedUser,userId:(selectedUser===null||selectedUser===void 0?void 0:(_selectedUser$user=selectedUser.user)===null||_selectedUser$user===void 0?void 0:_selectedUser$user.id)||(selectedUser===null||selectedUser===void 0?void 0:selectedUser.id),show:showAIConfigModal,onHide:()=>{setShowAIConfigModal(false);setSelectedUser(null);},onSave:()=>{loadUsers();showSuccess('Cấu hình AI đã được cập nhật thành công!');}}),/*#__PURE__*/_jsx(PermissionManager,{user:selectedUser,userId:(selectedUser===null||selectedUser===void 0?void 0:(_selectedUser$user2=selectedUser.user)===null||_selectedUser$user2===void 0?void 0:_selectedUser$user2.id)||(selectedUser===null||selectedUser===void 0?void 0:selectedUser.id),show:showPermissionModal,onHide:()=>{setShowPermissionModal(false);setSelectedUser(null);},onSave:()=>{loadUsers();showSuccess('Cập nhật quyền hạn thành công!');}})]});}export default UserManagement;","map":{"version":3,"names":["React","useState","useEffect","useCallback","Container","Row","Col","Card","Button","Table","Badge","Form","Modal","Alert","Tab","Nav","useAuth","useNotification","LoadingSpinner","PermissionManager","AIConfigManager","axios","jsx","_jsx","jsxs","_jsxs","UserManagement","_selectedUser$project","_selectedUser$ai_conf","_selectedUser$user","_selectedUser$user2","isAdmin","hasPermission","showSuccess","showError","loading","setLoading","users","setUsers","selectedUser","setSelectedUser","showUserModal","setShowUserModal","showPermissionModal","setShowPermissionModal","showAIConfigModal","setShowAIConfigModal","activeTab","setActiveTab","filters","setFilters","search","role","page","limit","loadUsers","token","localStorage","getItem","console","log","response","get","params","headers","concat","data","success","Error","message","error","_error$response","_error$response$data","handleViewUser","userId","user","_error$response2","_error$response2$data","handleShowPermissions","userData","_error$response3","_error$response3$data","handleShowAIConfigs","userResponse","aiResponse","user_id","_objectSpread","ai_configurations","aiError","_error$response4","_error$response4$data","handleShowActivity","prev","activity_logs","logs","getRoleBadge","roleMap","admin","variant","label","manager","staff","viewer","roleInfo","bg","children","getStatusBadge","isActive","text","className","fluid","Header","activeKey","onSelect","Item","Link","eventKey","Body","Content","Pane","md","Control","type","placeholder","value","onChange","e","target","Select","onClick","hover","map","userItem","full_name","username","email","is_active","assigned_projects","ai_configs_count","last_activity","Date","toLocaleDateString","size","id","title","filter","u","length","reduce","sum","show","onHide","closeButton","Title","project_permissions","created_at","last_login","Footer","onSave"],"sources":["C:/Users/Admin/Documents/GitHub/MVG_InventoryManagement/KinhDoanh/client/src/pages/Users/UserManagement.js"],"sourcesContent":["/**\r\n * User Management Page - KHO MVG\r\n * Phân hệ 2.4 - Quản lý User nâng cao\r\n */\r\n\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport { Container, Row, Col, Card, Button, Table, Badge, Form, Modal, Alert, Tab, Nav } from 'react-bootstrap';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { useNotification } from '../../contexts/NotificationContext';\r\nimport LoadingSpinner from '../../components/Common/LoadingSpinner';\r\nimport PermissionManager from '../../components/Users/PermissionManager';\r\nimport AIConfigManager from '../../components/Users/AIConfigManagerComplete';\r\nimport axios from 'axios';\r\n\r\nfunction UserManagement() {\r\n  const { isAdmin, hasPermission } = useAuth();\r\n  const { showSuccess, showError } = useNotification();\r\n  \r\n  const [loading, setLoading] = useState(true);\r\n  const [users, setUsers] = useState([]);\r\n  const [selectedUser, setSelectedUser] = useState(null);\r\n  const [showUserModal, setShowUserModal] = useState(false);\r\n  const [showPermissionModal, setShowPermissionModal] = useState(false);\r\n  const [showAIConfigModal, setShowAIConfigModal] = useState(false);\r\n  // const [showActivityModal, setShowActivityModal] = useState(false);\r\n  const [activeTab, setActiveTab] = useState('list');\r\n\r\n  // Filter states\r\n  const [filters, setFilters] = useState({\r\n    search: '',\r\n    role: '',\r\n    page: 1,\r\n    limit: 20\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (hasPermission('user_view') || isAdmin()) {\r\n      loadUsers();\r\n    }\r\n  }, [filters]);\r\n\r\n  const loadUsers = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      const token = localStorage.getItem('token');\r\n      console.log('Loading users with token:', token ? 'Present' : 'Missing');\r\n      console.log('Filters:', filters);\r\n      \r\n      const response = await axios.get('/api/users', { \r\n        params: filters,\r\n        headers: { 'Authorization': `Bearer ${token}` }\r\n      });\r\n      \r\n      console.log('Users API response:', response.data);\r\n      \r\n      if (response.data.success) {\r\n        setUsers(response.data.data.users || []);\r\n      } else {\r\n        throw new Error(response.data.message || 'Failed to load users');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading users:', error);\r\n      showError(error.response?.data?.message || error.message || 'Lỗi tải danh sách người dùng');\r\n      setUsers([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [filters, showError]);\r\n\r\n  useEffect(() => {\r\n    if (hasPermission('user_read') || isAdmin) {\r\n      loadUsers();\r\n    }\r\n  }, [hasPermission, isAdmin, loadUsers]);\r\n\r\n  const handleViewUser = async (userId) => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      console.log('Viewing user:', userId);\r\n      \r\n      const response = await axios.get(`/api/users/${userId}`, {\r\n        headers: { 'Authorization': `Bearer ${token}` }\r\n      });\r\n      \r\n      console.log('User details response:', response.data);\r\n      \r\n      setSelectedUser(response.data.data || response.data.user);\r\n      setShowUserModal(true);\r\n    } catch (error) {\r\n      console.error('Error viewing user:', error);\r\n      showError(error.response?.data?.message || 'Lỗi tải thông tin người dùng');\r\n    }\r\n  };\r\n\r\n  const handleShowPermissions = async (userId) => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      console.log('Loading permissions for user:', userId);\r\n      \r\n      // Get user info first\r\n      const response = await axios.get(`/api/users/${userId}`, {\r\n        headers: { 'Authorization': `Bearer ${token}` }\r\n      });\r\n      \r\n      console.log('User permissions response:', response.data);\r\n      \r\n      if (response.data.success) {\r\n        const userData = response.data.data;\r\n        console.log('Setting selected user data:', userData);\r\n        setSelectedUser(userData);\r\n        setShowPermissionModal(true);\r\n      } else {\r\n        throw new Error('Failed to load user data');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading user permissions:', error);\r\n      showError(error.response?.data?.message || 'Lỗi tải quyền hạn người dùng');\r\n    }\r\n  };\r\n\r\n  const handleShowAIConfigs = async (userId) => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      console.log('Loading AI configs for user:', userId);\r\n      \r\n      // Get user info first\r\n      const userResponse = await axios.get(`/api/users/${userId}`, {\r\n        headers: { 'Authorization': `Bearer ${token}` }\r\n      });\r\n      \r\n      // Then try to get AI configs\r\n      try {\r\n        const aiResponse = await axios.get(`/api/ai-assistant/user-configs`, {\r\n          params: { user_id: userId },\r\n          headers: { 'Authorization': `Bearer ${token}` }\r\n        });\r\n        \r\n        setSelectedUser({\r\n          ...userResponse.data.data,\r\n          ai_configurations: aiResponse.data.data || []\r\n        });\r\n      } catch (aiError) {\r\n        console.log('AI configs endpoint not found, using basic user data');\r\n        setSelectedUser(userResponse.data.data);\r\n      }\r\n      \r\n      setShowAIConfigModal(true);\r\n    } catch (error) {\r\n      console.error('Error loading AI configs:', error);\r\n      showError(error.response?.data?.message || 'Lỗi tải cấu hình AI');\r\n    }\r\n  };\r\n\r\n  const handleShowActivity = async (userId) => {\r\n    try {\r\n      const response = await axios.get(`/api/users/${userId}/activity-logs`);\r\n      setSelectedUser(prev => ({\r\n        ...prev,\r\n        activity_logs: response.data.data.logs\r\n      }));\r\n      // setShowActivityModal(true);\r\n    } catch (error) {\r\n      showError('Lỗi tải lịch sử hoạt động');\r\n    }\r\n  };\r\n\r\n  // Add AI configuration for user\r\n  // const handleAddAIConfig = async (userId, configData) => {\r\n  //   try {\r\n  //     await axios.post(`/api/users/${userId}/ai-configs`, configData);\r\n  //     showSuccess('Thêm cấu hình AI thành công');\r\n  //     handleShowAIConfigs(userId); // Refresh configs\r\n  //   } catch (error) {\r\n  //     showError(error.response?.data?.message || 'Lỗi thêm cấu hình AI');\r\n  //   }\r\n  // };\r\n\r\n  const getRoleBadge = (role) => {\r\n    const roleMap = {\r\n      admin: { variant: 'danger', label: 'Admin' },\r\n      manager: { variant: 'success', label: 'Manager' },\r\n      staff: { variant: 'primary', label: 'Staff' },\r\n      viewer: { variant: 'secondary', label: 'Viewer' }\r\n    };\r\n    \r\n    const roleInfo = roleMap[role] || { variant: 'secondary', label: role };\r\n    return <Badge bg={roleInfo.variant}>{roleInfo.label}</Badge>;\r\n  };\r\n\r\n  const getStatusBadge = (isActive) => {\r\n    return isActive ? \r\n      <Badge bg=\"success\">Hoạt động</Badge> : \r\n      <Badge bg=\"secondary\">Vô hiệu hóa</Badge>;\r\n  };\r\n\r\n  if (loading) {\r\n    return <LoadingSpinner text=\"Đang tải danh sách người dùng...\" />;\r\n  }\r\n\r\n  if (!isAdmin() && !hasPermission('user_view')) {\r\n    return (\r\n      <Container className=\"mt-5\">\r\n        <Alert variant=\"danger\" className=\"text-center\">\r\n          <h4>Không có quyền truy cập</h4>\r\n          <p>Bạn không có quyền quản lý người dùng.</p>\r\n        </Alert>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Container fluid className=\"p-4\">\r\n      {/* Page Header */}\r\n      <Row className=\"mb-4\">\r\n        <Col>\r\n          <div className=\"d-flex justify-content-between align-items-center\">\r\n            <div>\r\n              <h2 className=\"mb-1\">Quản lý Người dùng</h2>\r\n              <p className=\"text-muted mb-0\">\r\n                Phân hệ 2.4 - Quản lý người dùng và phân quyền nâng cao\r\n              </p>\r\n            </div>\r\n            {hasPermission('user_create') && (\r\n              <Button variant=\"primary\">\r\n                <i className=\"fas fa-plus me-2\"></i>\r\n                Thêm người dùng\r\n              </Button>\r\n            )}\r\n          </div>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Tabs */}\r\n      <Card className=\"border-0 shadow-sm\">\r\n        <Card.Header className=\"bg-white border-0\">\r\n          <Nav variant=\"tabs\" className=\"border-0\" activeKey={activeTab} onSelect={setActiveTab}>\r\n            <Nav.Item>\r\n              <Nav.Link eventKey=\"list\">\r\n                <i className=\"fas fa-users me-2\"></i>\r\n                Danh sách người dùng\r\n              </Nav.Link>\r\n            </Nav.Item>\r\n            {isAdmin() && (\r\n              <Nav.Item>\r\n                <Nav.Link eventKey=\"activity\">\r\n                  <i className=\"fas fa-history me-2\"></i>\r\n                  Lịch sử hoạt động\r\n                </Nav.Link>\r\n              </Nav.Item>\r\n            )}\r\n            <Nav.Item>\r\n              <Nav.Link eventKey=\"ai-stats\">\r\n                <i className=\"fas fa-robot me-2\"></i>\r\n                Thống kê AI\r\n              </Nav.Link>\r\n            </Nav.Item>\r\n          </Nav>\r\n        </Card.Header>\r\n\r\n        <Card.Body>\r\n          <Tab.Content>\r\n            {/* User List Tab */}\r\n            <Tab.Pane eventKey=\"list\" className={activeTab === 'list' ? 'show active' : ''}>\r\n              {/* Filters */}\r\n              <Row className=\"mb-3\">\r\n                <Col md={4}>\r\n                  <Form.Control\r\n                    type=\"text\"\r\n                    placeholder=\"Tìm kiếm người dùng...\"\r\n                    value={filters.search}\r\n                    onChange={(e) => setFilters(prev => ({ ...prev, search: e.target.value }))}\r\n                  />\r\n                </Col>\r\n                <Col md={3}>\r\n                  <Form.Select\r\n                    value={filters.role}\r\n                    onChange={(e) => setFilters(prev => ({ ...prev, role: e.target.value }))}\r\n                  >\r\n                    <option value=\"\">Tất cả vai trò</option>\r\n                    <option value=\"admin\">Admin</option>\r\n                    <option value=\"manager\">Manager</option>\r\n                    <option value=\"staff\">Staff</option>\r\n                    <option value=\"viewer\">Viewer</option>\r\n                  </Form.Select>\r\n                </Col>\r\n                <Col md={3}>\r\n                  <Button variant=\"outline-secondary\" onClick={() => setFilters({ search: '', role: '', page: 1, limit: 20 })}>\r\n                    <i className=\"fas fa-times me-2\"></i>\r\n                    Xóa bộ lọc\r\n                  </Button>\r\n                </Col>\r\n              </Row>\r\n\r\n              {/* Users Table */}\r\n              <div className=\"table-responsive\">\r\n                <Table hover>\r\n                  <thead className=\"bg-light\">\r\n                    <tr>\r\n                      <th>Người dùng</th>\r\n                      <th>Vai trò</th>\r\n                      <th>Trạng thái</th>\r\n                      <th>Dự án được gán</th>\r\n                      <th>AI Configs</th>\r\n                      <th>Hoạt động cuối</th>\r\n                      <th>Thao tác</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {users.map((userItem) => (\r\n                      <tr key={userItem.id}>\r\n                        <td>\r\n                          <div>\r\n                            <div className=\"fw-bold\">{userItem.full_name}</div>\r\n                            <small className=\"text-muted\">\r\n                              {userItem.username} • {userItem.email}\r\n                            </small>\r\n                          </div>\r\n                        </td>\r\n                        <td>{getRoleBadge(userItem.role)}</td>\r\n                        <td>{getStatusBadge(userItem.is_active)}</td>\r\n                        <td>\r\n                          <Badge bg=\"info\">{userItem.assigned_projects || 0}</Badge>\r\n                        </td>\r\n                        <td>\r\n                          <Badge bg=\"warning\">{userItem.ai_configs_count || 0}</Badge>\r\n                        </td>\r\n                        <td>\r\n                          {userItem.last_activity ? \r\n                            new Date(userItem.last_activity).toLocaleDateString('vi-VN') : \r\n                            'Chưa có'\r\n                          }\r\n                        </td>\r\n                        <td>\r\n                          <div className=\"btn-group\">\r\n                            <Button\r\n                              variant=\"outline-primary\"\r\n                              size=\"sm\"\r\n                              onClick={() => handleViewUser(userItem.id)}\r\n                            >\r\n                              <i className=\"fas fa-eye\"></i>\r\n                            </Button>\r\n                            \r\n                            {hasPermission('user_permissions_manage') && (\r\n                              <Button\r\n                                variant=\"outline-success\"\r\n                                size=\"sm\"\r\n                                onClick={() => handleShowPermissions(userItem.id)}\r\n                                title=\"Quản lý quyền hạn\"\r\n                              >\r\n                                <i className=\"fas fa-key\"></i>\r\n                              </Button>\r\n                            )}\r\n                            \r\n                            {hasPermission('user_ai_manage') && (\r\n                              <Button\r\n                                variant=\"outline-warning\"\r\n                                size=\"sm\"\r\n                                onClick={() => handleShowAIConfigs(userItem.id)}\r\n                                title=\"Cấu hình AI\"\r\n                              >\r\n                                <i className=\"fas fa-robot\"></i>\r\n                              </Button>\r\n                            )}\r\n                            \r\n                            {(isAdmin() || hasPermission('user_logs_view')) && (\r\n                              <Button\r\n                                variant=\"outline-info\"\r\n                                size=\"sm\"\r\n                                onClick={() => handleShowActivity(userItem.id)}\r\n                                title=\"Lịch sử hoạt động\"\r\n                              >\r\n                                <i className=\"fas fa-history\"></i>\r\n                              </Button>\r\n                            )}\r\n                          </div>\r\n                        </td>\r\n                      </tr>\r\n                    ))}\r\n                  </tbody>\r\n                </Table>\r\n              </div>\r\n            </Tab.Pane>\r\n\r\n            {/* Activity Log Tab (Admin only) */}\r\n            {isAdmin() && (\r\n              <Tab.Pane eventKey=\"activity\" className={activeTab === 'activity' ? 'show active' : ''}>\r\n                <Alert variant=\"info\">\r\n                  <i className=\"fas fa-info-circle me-2\"></i>\r\n                  Tính năng xem lịch sử hoạt động tổng hợp sẽ được triển khai ở component riêng\r\n                </Alert>\r\n              </Tab.Pane>\r\n            )}\r\n\r\n            {/* AI Statistics Tab */}\r\n            <Tab.Pane eventKey=\"ai-stats\" className={activeTab === 'ai-stats' ? 'show active' : ''}>\r\n              <Row>\r\n                <Col md={4}>\r\n                  <Card className=\"border-0 shadow-sm text-center\">\r\n                    <Card.Body>\r\n                      <i className=\"fas fa-users fa-2x text-primary mb-2\"></i>\r\n                      <h4 className=\"mb-1\">{users.filter(u => u.ai_configs_count > 0).length}</h4>\r\n                      <p className=\"text-muted mb-0\">Users có AI config</p>\r\n                    </Card.Body>\r\n                  </Card>\r\n                </Col>\r\n                <Col md={4}>\r\n                  <Card className=\"border-0 shadow-sm text-center\">\r\n                    <Card.Body>\r\n                      <i className=\"fas fa-robot fa-2x text-success mb-2\"></i>\r\n                      <h4 className=\"mb-1\">{users.reduce((sum, u) => sum + (u.ai_configs_count || 0), 0)}</h4>\r\n                      <p className=\"text-muted mb-0\">Tổng AI configs</p>\r\n                    </Card.Body>\r\n                  </Card>\r\n                </Col>\r\n                <Col md={4}>\r\n                  <Card className=\"border-0 shadow-sm text-center\">\r\n                    <Card.Body>\r\n                      <i className=\"fas fa-chart-line fa-2x text-warning mb-2\"></i>\r\n                      <h4 className=\"mb-1\">$0.00</h4>\r\n                      <p className=\"text-muted mb-0\">Chi phí AI tháng này</p>\r\n                    </Card.Body>\r\n                  </Card>\r\n                </Col>\r\n              </Row>\r\n\r\n              <Card className=\"mt-4\">\r\n                <Card.Header>\r\n                  <h6 className=\"mb-0\">Phân bố AI Providers</h6>\r\n                </Card.Header>\r\n                <Card.Body>\r\n                  <Alert variant=\"info\">\r\n                    Chart thống kê AI providers sẽ được triển khai với dữ liệu thực tế\r\n                  </Alert>\r\n                </Card.Body>\r\n              </Card>\r\n            </Tab.Pane>\r\n          </Tab.Content>\r\n        </Card.Body>\r\n      </Card>\r\n\r\n      {/* User Detail Modal */}\r\n      <Modal show={showUserModal} onHide={() => setShowUserModal(false)} size=\"lg\">\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Chi tiết người dùng</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n          {selectedUser && (\r\n            <Row>\r\n              <Col md={6}>\r\n                <h6>Thông tin cơ bản</h6>\r\n                <div className=\"info-group\">\r\n                  <div><strong>Tên:</strong> {selectedUser.user.full_name}</div>\r\n                  <div><strong>Username:</strong> {selectedUser.user.username}</div>\r\n                  <div><strong>Email:</strong> {selectedUser.user.email}</div>\r\n                  <div><strong>Vai trò:</strong> {getRoleBadge(selectedUser.user.role)}</div>\r\n                  <div><strong>Trạng thái:</strong> {getStatusBadge(selectedUser.user.is_active)}</div>\r\n                </div>\r\n              </Col>\r\n              <Col md={6}>\r\n                <h6>Thống kê</h6>\r\n                <div className=\"info-group\">\r\n                  <div><strong>Dự án được gán:</strong> {selectedUser.project_permissions?.length || 0}</div>\r\n                  <div><strong>AI Configs:</strong> {selectedUser.ai_configurations?.length || 0}</div>\r\n                  <div><strong>Ngày tạo:</strong> {new Date(selectedUser.user.created_at).toLocaleDateString('vi-VN')}</div>\r\n                  <div><strong>Đăng nhập cuối:</strong> {selectedUser.user.last_login ? new Date(selectedUser.user.last_login).toLocaleDateString('vi-VN') : 'Chưa có'}</div>\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n          )}\r\n        </Modal.Body>\r\n        <Modal.Footer>\r\n          <Button variant=\"secondary\" onClick={() => setShowUserModal(false)}>\r\n            Đóng\r\n          </Button>\r\n        </Modal.Footer>\r\n      </Modal>\r\n\r\n      {/* AI Configuration Manager - Phân hệ 2.4.3 */}\r\n      <AIConfigManager\r\n        user={selectedUser}\r\n        userId={selectedUser?.user?.id || selectedUser?.id}\r\n        show={showAIConfigModal}\r\n        onHide={() => {\r\n          setShowAIConfigModal(false);\r\n          setSelectedUser(null);\r\n        }}\r\n        onSave={() => {\r\n          loadUsers();\r\n          showSuccess('Cấu hình AI đã được cập nhật thành công!');\r\n        }}\r\n      />\r\n\r\n      {/* Permission Manager Modal */}\r\n      <PermissionManager\r\n        user={selectedUser}\r\n        userId={selectedUser?.user?.id || selectedUser?.id}\r\n        show={showPermissionModal}\r\n        onHide={() => {\r\n          setShowPermissionModal(false);\r\n          setSelectedUser(null);\r\n        }}\r\n        onSave={() => {\r\n          loadUsers();\r\n          showSuccess('Cập nhật quyền hạn thành công!');\r\n        }}\r\n      />\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default UserManagement;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}