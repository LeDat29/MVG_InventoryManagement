"use strict";(self.webpackChunkkho_mvg_client=self.webpackChunkkho_mvg_client||[]).push([[764],{7764:(e,n,s)=>{s.r(n),s.d(n,{default:()=>v});var a=s(9379),c=s(5043),i=s(5328),l=s(326),t=s(4282),r=s(8628),o=s(1072),h=s(8602),d=s(3722),m=s(7994),u=s(1719),x=s(579);const p=function(e){let{data:n,errors:s,touched:c,onDataChange:i,onGenerateCode:l}=e;const p=e=>{const{name:s,value:c}=e.target,l=(0,a.A)((0,a.A)({},n),{},{[s]:c});i(l)};return(0,x.jsxs)(r.A,{children:[(0,x.jsx)(r.A.Header,{children:(0,x.jsxs)("h5",{className:"mb-0",children:[(0,x.jsx)("i",{className:"fas fa-user me-2"}),"Th\xf4ng tin c\xe1 nh\xe2n c\u01a1 b\u1ea3n"]})}),(0,x.jsxs)(r.A.Body,{children:[(0,x.jsxs)(o.A,{children:[(0,x.jsx)(h.A,{md:6,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"Lo\u1ea1i kh\xe1ch h\xe0ng *"}),(0,x.jsxs)(d.A.Select,{name:"customer_type",value:n.customer_type,onChange:p,children:[(0,x.jsx)("option",{value:"individual",children:"C\xe1 nh\xe2n (CN)"}),(0,x.jsx)("option",{value:"company",children:"Doanh nghi\u1ec7p (DN)"})]}),(0,x.jsx)(d.A.Text,{className:"text-muted",children:"M\xe3 kh\xe1ch h\xe0ng s\u1ebd b\u1eaft \u0111\u1ea7u b\u1eb1ng CN (C\xe1 nh\xe2n) ho\u1eb7c DN (Doanh nghi\u1ec7p)"})]})}),(0,x.jsx)(h.A,{md:6,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"M\xe3 kh\xe1ch h\xe0ng *"}),(0,x.jsxs)(m.A,{children:[(0,x.jsx)(d.A.Control,{type:"text",name:"customer_code",value:n.customer_code,onChange:p,placeholder:"VD: ".concat("individual"===n.customer_type?"CN":"DN","123456"),isInvalid:c.customer_code&&s.customer_code}),(0,x.jsx)(t.A,{variant:"outline-secondary",onClick:l,title:"T\u1ef1 \u0111\u1ed9ng t\u1ea1o m\xe3",children:(0,x.jsx)("i",{className:"fas fa-magic"})})]}),c.customer_code&&s.customer_code&&(0,x.jsx)("div",{className:"invalid-feedback d-block",children:s.customer_code}),(0,x.jsx)(d.A.Text,{className:"text-muted",children:"Format: 2 k\xfd t\u1ef1 ph\xe2n lo\u1ea1i + 6 k\xfd t\u1ef1 s\u1ed1 t\u1ef1 \u0111\u1ed9ng"})]})})]}),(0,x.jsxs)(o.A,{children:[(0,x.jsx)(h.A,{md:8,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"H\u1ecd v\xe0 t\xean \u0111\u1ea7y \u0111\u1ee7 *"}),(0,x.jsx)(d.A.Control,{type:"text",name:"full_name",value:n.full_name,onChange:p,placeholder:"Nh\u1eadp h\u1ecd t\xean \u0111\u1ea7y \u0111\u1ee7",isInvalid:c.full_name&&s.full_name}),c.full_name&&s.full_name&&(0,x.jsx)("div",{className:"invalid-feedback",children:s.full_name})]})}),(0,x.jsx)(h.A,{md:4,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i *"}),(0,x.jsx)(d.A.Control,{type:"text",name:"phone",value:n.phone,onChange:p,placeholder:"0123456789",isInvalid:c.phone&&s.phone}),c.phone&&s.phone&&(0,x.jsx)("div",{className:"invalid-feedback",children:s.phone})]})})]}),(0,x.jsxs)(o.A,{children:[(0,x.jsx)(h.A,{md:6,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"Email"}),(0,x.jsx)(d.A.Control,{type:"email",name:"email",value:n.email,onChange:p,placeholder:"email@example.com",isInvalid:c.email&&s.email}),c.email&&s.email&&(0,x.jsx)("div",{className:"invalid-feedback",children:s.email})]})}),(0,x.jsx)(h.A,{md:6,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"CMND/CCCD"}),(0,x.jsx)(d.A.Control,{type:"text",name:"id_number",value:n.id_number,onChange:p,placeholder:"S\u1ed1 CMND/CCCD",isInvalid:c.id_number&&s.id_number}),c.id_number&&s.id_number&&(0,x.jsx)("div",{className:"invalid-feedback",children:s.id_number})]})})]}),(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"\u0110\u1ecba ch\u1ec9 li\xean h\u1ec7"}),(0,x.jsx)(d.A.Control,{as:"textarea",rows:2,name:"address",value:n.address,onChange:p,placeholder:"\u0110\u1ecba ch\u1ec9 \u0111\u1ea7y \u0111\u1ee7 (s\u1ed1 nh\xe0, \u0111\u01b0\u1eddng, ph\u01b0\u1eddng/x\xe3, qu\u1eadn/huy\u1ec7n, t\u1ec9nh/th\xe0nh)"})]}),(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"Ghi ch\xfa"}),(0,x.jsx)(d.A.Control,{as:"textarea",rows:3,name:"notes",value:n.notes,onChange:p,placeholder:"Ghi ch\xfa th\xeam v\u1ec1 kh\xe1ch h\xe0ng..."})]}),"individual"===n.customer_type&&(0,x.jsxs)(u.A,{variant:"info",children:[(0,x.jsx)("i",{className:"fas fa-info-circle me-2"}),(0,x.jsx)("strong",{children:"L\u01b0u \xfd cho kh\xe1ch h\xe0ng c\xe1 nh\xe2n:"})," M\u1ed9t c\xe1 nh\xe2n c\xf3 th\u1ec3 thu\xea kho th\xf4ng qua nhi\u1ec1u c\xf4ng ty kh\xe1c nhau. Vui l\xf2ng \u0111i\u1ec1n th\xf4ng tin c\xf4ng ty \u1edf tab ti\u1ebfp theo."]})]})]})};var j=s(4063);const g=function(e){let{companies:n,errors:s,touched:c,onCompaniesChange:i}=e;const l=(e,s,c)=>{const l=[...n];l[e]=(0,a.A)((0,a.A)({},l[e]),{},{[s]:c}),i(l)},m=e=>e.trim()?/^[0-9]{10}(-[0-9]{3})?$/.test(e)?"":"M\xe3 s\u1ed1 thu\u1ebf ph\u1ea3i c\xf3 10 s\u1ed1 ho\u1eb7c 10 s\u1ed1 + 3 s\u1ed1 m\xe3 chi nh\xe1nh (VD: 0123456789 ho\u1eb7c 0123456789-001)":"M\xe3 s\u1ed1 thu\u1ebf l\xe0 b\u1eaft bu\u1ed9c",p=["Kho h\xe0ng h\xf3a t\u1ed5ng h\u1ee3p","Kho nguy\xean li\u1ec7u s\u1ea3n xu\u1ea5t","Kho th\xe0nh ph\u1ea9m","Kho ph\u1ee5 t\xf9ng, linh ki\u1ec7n","Kho thi\u1ebft b\u1ecb, m\xe1y m\xf3c","Kho h\xe0ng \u0111i\u1ec7n t\u1eed","Kho h\xe0ng th\u1eddi trang","Kho h\xe0ng th\u1ef1c ph\u1ea9m","Kho h\xe0ng d\u01b0\u1ee3c ph\u1ea9m","Kho h\xe0ng h\xf3a ch\u1ea5t","Kho v\u0103n ph\xf2ng ph\u1ea9m","Kho t\xe0i li\u1ec7u, h\u1ed3 s\u01a1","Kh\xe1c"];return(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,x.jsxs)("h5",{className:"mb-0",children:[(0,x.jsx)("i",{className:"fas fa-building me-2"}),"Th\xf4ng tin c\xf4ng ty (",n.length,")"]}),(0,x.jsxs)(t.A,{variant:"outline-primary",size:"sm",onClick:()=>{const e={id:null,tax_code:"",company_name:"",invoice_address:"",warehouse_purpose:"",is_primary:0===n.length};i([...n,e])},children:[(0,x.jsx)("i",{className:"fas fa-plus me-2"}),"Th\xeam c\xf4ng ty"]})]}),(0,x.jsxs)(u.A,{variant:"info",className:"mb-3",children:[(0,x.jsx)("i",{className:"fas fa-info-circle me-2"}),(0,x.jsx)("strong",{children:"L\u01b0u \xfd:"})," M\u1ed9t c\xe1 nh\xe2n c\xf3 th\u1ec3 thu\xea nhi\u1ec1u kho b\u1eb1ng nhi\u1ec1u c\xf4ng ty kh\xe1c nhau. M\u1ed7i c\xf4ng ty s\u1ebd c\xf3 th\xf4ng tin ri\xeang \u0111\u1ec3 xu\u1ea5t h\xf3a \u0111\u01a1n v\xe0 k\xfd h\u1ee3p \u0111\u1ed3ng."]}),n.map((e,s)=>(0,x.jsxs)(r.A,{className:"mb-3",children:[(0,x.jsxs)(r.A.Header,{className:"d-flex justify-content-between align-items-center",children:[(0,x.jsxs)("div",{children:[(0,x.jsxs)("strong",{children:["C\xf4ng ty ",s+1]}),e.is_primary&&(0,x.jsx)(j.A,{bg:"primary",className:"ms-2",children:"C\xf4ng ty ch\xednh"})]}),(0,x.jsxs)("div",{children:[!e.is_primary&&n.length>1&&(0,x.jsx)(t.A,{variant:"outline-success",size:"sm",className:"me-2",onClick:()=>(e=>{const s=n.map((n,s)=>(0,a.A)((0,a.A)({},n),{},{is_primary:s===e}));i(s)})(s),title:"\u0110\u1eb7t l\xe0m c\xf4ng ty ch\xednh",children:(0,x.jsx)("i",{className:"fas fa-star"})}),n.length>1&&(0,x.jsx)(t.A,{variant:"outline-danger",size:"sm",onClick:()=>(e=>{if(n.length<=1)alert("Ph\u1ea3i c\xf3 \xedt nh\u1ea5t m\u1ed9t c\xf4ng ty");else if(window.confirm("B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a c\xf4ng ty n\xe0y?")){const s=n.filter((n,s)=>s!==e);n[e].is_primary&&s.length>0&&(s[0].is_primary=!0),i(s)}})(s),title:"X\xf3a c\xf4ng ty",children:(0,x.jsx)("i",{className:"fas fa-trash"})})]})]}),(0,x.jsxs)(r.A.Body,{children:[(0,x.jsxs)(o.A,{children:[(0,x.jsx)(h.A,{md:6,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"M\xe3 s\u1ed1 thu\u1ebf *"}),(0,x.jsx)(d.A.Control,{type:"text",value:e.tax_code,onChange:e=>l(s,"tax_code",e.target.value),placeholder:"0123456789 ho\u1eb7c 0123456789-001",isInvalid:m(e.tax_code)}),(0,x.jsx)(d.A.Text,{className:"text-muted",children:"10 s\u1ed1 cho tr\u1ee5 s\u1edf ch\xednh, th\xeam -001, -002... cho chi nh\xe1nh"}),m(e.tax_code)&&(0,x.jsx)("div",{className:"invalid-feedback d-block",children:m(e.tax_code)})]})}),(0,x.jsx)(h.A,{md:6,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"T\xean c\xf4ng ty *"}),(0,x.jsx)(d.A.Control,{type:"text",value:e.company_name,onChange:e=>l(s,"company_name",e.target.value),placeholder:"T\xean c\xf4ng ty \u0111\u1ea7y \u0111\u1ee7",isInvalid:!e.company_name.trim()}),!e.company_name.trim()&&(0,x.jsx)("div",{className:"invalid-feedback d-block",children:"T\xean c\xf4ng ty l\xe0 b\u1eaft bu\u1ed9c"})]})})]}),(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"\u0110\u1ecba ch\u1ec9 xu\u1ea5t h\xf3a \u0111\u01a1n *"}),(0,x.jsx)(d.A.Control,{as:"textarea",rows:2,value:e.invoice_address,onChange:e=>l(s,"invoice_address",e.target.value),placeholder:"\u0110\u1ecba ch\u1ec9 \u0111\u1ea7y \u0111\u1ee7 \u0111\u1ec3 xu\u1ea5t h\xf3a \u0111\u01a1n VAT",isInvalid:!e.invoice_address.trim()}),!e.invoice_address.trim()&&(0,x.jsx)("div",{className:"invalid-feedback d-block",children:"\u0110\u1ecba ch\u1ec9 xu\u1ea5t h\xf3a \u0111\u01a1n l\xe0 b\u1eaft bu\u1ed9c"})]}),(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"M\u1ee5c \u0111\xedch s\u1eed d\u1ee5ng kho *"}),(0,x.jsxs)(d.A.Select,{value:e.warehouse_purpose,onChange:e=>l(s,"warehouse_purpose",e.target.value),isInvalid:!e.warehouse_purpose,children:[(0,x.jsx)("option",{value:"",children:"-- Ch\u1ecdn m\u1ee5c \u0111\xedch s\u1eed d\u1ee5ng --"}),p.map(e=>(0,x.jsx)("option",{value:e,children:e},e))]}),!e.warehouse_purpose&&(0,x.jsx)("div",{className:"invalid-feedback d-block",children:"Vui l\xf2ng ch\u1ecdn m\u1ee5c \u0111\xedch s\u1eed d\u1ee5ng kho"}),(0,x.jsx)(d.A.Text,{className:"text-muted",children:"Th\xf4ng tin n\xe0y s\u1ebd \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong h\u1ee3p \u0111\u1ed3ng thu\xea kho"})]})]})]},s)),0===n.length&&(0,x.jsxs)(u.A,{variant:"warning",children:[(0,x.jsx)("i",{className:"fas fa-exclamation-triangle me-2"}),"Ch\u01b0a c\xf3 th\xf4ng tin c\xf4ng ty n\xe0o. Vui l\xf2ng th\xeam \xedt nh\u1ea5t m\u1ed9t c\xf4ng ty \u0111\u1ec3 ti\u1ebfp t\u1ee5c."]})]})};const v=function(e){let{customer:n=null,onSave:s,onCancel:r,isLoading:o=!1}=e;const[h,d]=(0,c.useState)("personal"),[m,u]=(0,c.useState)({personal:{customer_code:"",customer_type:"individual",full_name:"",phone:"",email:"",address:"",id_number:"",notes:""},companies:[{id:null,tax_code:"",company_name:"",invoice_address:"",warehouse_purpose:"",is_primary:!0}]}),[j]=(0,c.useState)({}),[v]=(0,c.useState)({});return(0,c.useEffect)(()=>{n?(console.log("\ud83d\udd0d Loading customer data for edit:",n),u({personal:{customer_code:n.customer_code||"",customer_type:n.customer_type||"individual",full_name:n.representative_name||n.name||"",phone:n.phone||"",email:n.email||"",address:n.address||"",id_number:n.id_number||"",notes:n.notes||""},companies:[{id:null,tax_code:n.tax_code||"",company_name:n.name||"",invoice_address:n.address||"",warehouse_purpose:n.warehouse_purpose||"",is_primary:!0}]}),console.log("\u2705 Form data populated for customer:",n.customer_code)):console.log("\ud83c\udd95 Creating new customer - using default form structure")},[n]),(0,x.jsxs)("div",{children:[(0,x.jsxs)(i.A.Container,{activeKey:h,onSelect:e=>d(e),children:[(0,x.jsxs)(l.A,{variant:"tabs",className:"mb-3",children:[(0,x.jsx)(l.A.Item,{children:(0,x.jsxs)(l.A.Link,{eventKey:"personal",children:[(0,x.jsx)("i",{className:"fas fa-user me-2"}),"Th\xf4ng tin c\u01a1 b\u1ea3n"]})}),(0,x.jsx)(l.A.Item,{children:(0,x.jsxs)(l.A.Link,{eventKey:"company",children:[(0,x.jsx)("i",{className:"fas fa-building me-2"}),"Th\xf4ng tin c\xf4ng ty"]})})]}),(0,x.jsxs)(i.A.Content,{children:[(0,x.jsx)(i.A.Pane,{eventKey:"personal",children:(0,x.jsx)(p,{data:m.personal,errors:j,touched:v,onDataChange:e=>u(n=>(0,a.A)((0,a.A)({},n),{},{personal:e})),onGenerateCode:()=>{const e="individual"===m.personal.customer_type?"CN":"DN",n=Date.now().toString(),s=Math.floor(1e4*Math.random()).toString().padStart(4,"0"),c=(n.slice(-2)+s).slice(0,6),i="".concat(e).concat(c);u(e=>(0,a.A)((0,a.A)({},e),{},{personal:(0,a.A)((0,a.A)({},e.personal),{},{customer_code:i})}))}})}),(0,x.jsx)(i.A.Pane,{eventKey:"company",children:(0,x.jsx)(g,{companies:m.companies,errors:j,touched:v,onCompaniesChange:e=>u(n=>(0,a.A)((0,a.A)({},n),{},{companies:e}))})})]})]}),(0,x.jsxs)("div",{className:"d-flex justify-content-between mt-4",children:[(0,x.jsxs)(t.A,{variant:"outline-secondary",onClick:r,disabled:o,children:[(0,x.jsx)("i",{className:"fas fa-times me-2"}),"H\u1ee7y b\u1ecf"]}),(0,x.jsxs)("div",{children:["personal"!==h&&(0,x.jsxs)(t.A,{variant:"outline-primary",className:"me-2",onClick:()=>d("personal"),children:[(0,x.jsx)("i",{className:"fas fa-arrow-left me-2"}),"Quay l\u1ea1i"]}),(0,x.jsx)(t.A,{variant:"success",onClick:()=>{try{if("function"!==typeof s)throw new Error("onSave is not a function");s(m)}catch(e){console.error("\u274c CustomerFormTabs onClick error:",e),alert("Error: "+e.message)}},disabled:o,size:"lg",children:o?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("span",{className:"spinner-border spinner-border-sm me-2"}),"\u0110ang l\u01b0u..."]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("i",{className:"fas fa-save me-2"}),n?"C\u1eadp nh\u1eadt":"L\u01b0u th\xf4ng tin"]})})]})]})]})}}}]);
//# sourceMappingURL=764.d5e1955f.chunk.js.map