"use strict";(self.webpackChunkkho_mvg_client=self.webpackChunkkho_mvg_client||[]).push([[293,392],{6392:(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var n=s(9379),a=s(5043),r=s(4063),i=s(4282),l=s(8628),c=s(8602),d=s(3519),h=s(5258),o=s(3722),x=s(2557),m=s(9869),j=s(1072),p=s(5328),u=s(4196),g=s(9422),v=s(615),A=s(5016),_=s(6471),y=s(2550),b=s(5531),f=s(7848),N=s(579);const C=e=>{var t,s,n;let{contract:a}=e;return(0,N.jsxs)(g.A,{defaultActiveKey:"overview",id:"contract-detail-tabs",children:[(0,N.jsx)(p.A,{eventKey:"overview",title:"T\u1ed5ng quan",children:(0,N.jsx)("div",{className:"pt-3",children:(0,N.jsxs)(j.A,{children:[(0,N.jsxs)(c.A,{md:6,children:[(0,N.jsx)("h5",{children:"Th\xf4ng tin h\u1ee3p \u0111\u1ed3ng"}),(0,N.jsx)(u.A,{size:"sm",children:(0,N.jsxs)("tbody",{children:[(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:(0,N.jsx)("strong",{children:"S\u1ed1 h\u1ee3p \u0111\u1ed3ng:"})}),(0,N.jsx)("td",{children:a.contract.contract_number})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:(0,N.jsx)("strong",{children:"Ti\xeau \u0111\u1ec1:"})}),(0,N.jsx)("td",{children:a.contract.contract_title})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:(0,N.jsx)("strong",{children:"D\u1ef1 \xe1n:"})}),(0,N.jsx)("td",{children:a.contract.project_name||"Ch\u01b0a ph\xe2n b\u1ed5"})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:(0,N.jsx)("strong",{children:"Kho:"})}),(0,N.jsx)("td",{children:a.contract.warehouse_location})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:(0,N.jsx)("strong",{children:"Di\u1ec7n t\xedch:"})}),(0,N.jsxs)("td",{children:[a.contract.warehouse_area," m\xb2"]})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:(0,N.jsx)("strong",{children:"Gi\xe1 thu\xea:"})}),(0,N.jsxs)("td",{children:[new Intl.NumberFormat("vi-VN").format(a.contract.rental_price)," VN\u0110/th\xe1ng"]})]})]})})]}),(0,N.jsxs)(c.A,{md:6,children:[(0,N.jsx)("h5",{children:"Th\xf4ng tin kh\xe1ch h\xe0ng"}),(0,N.jsx)(u.A,{size:"sm",children:(0,N.jsxs)("tbody",{children:[(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:(0,N.jsx)("strong",{children:"C\xf4ng ty:"})}),(0,N.jsx)("td",{children:a.contract.customer_company_name})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:(0,N.jsx)("strong",{children:"Ng\u01b0\u1eddi li\xean h\u1ec7:"})}),(0,N.jsx)("td",{children:a.contract.customer_name})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:(0,N.jsx)("strong",{children:"\u0110i\u1ec7n tho\u1ea1i:"})}),(0,N.jsx)("td",{children:a.contract.customer_phone})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:(0,N.jsx)("strong",{children:"Email:"})}),(0,N.jsx)("td",{children:a.contract.customer_email})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:(0,N.jsx)("strong",{children:"M\xe3 s\u1ed1 thu\u1ebf:"})}),(0,N.jsx)("td",{children:a.contract.tax_code})]})]})})]})]})})}),(0,N.jsx)(p.A,{eventKey:"documents",title:"T\xe0i li\u1ec7u (".concat((null===(t=a.documents)||void 0===t?void 0:t.length)||0,")"),children:(0,N.jsx)("div",{className:"pt-3",children:(null===(s=a.documents)||void 0===s?void 0:s.length)>0?(0,N.jsxs)(u.A,{children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{children:"T\xean t\xe0i li\u1ec7u"}),(0,N.jsx)("th",{children:"Lo\u1ea1i"}),(0,N.jsx)("th",{children:"Phi\xean b\u1ea3n"}),(0,N.jsx)("th",{children:"Tr\u1ea1ng th\xe1i"}),(0,N.jsx)("th",{children:"Ng\xe0y t\u1ea1o"}),(0,N.jsx)("th",{children:"Thao t\xe1c"})]})}),(0,N.jsx)("tbody",{children:a.documents.map(e=>(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:e.document_name}),(0,N.jsx)("td",{children:(0,N.jsx)(r.A,{bg:"info",children:e.category_name})}),(0,N.jsxs)("td",{children:["v",e.version]}),(0,N.jsx)("td",{children:(0,N.jsx)(r.A,{bg:"final"===e.status?"success":"draft"===e.status?"secondary":"warning",children:e.status})}),(0,N.jsx)("td",{children:new Date(e.created_at).toLocaleDateString("vi-VN")}),(0,N.jsx)("td",{children:(0,N.jsx)(i.A,{variant:"outline-primary",size:"sm",children:(0,N.jsx)("i",{className:"fas fa-eye"})})})]},e.id))})]}):(0,N.jsx)("div",{className:"text-center text-muted py-4",children:"Ch\u01b0a c\xf3 t\xe0i li\u1ec7u n\xe0o"})})}),(0,N.jsx)(p.A,{eventKey:"history",title:"L\u1ecbch s\u1eed",children:(0,N.jsx)("div",{className:"pt-3",children:(null===(n=a.workflow_history)||void 0===n?void 0:n.length)>0?(0,N.jsx)("div",{className:"timeline",children:a.workflow_history.map(e=>(0,N.jsx)("div",{className:"timeline-item mb-3",children:(0,N.jsxs)("div",{className:"d-flex",children:[(0,N.jsx)("div",{className:"flex-shrink-0",children:(0,N.jsx)("div",{className:"rounded-circle bg-primary text-white d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},children:(0,N.jsx)("i",{className:"fas fa-user fa-sm"})})}),(0,N.jsxs)("div",{className:"flex-grow-1 ms-3",children:[(0,N.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,N.jsx)("h6",{className:"mb-1",children:e.action}),(0,N.jsx)("small",{className:"text-muted",children:new Date(e.performed_at).toLocaleString("vi-VN")})]}),(0,N.jsx)("p",{className:"mb-1",children:e.comment}),(0,N.jsxs)("small",{className:"text-muted",children:["B\u1edfi: ",e.performed_by_name]})]})]})},e.id))}):(0,N.jsx)("div",{className:"text-center text-muted py-4",children:"Ch\u01b0a c\xf3 l\u1ecbch s\u1eed n\xe0o"})})})]})},w=()=>{const{hasPermission:e}=(0,A.As)(),{showSuccess:t,showError:s}=(0,_.hN)(),[p,g]=(0,a.useState)(!0),[w,k]=(0,a.useState)([]),[T,S]=(0,a.useState)([]),[H,B]=(0,a.useState)(!1),[L,D]=(0,a.useState)(null),[K,G]=(0,a.useState)(!1),[M,z]=(0,a.useState)(null),[q,V]=(0,a.useState)({search:"",status:"",workflow_stage:"",start_date_from:"",start_date_to:""}),[P,E]=(0,a.useState)({page:1,limit:20,total:0,pages:0}),I={draft:{label:"B\u1ea3n nh\xe1p",variant:"secondary"},review:{label:"\u0110ang xem x\xe9t",variant:"info"},approved:{label:"\u0110\xe3 duy\u1ec7t",variant:"success"},signed:{label:"\u0110\xe3 k\xfd",variant:"primary"},active:{label:"\u0110ang hi\u1ec7u l\u1ef1c",variant:"success"},expired:{label:"H\u1ebft h\u1ea1n",variant:"warning"},terminated:{label:"Ch\u1ea5m d\u1ee9t",variant:"danger"},cancelled:{label:"H\u1ee7y b\u1ecf",variant:"dark"}},O={preparation:{label:"Chu\u1ea9n b\u1ecb",icon:"fas fa-edit"},legal_review:{label:"Xem x\xe9t ph\xe1p l\xfd",icon:"fas fa-balance-scale"},approval:{label:"Ph\xea duy\u1ec7t",icon:"fas fa-check-circle"},signing:{label:"K\xfd k\u1ebft",icon:"fas fa-signature"},execution:{label:"Th\u1ef1c thi",icon:"fas fa-play-circle"}},U=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{g(!0);const t=(0,n.A)({page:e.toString(),limit:P.limit.toString()},q);Object.keys(t).forEach(e=>{t[e]||delete t[e]});const a=await f.A.getContracts(t);if(a&&a.success){const e=Array.isArray(a.data.contracts)?a.data.contracts:[],t=a.data.pagination||{page:1,limit:20,total:e.length,pages:1};k(e),S(e),E(t)}else s(a.message||"Kh\xf4ng th\u1ec3 t\u1ea3i danh s\xe1ch h\u1ee3p \u0111\u1ed3ng")}catch(t){console.warn("Contract loading error:",(null===t||void 0===t?void 0:t.message)||t)}finally{g(!1)}},[q,P.limit,s]);(0,a.useEffect)(()=>{e("contract_read")&&U()},[e,U,P.page]),(0,a.useEffect)(()=>{const e=setTimeout(()=>{1===P.page||E(e=>(0,n.A)((0,n.A)({},e),{},{page:1})),U(1)},500);return()=>clearTimeout(e)},[q]);const X=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),F=async(e,n,a)=>{try{var r;const i={status:n,workflow_stage:a,comment:"Chuy\u1ec3n tr\u1ea1ng th\xe1i sang ".concat(null===(r=I[n])||void 0===r?void 0:r.label)},l=await f.A.updateContractStatus(e,i);l.success?(t("C\u1eadp nh\u1eadt tr\u1ea1ng th\xe1i th\xe0nh c\xf4ng"),U(P.page)):s(l.message||"Kh\xf4ng th\u1ec3 c\u1eadp nh\u1eadt tr\u1ea1ng th\xe1i")}catch(i){s("L\u1ed7i k\u1ebft n\u1ed1i: "+i.message)}};return e("contract_read")?(0,N.jsxs)("div",{className:"mt-4",children:[(0,N.jsx)(j.A,{children:(0,N.jsxs)(c.A,{children:[(0,N.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,N.jsxs)("h2",{children:[(0,N.jsx)("i",{className:"fas fa-file-contract me-2"}),"Qu\u1ea3n l\xfd h\u1ee3p \u0111\u1ed3ng"]}),e("contract_create")&&(0,N.jsxs)(i.A,{variant:"primary",onClick:()=>B(!0),children:[(0,N.jsx)("i",{className:"fas fa-plus me-2"}),"T\u1ea1o h\u1ee3p \u0111\u1ed3ng m\u1edbi"]})]}),(0,N.jsxs)(l.A,{className:"mb-4",children:[(0,N.jsx)(l.A.Header,{children:(0,N.jsxs)("h5",{className:"mb-0",children:[(0,N.jsx)("i",{className:"fas fa-filter me-2"}),"B\u1ed9 l\u1ecdc"]})}),(0,N.jsx)(l.A.Body,{children:(0,N.jsxs)(j.A,{children:[(0,N.jsx)(c.A,{md:3,children:(0,N.jsxs)(o.A.Group,{className:"mb-3",children:[(0,N.jsx)(o.A.Label,{children:"T\xecm ki\u1ebfm"}),(0,N.jsx)(o.A.Control,{type:"text",placeholder:"S\u1ed1 H\u0110, t\xean kh\xe1ch h\xe0ng...",value:q.search,onChange:e=>V(t=>(0,n.A)((0,n.A)({},t),{},{search:e.target.value}))})]})}),(0,N.jsx)(c.A,{md:2,children:(0,N.jsxs)(o.A.Group,{className:"mb-3",children:[(0,N.jsx)(o.A.Label,{children:"Tr\u1ea1ng th\xe1i"}),(0,N.jsxs)(o.A.Select,{value:q.status,onChange:e=>V(t=>(0,n.A)((0,n.A)({},t),{},{status:e.target.value})),children:[(0,N.jsx)("option",{value:"",children:"T\u1ea5t c\u1ea3"}),Object.entries(I).map(e=>{let[t,s]=e;return(0,N.jsx)("option",{value:t,children:s.label},t)})]})]})}),(0,N.jsx)(c.A,{md:2,children:(0,N.jsxs)(o.A.Group,{className:"mb-3",children:[(0,N.jsx)(o.A.Label,{children:"Giai \u0111o\u1ea1n"}),(0,N.jsxs)(o.A.Select,{value:q.workflow_stage,onChange:e=>V(t=>(0,n.A)((0,n.A)({},t),{},{workflow_stage:e.target.value})),children:[(0,N.jsx)("option",{value:"",children:"T\u1ea5t c\u1ea3"}),Object.entries(O).map(e=>{let[t,s]=e;return(0,N.jsx)("option",{value:t,children:s.label},t)})]})]})}),(0,N.jsx)(c.A,{md:2,children:(0,N.jsxs)(o.A.Group,{className:"mb-3",children:[(0,N.jsx)(o.A.Label,{children:"T\u1eeb ng\xe0y"}),(0,N.jsx)(o.A.Control,{type:"date",value:q.start_date_from,onChange:e=>V(t=>(0,n.A)((0,n.A)({},t),{},{start_date_from:e.target.value}))})]})}),(0,N.jsx)(c.A,{md:2,children:(0,N.jsxs)(o.A.Group,{className:"mb-3",children:[(0,N.jsx)(o.A.Label,{children:"\u0110\u1ebfn ng\xe0y"}),(0,N.jsx)(o.A.Control,{type:"date",value:q.start_date_to,onChange:e=>V(t=>(0,n.A)((0,n.A)({},t),{},{start_date_to:e.target.value}))})]})}),(0,N.jsx)(c.A,{md:1,className:"d-flex align-items-end",children:(0,N.jsx)(i.A,{variant:"outline-secondary",onClick:()=>V({search:"",status:"",workflow_stage:"",start_date_from:"",start_date_to:""}),children:(0,N.jsx)("i",{className:"fas fa-undo"})})})]})})]}),(0,N.jsxs)(l.A,{children:[(0,N.jsxs)(l.A.Header,{className:"d-flex justify-content-between align-items-center",children:[(0,N.jsxs)("h5",{className:"mb-0",children:["Danh s\xe1ch h\u1ee3p \u0111\u1ed3ng (",P.total,")"]}),(0,N.jsxs)("div",{className:"d-flex gap-2",children:[(0,N.jsxs)(i.A,{variant:"outline-primary",size:"sm",children:[(0,N.jsx)("i",{className:"fas fa-download me-2"}),"Xu\u1ea5t Excel"]}),(0,N.jsx)(i.A,{variant:"outline-secondary",size:"sm",onClick:()=>U(P.page),children:(0,N.jsx)("i",{className:"fas fa-sync-alt"})})]})]}),(0,N.jsx)(l.A.Body,{className:"p-0",children:p?(0,N.jsx)("div",{className:"text-center p-4",children:(0,N.jsx)(y.A,{})}):M?(0,N.jsxs)("div",{className:"p-4",children:[(0,N.jsxs)("div",{className:"alert alert-danger",children:[(0,N.jsx)("strong",{children:"L\u1ed7i hi\u1ec3n th\u1ecb danh s\xe1ch h\u1ee3p \u0111\u1ed3ng:"}),(0,N.jsx)("div",{children:String(M)})]}),(0,N.jsx)("div",{className:"text-muted",children:"Vui l\xf2ng t\u1ea3i l\u1ea1i trang ho\u1eb7c li\xean h\u1ec7 admin."})]}):(0,N.jsxs)(u.A,{responsive:!0,hover:!0,className:"mb-0",children:[(0,N.jsx)("thead",{className:"table-light",children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{children:"S\u1ed1 h\u1ee3p \u0111\u1ed3ng"}),(0,N.jsx)("th",{children:"Kh\xe1ch h\xe0ng"}),(0,N.jsx)("th",{children:"D\u1ef1 \xe1n"}),(0,N.jsx)("th",{children:"Di\u1ec7n t\xedch"}),(0,N.jsx)("th",{children:"Gi\xe1 thu\xea/th\xe1ng"}),(0,N.jsx)("th",{children:"Th\u1eddi h\u1ea1n"}),(0,N.jsx)("th",{children:"Tr\u1ea1ng th\xe1i"}),(0,N.jsx)("th",{children:"Giai \u0111o\u1ea1n"}),(0,N.jsx)("th",{children:"Ng\u01b0\u1eddi ph\u1ee5 tr\xe1ch"}),(0,N.jsx)("th",{children:"Thao t\xe1c"})]})}),(0,N.jsx)("tbody",{children:(()=>{try{return(T||[]).map(t=>{var n,a,l,c,d,o,x;return(0,N.jsxs)("tr",{children:[(0,N.jsxs)("td",{children:[(0,N.jsx)("strong",{children:t.contract_number}),(0,N.jsx)("br",{}),(0,N.jsx)("small",{className:"text-muted",children:t.created_at?new Date(t.created_at).toLocaleDateString("vi-VN"):""})]}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{children:[(0,N.jsx)("strong",{children:t.customer_company_name||t.company_name}),(0,N.jsx)("br",{}),(0,N.jsx)("small",{className:"text-muted",children:t.customer_name})]})}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{children:[(0,N.jsx)("strong",{children:t.project_name||"Ch\u01b0a ph\xe2n b\u1ed5"}),(0,N.jsx)("br",{}),(0,N.jsx)("small",{className:"text-muted",children:t.warehouse_location})]})}),(0,N.jsxs)("td",{children:[null!==(n=t.warehouse_area)&&void 0!==n?n:"N/A"," m\xb2"]}),(0,N.jsxs)("td",{children:[X(null!==(a=t.rental_price)&&void 0!==a?a:0),(0,N.jsx)("br",{}),(0,N.jsx)("small",{className:"text-muted",children:t.warehouse_area?X((null!==(l=t.rental_price)&&void 0!==l?l:0)/t.warehouse_area)+"/m\xb2":"N/A"})]}),(0,N.jsxs)("td",{children:[t.start_date?new Date(t.start_date).toLocaleDateString("vi-VN"):"",(0,N.jsx)("br",{}),(0,N.jsxs)("small",{className:"text-muted",children:["\u2192 ",t.end_date?new Date(t.end_date).toLocaleDateString("vi-VN"):""]})]}),(0,N.jsx)("td",{children:(0,N.jsx)(r.A,{bg:(null===(c=I[t.status])||void 0===c?void 0:c.variant)||"secondary",children:(null===(d=I[t.status])||void 0===d?void 0:d.label)||t.status})}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{className:"d-flex align-items-center",children:[(0,N.jsx)("i",{className:"".concat(null===(o=O[t.workflow_stage])||void 0===o?void 0:o.icon," me-2")}),(0,N.jsx)("small",{children:null===(x=O[t.workflow_stage])||void 0===x?void 0:x.label})]})}),(0,N.jsx)("td",{children:t.assigned_to_name?(0,N.jsx)(r.A,{bg:"info",children:t.assigned_to_name}):(0,N.jsx)("span",{className:"text-muted",children:"Ch\u01b0a giao"})}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{className:"d-flex gap-1",children:[(0,N.jsx)(m.A,{overlay:(0,N.jsx)(v.A,{children:"Xem chi ti\u1ebft"}),children:(0,N.jsx)(i.A,{variant:"outline-primary",size:"sm",onClick:()=>(async e=>{try{const t=await f.A.getContract(e);t.success?(D(t.data),G(!0)):s(t.message||"Kh\xf4ng th\u1ec3 t\u1ea3i chi ti\u1ebft h\u1ee3p \u0111\u1ed3ng")}catch(t){s("L\u1ed7i k\u1ebft n\u1ed1i: "+t.message)}})(t.id),children:(0,N.jsx)("i",{className:"fas fa-eye"})})}),e("contract_update")&&(0,N.jsxs)(h.A,{children:[(0,N.jsx)(h.A.Toggle,{variant:"outline-secondary",size:"sm",id:"dropdown-".concat(t.id),children:(0,N.jsx)("i",{className:"fas fa-cog"})}),(0,N.jsxs)(h.A.Menu,{children:[(0,N.jsxs)(h.A.Item,{onClick:()=>F(t.id,"review","legal_review"),children:[(0,N.jsx)("i",{className:"fas fa-eye me-2"}),"G\u1eedi xem x\xe9t"]}),(0,N.jsxs)(h.A.Item,{onClick:()=>F(t.id,"approved","signing"),children:[(0,N.jsx)("i",{className:"fas fa-check me-2"}),"Ph\xea duy\u1ec7t"]}),(0,N.jsxs)(h.A.Item,{onClick:()=>F(t.id,"signed","execution"),children:[(0,N.jsx)("i",{className:"fas fa-signature me-2"}),"\u0110\xe3 k\xfd"]}),(0,N.jsx)(h.A.Divider,{}),(0,N.jsxs)(h.A.Item,{className:"text-danger",children:[(0,N.jsx)("i",{className:"fas fa-trash me-2"}),"H\u1ee7y b\u1ecf"]})]})]})]})})]},t.id)})}catch(t){return console.error("Render error in ContractManager:",t),z((null===t||void 0===t?void 0:t.message)||String(t)),null}})()})]})}),P.pages>1&&(0,N.jsx)(l.A.Footer,{children:(0,N.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,N.jsxs)("small",{className:"text-muted",children:["Hi\u1ec3n th\u1ecb ",(P.page-1)*P.limit+1," - ",Math.min(P.page*P.limit,P.total),"trong t\u1ed5ng s\u1ed1 ",P.total," h\u1ee3p \u0111\u1ed3ng"]}),(0,N.jsxs)("div",{className:"d-flex gap-2",children:[(0,N.jsx)(i.A,{variant:"outline-secondary",size:"sm",disabled:1===P.page,onClick:()=>E(e=>(0,n.A)((0,n.A)({},e),{},{page:e.page-1})),children:(0,N.jsx)("i",{className:"fas fa-chevron-left"})}),(0,N.jsxs)("span",{className:"d-flex align-items-center px-3",children:["Trang ",P.page," / ",P.pages]}),(0,N.jsx)(i.A,{variant:"outline-secondary",size:"sm",disabled:P.page===P.pages,onClick:()=>E(e=>(0,n.A)((0,n.A)({},e),{},{page:e.page+1})),children:(0,N.jsx)("i",{className:"fas fa-chevron-right"})})]})]})})]})]})}),(0,N.jsx)(b.default,{show:H,onHide:()=>B(!1),onSuccess:()=>{B(!1),U(P.page)}}),L&&(0,N.jsxs)(x.A,{show:K,onHide:()=>G(!1),size:"xl",scrollable:!0,children:[(0,N.jsx)(x.A.Header,{closeButton:!0,children:(0,N.jsxs)(x.A.Title,{children:["Chi ti\u1ebft h\u1ee3p \u0111\u1ed3ng ",L.contract.contract_number]})}),(0,N.jsx)(x.A.Body,{children:(0,N.jsx)(C,{contract:L})})]})]}):(0,N.jsx)(d.A,{className:"mt-4",children:(0,N.jsx)("div",{className:"alert alert-warning",children:"B\u1ea1n kh\xf4ng c\xf3 quy\u1ec1n truy c\u1eadp qu\u1ea3n l\xfd h\u1ee3p \u0111\u1ed3ng."})})}},7293:(e,t,s)=>{s.r(t),s.d(t,{default:()=>C});var n=s(5043),a=s(3519),r=s(5328),i=s(326),l=s(5016),c=s(6392),d=s(9379),h=s(1719),o=s(1072),x=s(8602),m=s(4282),j=s(8628),p=s(4196),u=s(4063),g=s(2557),v=s(3722),A=s(9422),_=s(6471),y=s(7848),b=s(2550),f=s(579);const N=()=>{const{hasPermission:e}=(0,l.As)(),{showSuccess:t,showError:s}=(0,_.hN)(),[i,c]=(0,n.useState)(!0),[N,C]=(0,n.useState)([]),[w,k]=(0,n.useState)(!1),[T,S]=(0,n.useState)(!1),[H,B]=(0,n.useState)(null),[L,D]=(0,n.useState)(!1),[K,G]=(0,n.useState)({template_name:"",template_code:"",template_type:"warehouse_rental",template_content:"",variables:[],version:"1.0",is_active:!0,is_default:!1}),[M,z]=(0,n.useState)({name:"",type:"text",required:!0,description:""}),q=(0,n.useCallback)(async()=>{try{c(!0);const e=await y.A.getContractTemplates();C(e.data)}catch(e){s("Kh\xf4ng th\u1ec3 t\u1ea3i danh s\xe1ch m\u1eabu h\u1ee3p \u0111\u1ed3ng: "+e.message)}finally{c(!1)}},[s]);(0,n.useEffect)(()=>{e("contract_template_read")&&q()},[e,q]);const V=()=>{G({template_name:"",template_code:"",template_type:"warehouse_rental",template_content:"",variables:[],version:"1.0",is_active:!0,is_default:!1}),B(null)};return e("contract_template_read")?(0,f.jsxs)(a.A,{fluid:!0,className:"mt-4",children:[(0,f.jsx)(o.A,{children:(0,f.jsxs)(x.A,{children:[(0,f.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,f.jsxs)("h2",{children:[(0,f.jsx)("i",{className:"fas fa-file-alt me-2"}),"Qu\u1ea3n l\xfd m\u1eabu h\u1ee3p \u0111\u1ed3ng"]}),e("contract_template_create")&&(0,f.jsxs)(m.A,{variant:"primary",onClick:()=>{V(),G(e=>(0,d.A)((0,d.A)({},e),{},{template_content:'\n<div class="contract-header">\n  <h1 style="text-align: center;">H\u1ee2P \u0110\u1ed2NG THU\xca KHO</h1>\n  <p style="text-align: center;">S\u1ed1: {{contract_number}}</p>\n</div>\n\n<div class="contract-parties">\n  <h3>C\xc1C B\xcaN THAM GIA H\u1ee2P \u0110\u1ed2NG</h3>\n  \n  <h4>B\xcaN CHO THU\xca (B\xean A):</h4>\n  <p><strong>T\xean:</strong> {{party_a_name}}</p>\n  <p><strong>\u0110\u1ecba ch\u1ec9:</strong> {{party_a_address}}</p>\n  <p><strong>Ng\u01b0\u1eddi \u0111\u1ea1i di\u1ec7n:</strong> {{party_a_representative}} - {{party_a_position}}</p>\n  <p><strong>CMND/CCCD:</strong> {{party_a_id_number}}</p>\n  \n  <h4>B\xcaN THU\xca (B\xean B):</h4>\n  <p><strong>T\xean c\xf4ng ty:</strong> {{party_b_name}}</p>\n  <p><strong>\u0110\u1ecba ch\u1ec9:</strong> {{party_b_address}}</p>\n  <p><strong>M\xe3 s\u1ed1 thu\u1ebf:</strong> {{party_b_tax_code}}</p>\n  <p><strong>Ng\u01b0\u1eddi \u0111\u1ea1i di\u1ec7n:</strong> {{party_b_representative}} - {{party_b_position}}</p>\n</div>\n\n<div class="contract-terms">\n  <h3>\u0110I\u1ec0U KHO\u1ea2N H\u1ee2P \u0110\u1ed2NG</h3>\n  \n  <h4>\u0110i\u1ec1u 1: \u0110\u1ed1i t\u01b0\u1ee3ng thu\xea</h4>\n  <p>B\xean A \u0111\u1ed3ng \xfd cho B\xean B thu\xea kho t\u1ea1i v\u1ecb tr\xed: <strong>{{warehouse_location}}</strong></p>\n  <p>Di\u1ec7n t\xedch: <strong>{{warehouse_area}} m\xb2</strong></p>\n  \n  <h4>\u0110i\u1ec1u 2: Th\u1eddi h\u1ea1n thu\xea</h4>\n  <p>T\u1eeb ng\xe0y: <strong>{{start_date}}</strong> \u0111\u1ebfn ng\xe0y: <strong>{{end_date}}</strong></p>\n  \n  <h4>\u0110i\u1ec1u 3: Gi\xe1 thu\xea v\xe0 thanh to\xe1n</h4>\n  <p>Gi\xe1 thu\xea: <strong>{{rental_price}} VN\u0110/th\xe1ng</strong></p>\n  <p>Ti\u1ec1n c\u1ecdc: <strong>{{deposit_amount}} VN\u0110</strong></p>\n  <p>Chu k\u1ef3 thanh to\xe1n: <strong>{{payment_cycle}}</strong></p>\n  <p>H\u1ea1n thanh to\xe1n: Tr\u01b0\u1edbc ng\xe0y <strong>{{payment_due_date}}</strong> h\xe0ng th\xe1ng</p>\n  \n  <h4>\u0110i\u1ec1u 4: M\u1ee5c \u0111\xedch s\u1eed d\u1ee5ng</h4>\n  <p>{{warehouse_purpose}}</p>\n  \n  <h4>\u0110i\u1ec1u 5: \u0110i\u1ec1u kho\u1ea3n \u0111\u1eb7c bi\u1ec7t</h4>\n  <p>{{special_terms}}</p>\n</div>\n\n<div class="contract-signature">\n  <div style="display: flex; justify-content: space-between; margin-top: 50px;">\n    <div style="text-align: center;">\n      <p><strong>B\xcaN A</strong></p>\n      <p>(K\xfd t\xean v\xe0 \u0111\xf3ng d\u1ea5u)</p>\n      <br><br><br>\n      <p>{{party_a_representative}}</p>\n    </div>\n    <div style="text-align: center;">\n      <p><strong>B\xcaN B</strong></p>\n      <p>(K\xfd t\xean v\xe0 \u0111\xf3ng d\u1ea5u)</p>\n      <br><br><br>\n      <p>{{party_b_representative}}</p>\n    </div>\n  </div>\n</div>\n  '})),k(!0)},children:[(0,f.jsx)("i",{className:"fas fa-plus me-2"}),"T\u1ea1o m\u1eabu m\u1edbi"]})]}),(0,f.jsxs)(j.A,{children:[(0,f.jsx)(j.A.Header,{children:(0,f.jsxs)("h5",{className:"mb-0",children:["Danh s\xe1ch m\u1eabu h\u1ee3p \u0111\u1ed3ng (",N.length,")"]})}),(0,f.jsx)(j.A.Body,{className:"p-0",children:i?(0,f.jsx)("div",{className:"text-center p-4",children:(0,f.jsx)(b.A,{})}):(0,f.jsxs)(p.A,{responsive:!0,hover:!0,className:"mb-0",children:[(0,f.jsx)("thead",{className:"table-light",children:(0,f.jsxs)("tr",{children:[(0,f.jsx)("th",{children:"T\xean m\u1eabu"}),(0,f.jsx)("th",{children:"M\xe3 m\u1eabu"}),(0,f.jsx)("th",{children:"Lo\u1ea1i"}),(0,f.jsx)("th",{children:"Phi\xean b\u1ea3n"}),(0,f.jsx)("th",{children:"Tr\u1ea1ng th\xe1i"}),(0,f.jsx)("th",{children:"S\u1eed d\u1ee5ng"}),(0,f.jsx)("th",{children:"Ng\u01b0\u1eddi t\u1ea1o"}),(0,f.jsx)("th",{children:"Ng\xe0y t\u1ea1o"}),(0,f.jsx)("th",{children:"Thao t\xe1c"})]})}),(0,f.jsx)("tbody",{children:N.map(t=>(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{children:(0,f.jsxs)("div",{children:[(0,f.jsx)("strong",{children:t.template_name}),t.is_default&&(0,f.jsx)(u.A,{bg:"primary",className:"ms-2",children:"M\u1eb7c \u0111\u1ecbnh"})]})}),(0,f.jsx)("td",{children:(0,f.jsx)("code",{children:t.template_code})}),(0,f.jsx)("td",{children:(0,f.jsx)(u.A,{bg:"info",children:"warehouse_rental"===t.template_type?"Thu\xea kho":"service_agreement"===t.template_type?"D\u1ecbch v\u1ee5":"Ph\u1ee5 l\u1ee5c"})}),(0,f.jsxs)("td",{children:["v",t.version]}),(0,f.jsx)("td",{children:(0,f.jsx)(u.A,{bg:t.is_active?"success":"secondary",children:t.is_active?"Ho\u1ea1t \u0111\u1ed9ng":"Ng\u01b0ng"})}),(0,f.jsx)("td",{children:(0,f.jsxs)(u.A,{bg:"secondary",children:[t.usage_count||0," l\u1ea7n"]})}),(0,f.jsx)("td",{children:t.created_by_name}),(0,f.jsx)("td",{children:new Date(t.created_at).toLocaleDateString("vi-VN")}),(0,f.jsx)("td",{children:(0,f.jsxs)("div",{className:"d-flex gap-1",children:[(0,f.jsx)(m.A,{variant:"outline-info",size:"sm",onClick:()=>(async e=>{try{const t=await y.A.getContractTemplate(e.id);B(t.data),D(!0)}catch(t){s("Kh\xf4ng th\u1ec3 t\u1ea3i chi ti\u1ebft m\u1eabu: "+t.message)}})(t),title:"Xem tr\u01b0\u1edbc",children:(0,f.jsx)("i",{className:"fas fa-eye"})}),e("contract_template_update")&&(0,f.jsx)(m.A,{variant:"outline-primary",size:"sm",onClick:()=>(e=>{G({template_name:e.template_name,template_code:e.template_code,template_type:e.template_type,template_content:e.template_content,variables:e.variables||[],version:e.version,is_active:e.is_active,is_default:e.is_default}),B(e),S(!0)})(t),title:"Ch\u1ec9nh s\u1eeda",children:(0,f.jsx)("i",{className:"fas fa-edit"})})]})})]},t.id))})]})})]})]})}),(0,f.jsxs)(g.A,{show:w||T,onHide:()=>{k(!1),S(!1),V()},size:"xl",scrollable:!0,children:[(0,f.jsx)(g.A.Header,{closeButton:!0,children:(0,f.jsx)(g.A.Title,{children:H?"Ch\u1ec9nh s\u1eeda m\u1eabu h\u1ee3p \u0111\u1ed3ng":"T\u1ea1o m\u1eabu h\u1ee3p \u0111\u1ed3ng m\u1edbi"})}),(0,f.jsx)(g.A.Body,{children:(0,f.jsxs)(v.A,{onSubmit:async e=>{e.preventDefault();try{H?(await y.A.updateContractTemplate(H.id,K),t("C\u1eadp nh\u1eadt m\u1eabu h\u1ee3p \u0111\u1ed3ng th\xe0nh c\xf4ng"),S(!1)):(await y.A.createContractTemplate(K),t("T\u1ea1o m\u1eabu h\u1ee3p \u0111\u1ed3ng th\xe0nh c\xf4ng"),k(!1)),q(),V()}catch(n){s("L\u1ed7i: "+n.message)}},children:[(0,f.jsxs)(A.A,{defaultActiveKey:"basic",className:"mb-3",children:[(0,f.jsxs)(r.A,{eventKey:"basic",title:"Th\xf4ng tin c\u01a1 b\u1ea3n",children:[(0,f.jsxs)(o.A,{children:[(0,f.jsx)(x.A,{md:6,children:(0,f.jsxs)(v.A.Group,{className:"mb-3",children:[(0,f.jsx)(v.A.Label,{children:"T\xean m\u1eabu *"}),(0,f.jsx)(v.A.Control,{type:"text",value:K.template_name,onChange:e=>G(t=>(0,d.A)((0,d.A)({},t),{},{template_name:e.target.value})),placeholder:"VD: H\u1ee3p \u0111\u1ed3ng thu\xea kho ti\xeau chu\u1ea9n",required:!0})]})}),(0,f.jsx)(x.A,{md:6,children:(0,f.jsxs)(v.A.Group,{className:"mb-3",children:[(0,f.jsx)(v.A.Label,{children:"M\xe3 m\u1eabu *"}),(0,f.jsx)(v.A.Control,{type:"text",value:K.template_code,onChange:e=>G(t=>(0,d.A)((0,d.A)({},t),{},{template_code:e.target.value.toUpperCase()})),placeholder:"VD: STANDARD_WAREHOUSE_RENTAL",required:!0})]})})]}),(0,f.jsxs)(o.A,{children:[(0,f.jsx)(x.A,{md:4,children:(0,f.jsxs)(v.A.Group,{className:"mb-3",children:[(0,f.jsx)(v.A.Label,{children:"Lo\u1ea1i m\u1eabu"}),(0,f.jsxs)(v.A.Select,{value:K.template_type,onChange:e=>G(t=>(0,d.A)((0,d.A)({},t),{},{template_type:e.target.value})),children:[(0,f.jsx)("option",{value:"warehouse_rental",children:"H\u1ee3p \u0111\u1ed3ng thu\xea kho"}),(0,f.jsx)("option",{value:"service_agreement",children:"H\u1ee3p \u0111\u1ed3ng d\u1ecbch v\u1ee5"}),(0,f.jsx)("option",{value:"amendment",children:"Ph\u1ee5 l\u1ee5c h\u1ee3p \u0111\u1ed3ng"})]})]})}),(0,f.jsx)(x.A,{md:4,children:(0,f.jsxs)(v.A.Group,{className:"mb-3",children:[(0,f.jsx)(v.A.Label,{children:"Phi\xean b\u1ea3n"}),(0,f.jsx)(v.A.Control,{type:"text",value:K.version,onChange:e=>G(t=>(0,d.A)((0,d.A)({},t),{},{version:e.target.value})),placeholder:"1.0"})]})}),(0,f.jsx)(x.A,{md:4,children:(0,f.jsxs)(v.A.Group,{className:"mb-3",children:[(0,f.jsx)(v.A.Label,{children:"T\xf9y ch\u1ecdn"}),(0,f.jsxs)("div",{children:[(0,f.jsx)(v.A.Check,{type:"checkbox",id:"is_active",label:"Ho\u1ea1t \u0111\u1ed9ng",checked:K.is_active,onChange:e=>G(t=>(0,d.A)((0,d.A)({},t),{},{is_active:e.target.checked}))}),(0,f.jsx)(v.A.Check,{type:"checkbox",id:"is_default",label:"M\u1eb7c \u0111\u1ecbnh",checked:K.is_default,onChange:e=>G(t=>(0,d.A)((0,d.A)({},t),{},{is_default:e.target.checked}))})]})]})})]})]}),(0,f.jsxs)(r.A,{eventKey:"variables",title:"Bi\u1ebfn (".concat(K.variables.length,")"),children:[(0,f.jsxs)("div",{className:"mb-3",children:[(0,f.jsx)("h5",{children:"Th\xeam bi\u1ebfn m\u1edbi"}),(0,f.jsxs)(o.A,{children:[(0,f.jsx)(x.A,{md:3,children:(0,f.jsx)(v.A.Control,{type:"text",placeholder:"T\xean bi\u1ebfn (VD: contract_number)",value:M.name,onChange:e=>z(t=>(0,d.A)((0,d.A)({},t),{},{name:e.target.value}))})}),(0,f.jsx)(x.A,{md:2,children:(0,f.jsxs)(v.A.Select,{value:M.type,onChange:e=>z(t=>(0,d.A)((0,d.A)({},t),{},{type:e.target.value})),children:[(0,f.jsx)("option",{value:"text",children:"Text"}),(0,f.jsx)("option",{value:"number",children:"Number"}),(0,f.jsx)("option",{value:"date",children:"Date"}),(0,f.jsx)("option",{value:"currency",children:"Currency"}),(0,f.jsx)("option",{value:"boolean",children:"Boolean"})]})}),(0,f.jsx)(x.A,{md:4,children:(0,f.jsx)(v.A.Control,{type:"text",placeholder:"M\xf4 t\u1ea3",value:M.description,onChange:e=>z(t=>(0,d.A)((0,d.A)({},t),{},{description:e.target.value}))})}),(0,f.jsx)(x.A,{md:2,children:(0,f.jsx)(v.A.Check,{type:"checkbox",label:"B\u1eaft bu\u1ed9c",checked:M.required,onChange:e=>z(t=>(0,d.A)((0,d.A)({},t),{},{required:e.target.checked}))})}),(0,f.jsx)(x.A,{md:1,children:(0,f.jsx)(m.A,{variant:"success",onClick:()=>{if(!M.name.trim())return;const e={name:M.name,type:M.type,required:M.required,description:M.description};G(t=>(0,d.A)((0,d.A)({},t),{},{variables:[...t.variables,e]})),z({name:"",type:"text",required:!0,description:""})},children:(0,f.jsx)("i",{className:"fas fa-plus"})})})]})]}),K.variables.length>0&&(0,f.jsxs)(p.A,{size:"sm",children:[(0,f.jsx)("thead",{children:(0,f.jsxs)("tr",{children:[(0,f.jsx)("th",{children:"T\xean bi\u1ebfn"}),(0,f.jsx)("th",{children:"Lo\u1ea1i"}),(0,f.jsx)("th",{children:"M\xf4 t\u1ea3"}),(0,f.jsx)("th",{children:"B\u1eaft bu\u1ed9c"}),(0,f.jsx)("th",{children:"Thao t\xe1c"})]})}),(0,f.jsx)("tbody",{children:K.variables.map((e,t)=>(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{children:(0,f.jsx)("code",{children:"{{".concat(e.name,"}}")})}),(0,f.jsx)("td",{children:(0,f.jsx)(u.A,{bg:"info",children:e.type})}),(0,f.jsx)("td",{children:e.description}),(0,f.jsx)("td",{children:e.required&&(0,f.jsx)(u.A,{bg:"warning",children:"B\u1eaft bu\u1ed9c"})}),(0,f.jsx)("td",{children:(0,f.jsx)(m.A,{variant:"outline-danger",size:"sm",onClick:()=>(e=>{G(t=>(0,d.A)((0,d.A)({},t),{},{variables:t.variables.filter((t,s)=>s!==e)}))})(t),children:(0,f.jsx)("i",{className:"fas fa-trash"})})})]},t))})]})]}),(0,f.jsx)(r.A,{eventKey:"content",title:"N\u1ed9i dung m\u1eabu",children:(0,f.jsxs)(v.A.Group,{className:"mb-3",children:[(0,f.jsx)(v.A.Label,{children:"N\u1ed9i dung HTML"}),(0,f.jsx)(v.A.Control,{as:"textarea",rows:20,value:K.template_content,onChange:e=>G(t=>(0,d.A)((0,d.A)({},t),{},{template_content:e.target.value})),placeholder:"Nh\u1eadp n\u1ed9i dung HTML cho m\u1eabu h\u1ee3p \u0111\u1ed3ng...",style:{fontFamily:"monospace",fontSize:"14px"}}),(0,f.jsxs)(v.A.Text,{className:"text-muted",children:["S\u1eed d\u1ee5ng c\xfa ph\xe1p ","{{variable_name}}"," \u0111\u1ec3 ch\xe8n bi\u1ebfn v\xe0o n\u1ed9i dung"]})]})})]}),(0,f.jsxs)("div",{className:"d-flex justify-content-end gap-2",children:[(0,f.jsx)(m.A,{variant:"secondary",onClick:()=>{k(!1),S(!1),V()},children:"H\u1ee7y"}),(0,f.jsxs)(m.A,{type:"submit",variant:"primary",children:[(0,f.jsx)("i",{className:"fas fa-save me-2"}),H?"C\u1eadp nh\u1eadt":"T\u1ea1o m\u1edbi"]})]})]})})]}),(0,f.jsxs)(g.A,{show:L,onHide:()=>D(!1),size:"xl",scrollable:!0,children:[(0,f.jsx)(g.A.Header,{closeButton:!0,children:(0,f.jsxs)(g.A.Title,{children:["Xem tr\u01b0\u1edbc m\u1eabu: ",null===H||void 0===H?void 0:H.template_name]})}),(0,f.jsx)(g.A.Body,{children:H&&(0,f.jsx)("div",{className:"border p-3",dangerouslySetInnerHTML:{__html:H.template_content}})})]})]}):(0,f.jsx)(a.A,{className:"mt-4",children:(0,f.jsx)(h.A,{variant:"warning",children:"B\u1ea1n kh\xf4ng c\xf3 quy\u1ec1n truy c\u1eadp qu\u1ea3n l\xfd m\u1eabu h\u1ee3p \u0111\u1ed3ng."})})};const C=function(){const{hasPermission:e}=(0,l.As)(),[t,s]=(0,n.useState)("contracts");return e("contract_read")?(0,f.jsx)("div",{className:"contracts-page",children:(0,f.jsxs)(r.A.Container,{activeKey:t,onSelect:s,children:[(0,f.jsx)(a.A,{fluid:!0,className:"bg-light border-bottom",children:(0,f.jsxs)(i.A,{variant:"tabs",className:"border-0",children:[(0,f.jsx)(i.A.Item,{children:(0,f.jsxs)(i.A.Link,{eventKey:"contracts",children:[(0,f.jsx)("i",{className:"fas fa-file-contract me-2"}),"Qu\u1ea3n l\xfd h\u1ee3p \u0111\u1ed3ng"]})}),e("contract_template_read")&&(0,f.jsx)(i.A.Item,{children:(0,f.jsxs)(i.A.Link,{eventKey:"templates",children:[(0,f.jsx)("i",{className:"fas fa-file-alt me-2"}),"M\u1eabu h\u1ee3p \u0111\u1ed3ng"]})})]})}),(0,f.jsxs)(r.A.Content,{children:[(0,f.jsx)(r.A.Pane,{eventKey:"contracts",children:(0,f.jsx)(c.default,{})}),(0,f.jsx)(r.A.Pane,{eventKey:"templates",children:(0,f.jsx)(N,{})})]})]})}):(0,f.jsx)(a.A,{className:"mt-4",children:(0,f.jsxs)("div",{className:"alert alert-warning",children:[(0,f.jsx)("i",{className:"fas fa-exclamation-triangle me-2"}),"B\u1ea1n kh\xf4ng c\xf3 quy\u1ec1n truy c\u1eadp qu\u1ea3n l\xfd h\u1ee3p \u0111\u1ed3ng."]})})}}}]);
//# sourceMappingURL=293.bd4f11cf.chunk.js.map