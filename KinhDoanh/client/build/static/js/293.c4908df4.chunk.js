"use strict";(self.webpackChunkkho_mvg_client=self.webpackChunkkho_mvg_client||[]).push([[293],{7293:(e,t,n)=>{n.r(t),n.d(t,{default:()=>T});var s=n(5043),a=n(3519),r=n(5328),i=n(326),c=n(5016),l=n(6392),h=n(9379),d=n(1719),o=n(1072),p=n(8602),m=n(4282),x=n(8628),u=n(4196),j=n(4063),g=n(2557),A=n(3722),v=n(9422),_=n(6471),y=n(7848),b=n(2550),N=n(579);const f=()=>{const{hasPermission:e}=(0,c.As)(),{showSuccess:t,showError:n}=(0,_.hN)(),[i,l]=(0,s.useState)(!0),[f,C]=(0,s.useState)([]),[T,k]=(0,s.useState)(!1),[H,w]=(0,s.useState)(!1),[B,S]=(0,s.useState)(null),[L,K]=(0,s.useState)(!1),[D,M]=(0,s.useState)({template_name:"",template_code:"",template_type:"warehouse_rental",template_content:"",variables:[],version:"1.0",is_active:!0,is_default:!1}),[q,G]=(0,s.useState)({name:"",type:"text",required:!0,description:""}),P=(0,s.useCallback)(async()=>{try{l(!0);const e=await y.A.getContractTemplates();C(e.data)}catch(e){n("Kh\xf4ng th\u1ec3 t\u1ea3i danh s\xe1ch m\u1eabu h\u1ee3p \u0111\u1ed3ng: "+e.message)}finally{l(!1)}},[n]);(0,s.useEffect)(()=>{e("contract_template_read")&&P()},[e,P]);const z=()=>{M({template_name:"",template_code:"",template_type:"warehouse_rental",template_content:"",variables:[],version:"1.0",is_active:!0,is_default:!1}),S(null)};return e("contract_template_read")?(0,N.jsxs)(a.A,{fluid:!0,className:"mt-4",children:[(0,N.jsx)(o.A,{children:(0,N.jsxs)(p.A,{children:[(0,N.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,N.jsxs)("h2",{children:[(0,N.jsx)("i",{className:"fas fa-file-alt me-2"}),"Qu\u1ea3n l\xfd m\u1eabu h\u1ee3p \u0111\u1ed3ng"]}),e("contract_template_create")&&(0,N.jsxs)(m.A,{variant:"primary",onClick:()=>{z(),M(e=>(0,h.A)((0,h.A)({},e),{},{template_content:'\n<div class="contract-header">\n  <h1 style="text-align: center;">H\u1ee2P \u0110\u1ed2NG THU\xca KHO</h1>\n  <p style="text-align: center;">S\u1ed1: {{contract_number}}</p>\n</div>\n\n<div class="contract-parties">\n  <h3>C\xc1C B\xcaN THAM GIA H\u1ee2P \u0110\u1ed2NG</h3>\n  \n  <h4>B\xcaN CHO THU\xca (B\xean A):</h4>\n  <p><strong>T\xean:</strong> {{party_a_name}}</p>\n  <p><strong>\u0110\u1ecba ch\u1ec9:</strong> {{party_a_address}}</p>\n  <p><strong>Ng\u01b0\u1eddi \u0111\u1ea1i di\u1ec7n:</strong> {{party_a_representative}} - {{party_a_position}}</p>\n  <p><strong>CMND/CCCD:</strong> {{party_a_id_number}}</p>\n  \n  <h4>B\xcaN THU\xca (B\xean B):</h4>\n  <p><strong>T\xean c\xf4ng ty:</strong> {{party_b_name}}</p>\n  <p><strong>\u0110\u1ecba ch\u1ec9:</strong> {{party_b_address}}</p>\n  <p><strong>M\xe3 s\u1ed1 thu\u1ebf:</strong> {{party_b_tax_code}}</p>\n  <p><strong>Ng\u01b0\u1eddi \u0111\u1ea1i di\u1ec7n:</strong> {{party_b_representative}} - {{party_b_position}}</p>\n</div>\n\n<div class="contract-terms">\n  <h3>\u0110I\u1ec0U KHO\u1ea2N H\u1ee2P \u0110\u1ed2NG</h3>\n  \n  <h4>\u0110i\u1ec1u 1: \u0110\u1ed1i t\u01b0\u1ee3ng thu\xea</h4>\n  <p>B\xean A \u0111\u1ed3ng \xfd cho B\xean B thu\xea kho t\u1ea1i v\u1ecb tr\xed: <strong>{{warehouse_location}}</strong></p>\n  <p>Di\u1ec7n t\xedch: <strong>{{warehouse_area}} m\xb2</strong></p>\n  \n  <h4>\u0110i\u1ec1u 2: Th\u1eddi h\u1ea1n thu\xea</h4>\n  <p>T\u1eeb ng\xe0y: <strong>{{start_date}}</strong> \u0111\u1ebfn ng\xe0y: <strong>{{end_date}}</strong></p>\n  \n  <h4>\u0110i\u1ec1u 3: Gi\xe1 thu\xea v\xe0 thanh to\xe1n</h4>\n  <p>Gi\xe1 thu\xea: <strong>{{rental_price}} VN\u0110/th\xe1ng</strong></p>\n  <p>Ti\u1ec1n c\u1ecdc: <strong>{{deposit_amount}} VN\u0110</strong></p>\n  <p>Chu k\u1ef3 thanh to\xe1n: <strong>{{payment_cycle}}</strong></p>\n  <p>H\u1ea1n thanh to\xe1n: Tr\u01b0\u1edbc ng\xe0y <strong>{{payment_due_date}}</strong> h\xe0ng th\xe1ng</p>\n  \n  <h4>\u0110i\u1ec1u 4: M\u1ee5c \u0111\xedch s\u1eed d\u1ee5ng</h4>\n  <p>{{warehouse_purpose}}</p>\n  \n  <h4>\u0110i\u1ec1u 5: \u0110i\u1ec1u kho\u1ea3n \u0111\u1eb7c bi\u1ec7t</h4>\n  <p>{{special_terms}}</p>\n</div>\n\n<div class="contract-signature">\n  <div style="display: flex; justify-content: space-between; margin-top: 50px;">\n    <div style="text-align: center;">\n      <p><strong>B\xcaN A</strong></p>\n      <p>(K\xfd t\xean v\xe0 \u0111\xf3ng d\u1ea5u)</p>\n      <br><br><br>\n      <p>{{party_a_representative}}</p>\n    </div>\n    <div style="text-align: center;">\n      <p><strong>B\xcaN B</strong></p>\n      <p>(K\xfd t\xean v\xe0 \u0111\xf3ng d\u1ea5u)</p>\n      <br><br><br>\n      <p>{{party_b_representative}}</p>\n    </div>\n  </div>\n</div>\n  '})),k(!0)},children:[(0,N.jsx)("i",{className:"fas fa-plus me-2"}),"T\u1ea1o m\u1eabu m\u1edbi"]})]}),(0,N.jsxs)(x.A,{children:[(0,N.jsx)(x.A.Header,{children:(0,N.jsxs)("h5",{className:"mb-0",children:["Danh s\xe1ch m\u1eabu h\u1ee3p \u0111\u1ed3ng (",f.length,")"]})}),(0,N.jsx)(x.A.Body,{className:"p-0",children:i?(0,N.jsx)("div",{className:"text-center p-4",children:(0,N.jsx)(b.A,{})}):(0,N.jsxs)(u.A,{responsive:!0,hover:!0,className:"mb-0",children:[(0,N.jsx)("thead",{className:"table-light",children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{children:"T\xean m\u1eabu"}),(0,N.jsx)("th",{children:"M\xe3 m\u1eabu"}),(0,N.jsx)("th",{children:"Lo\u1ea1i"}),(0,N.jsx)("th",{children:"Phi\xean b\u1ea3n"}),(0,N.jsx)("th",{children:"Tr\u1ea1ng th\xe1i"}),(0,N.jsx)("th",{children:"S\u1eed d\u1ee5ng"}),(0,N.jsx)("th",{children:"Ng\u01b0\u1eddi t\u1ea1o"}),(0,N.jsx)("th",{children:"Ng\xe0y t\u1ea1o"}),(0,N.jsx)("th",{children:"Thao t\xe1c"})]})}),(0,N.jsx)("tbody",{children:f.map(t=>(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:(0,N.jsxs)("div",{children:[(0,N.jsx)("strong",{children:t.template_name}),t.is_default&&(0,N.jsx)(j.A,{bg:"primary",className:"ms-2",children:"M\u1eb7c \u0111\u1ecbnh"})]})}),(0,N.jsx)("td",{children:(0,N.jsx)("code",{children:t.template_code})}),(0,N.jsx)("td",{children:(0,N.jsx)(j.A,{bg:"info",children:"warehouse_rental"===t.template_type?"Thu\xea kho":"service_agreement"===t.template_type?"D\u1ecbch v\u1ee5":"Ph\u1ee5 l\u1ee5c"})}),(0,N.jsxs)("td",{children:["v",t.version]}),(0,N.jsx)("td",{children:(0,N.jsx)(j.A,{bg:t.is_active?"success":"secondary",children:t.is_active?"Ho\u1ea1t \u0111\u1ed9ng":"Ng\u01b0ng"})}),(0,N.jsx)("td",{children:(0,N.jsxs)(j.A,{bg:"secondary",children:[t.usage_count||0," l\u1ea7n"]})}),(0,N.jsx)("td",{children:t.created_by_name}),(0,N.jsx)("td",{children:new Date(t.created_at).toLocaleDateString("vi-VN")}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{className:"d-flex gap-1",children:[(0,N.jsx)(m.A,{variant:"outline-info",size:"sm",onClick:()=>(async e=>{try{const t=await y.A.getContractTemplate(e.id);S(t.data),K(!0)}catch(t){n("Kh\xf4ng th\u1ec3 t\u1ea3i chi ti\u1ebft m\u1eabu: "+t.message)}})(t),title:"Xem tr\u01b0\u1edbc",children:(0,N.jsx)("i",{className:"fas fa-eye"})}),e("contract_template_update")&&(0,N.jsx)(m.A,{variant:"outline-primary",size:"sm",onClick:()=>(e=>{M({template_name:e.template_name,template_code:e.template_code,template_type:e.template_type,template_content:e.template_content,variables:e.variables||[],version:e.version,is_active:e.is_active,is_default:e.is_default}),S(e),w(!0)})(t),title:"Ch\u1ec9nh s\u1eeda",children:(0,N.jsx)("i",{className:"fas fa-edit"})})]})})]},t.id))})]})})]})]})}),(0,N.jsxs)(g.A,{show:T||H,onHide:()=>{k(!1),w(!1),z()},size:"xl",scrollable:!0,children:[(0,N.jsx)(g.A.Header,{closeButton:!0,children:(0,N.jsx)(g.A.Title,{children:B?"Ch\u1ec9nh s\u1eeda m\u1eabu h\u1ee3p \u0111\u1ed3ng":"T\u1ea1o m\u1eabu h\u1ee3p \u0111\u1ed3ng m\u1edbi"})}),(0,N.jsx)(g.A.Body,{children:(0,N.jsxs)(A.A,{onSubmit:async e=>{e.preventDefault();try{B?(await y.A.updateContractTemplate(B.id,D),t("C\u1eadp nh\u1eadt m\u1eabu h\u1ee3p \u0111\u1ed3ng th\xe0nh c\xf4ng"),w(!1)):(await y.A.createContractTemplate(D),t("T\u1ea1o m\u1eabu h\u1ee3p \u0111\u1ed3ng th\xe0nh c\xf4ng"),k(!1)),P(),z()}catch(s){n("L\u1ed7i: "+s.message)}},children:[(0,N.jsxs)(v.A,{defaultActiveKey:"basic",className:"mb-3",children:[(0,N.jsxs)(r.A,{eventKey:"basic",title:"Th\xf4ng tin c\u01a1 b\u1ea3n",children:[(0,N.jsxs)(o.A,{children:[(0,N.jsx)(p.A,{md:6,children:(0,N.jsxs)(A.A.Group,{className:"mb-3",children:[(0,N.jsx)(A.A.Label,{children:"T\xean m\u1eabu *"}),(0,N.jsx)(A.A.Control,{type:"text",value:D.template_name,onChange:e=>M(t=>(0,h.A)((0,h.A)({},t),{},{template_name:e.target.value})),placeholder:"VD: H\u1ee3p \u0111\u1ed3ng thu\xea kho ti\xeau chu\u1ea9n",required:!0})]})}),(0,N.jsx)(p.A,{md:6,children:(0,N.jsxs)(A.A.Group,{className:"mb-3",children:[(0,N.jsx)(A.A.Label,{children:"M\xe3 m\u1eabu *"}),(0,N.jsx)(A.A.Control,{type:"text",value:D.template_code,onChange:e=>M(t=>(0,h.A)((0,h.A)({},t),{},{template_code:e.target.value.toUpperCase()})),placeholder:"VD: STANDARD_WAREHOUSE_RENTAL",required:!0})]})})]}),(0,N.jsxs)(o.A,{children:[(0,N.jsx)(p.A,{md:4,children:(0,N.jsxs)(A.A.Group,{className:"mb-3",children:[(0,N.jsx)(A.A.Label,{children:"Lo\u1ea1i m\u1eabu"}),(0,N.jsxs)(A.A.Select,{value:D.template_type,onChange:e=>M(t=>(0,h.A)((0,h.A)({},t),{},{template_type:e.target.value})),children:[(0,N.jsx)("option",{value:"warehouse_rental",children:"H\u1ee3p \u0111\u1ed3ng thu\xea kho"}),(0,N.jsx)("option",{value:"service_agreement",children:"H\u1ee3p \u0111\u1ed3ng d\u1ecbch v\u1ee5"}),(0,N.jsx)("option",{value:"amendment",children:"Ph\u1ee5 l\u1ee5c h\u1ee3p \u0111\u1ed3ng"})]})]})}),(0,N.jsx)(p.A,{md:4,children:(0,N.jsxs)(A.A.Group,{className:"mb-3",children:[(0,N.jsx)(A.A.Label,{children:"Phi\xean b\u1ea3n"}),(0,N.jsx)(A.A.Control,{type:"text",value:D.version,onChange:e=>M(t=>(0,h.A)((0,h.A)({},t),{},{version:e.target.value})),placeholder:"1.0"})]})}),(0,N.jsx)(p.A,{md:4,children:(0,N.jsxs)(A.A.Group,{className:"mb-3",children:[(0,N.jsx)(A.A.Label,{children:"T\xf9y ch\u1ecdn"}),(0,N.jsxs)("div",{children:[(0,N.jsx)(A.A.Check,{type:"checkbox",id:"is_active",label:"Ho\u1ea1t \u0111\u1ed9ng",checked:D.is_active,onChange:e=>M(t=>(0,h.A)((0,h.A)({},t),{},{is_active:e.target.checked}))}),(0,N.jsx)(A.A.Check,{type:"checkbox",id:"is_default",label:"M\u1eb7c \u0111\u1ecbnh",checked:D.is_default,onChange:e=>M(t=>(0,h.A)((0,h.A)({},t),{},{is_default:e.target.checked}))})]})]})})]})]}),(0,N.jsxs)(r.A,{eventKey:"variables",title:"Bi\u1ebfn (".concat(D.variables.length,")"),children:[(0,N.jsxs)("div",{className:"mb-3",children:[(0,N.jsx)("h5",{children:"Th\xeam bi\u1ebfn m\u1edbi"}),(0,N.jsxs)(o.A,{children:[(0,N.jsx)(p.A,{md:3,children:(0,N.jsx)(A.A.Control,{type:"text",placeholder:"T\xean bi\u1ebfn (VD: contract_number)",value:q.name,onChange:e=>G(t=>(0,h.A)((0,h.A)({},t),{},{name:e.target.value}))})}),(0,N.jsx)(p.A,{md:2,children:(0,N.jsxs)(A.A.Select,{value:q.type,onChange:e=>G(t=>(0,h.A)((0,h.A)({},t),{},{type:e.target.value})),children:[(0,N.jsx)("option",{value:"text",children:"Text"}),(0,N.jsx)("option",{value:"number",children:"Number"}),(0,N.jsx)("option",{value:"date",children:"Date"}),(0,N.jsx)("option",{value:"currency",children:"Currency"}),(0,N.jsx)("option",{value:"boolean",children:"Boolean"})]})}),(0,N.jsx)(p.A,{md:4,children:(0,N.jsx)(A.A.Control,{type:"text",placeholder:"M\xf4 t\u1ea3",value:q.description,onChange:e=>G(t=>(0,h.A)((0,h.A)({},t),{},{description:e.target.value}))})}),(0,N.jsx)(p.A,{md:2,children:(0,N.jsx)(A.A.Check,{type:"checkbox",label:"B\u1eaft bu\u1ed9c",checked:q.required,onChange:e=>G(t=>(0,h.A)((0,h.A)({},t),{},{required:e.target.checked}))})}),(0,N.jsx)(p.A,{md:1,children:(0,N.jsx)(m.A,{variant:"success",onClick:()=>{if(!q.name.trim())return;const e={name:q.name,type:q.type,required:q.required,description:q.description};M(t=>(0,h.A)((0,h.A)({},t),{},{variables:[...t.variables,e]})),G({name:"",type:"text",required:!0,description:""})},children:(0,N.jsx)("i",{className:"fas fa-plus"})})})]})]}),D.variables.length>0&&(0,N.jsxs)(u.A,{size:"sm",children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{children:"T\xean bi\u1ebfn"}),(0,N.jsx)("th",{children:"Lo\u1ea1i"}),(0,N.jsx)("th",{children:"M\xf4 t\u1ea3"}),(0,N.jsx)("th",{children:"B\u1eaft bu\u1ed9c"}),(0,N.jsx)("th",{children:"Thao t\xe1c"})]})}),(0,N.jsx)("tbody",{children:D.variables.map((e,t)=>(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:(0,N.jsx)("code",{children:"{{".concat(e.name,"}}")})}),(0,N.jsx)("td",{children:(0,N.jsx)(j.A,{bg:"info",children:e.type})}),(0,N.jsx)("td",{children:e.description}),(0,N.jsx)("td",{children:e.required&&(0,N.jsx)(j.A,{bg:"warning",children:"B\u1eaft bu\u1ed9c"})}),(0,N.jsx)("td",{children:(0,N.jsx)(m.A,{variant:"outline-danger",size:"sm",onClick:()=>(e=>{M(t=>(0,h.A)((0,h.A)({},t),{},{variables:t.variables.filter((t,n)=>n!==e)}))})(t),children:(0,N.jsx)("i",{className:"fas fa-trash"})})})]},t))})]})]}),(0,N.jsx)(r.A,{eventKey:"content",title:"N\u1ed9i dung m\u1eabu",children:(0,N.jsxs)(A.A.Group,{className:"mb-3",children:[(0,N.jsx)(A.A.Label,{children:"N\u1ed9i dung HTML"}),(0,N.jsx)(A.A.Control,{as:"textarea",rows:20,value:D.template_content,onChange:e=>M(t=>(0,h.A)((0,h.A)({},t),{},{template_content:e.target.value})),placeholder:"Nh\u1eadp n\u1ed9i dung HTML cho m\u1eabu h\u1ee3p \u0111\u1ed3ng...",style:{fontFamily:"monospace",fontSize:"14px"}}),(0,N.jsxs)(A.A.Text,{className:"text-muted",children:["S\u1eed d\u1ee5ng c\xfa ph\xe1p ","{{variable_name}}"," \u0111\u1ec3 ch\xe8n bi\u1ebfn v\xe0o n\u1ed9i dung"]})]})})]}),(0,N.jsxs)("div",{className:"d-flex justify-content-end gap-2",children:[(0,N.jsx)(m.A,{variant:"secondary",onClick:()=>{k(!1),w(!1),z()},children:"H\u1ee7y"}),(0,N.jsxs)(m.A,{type:"submit",variant:"primary",children:[(0,N.jsx)("i",{className:"fas fa-save me-2"}),B?"C\u1eadp nh\u1eadt":"T\u1ea1o m\u1edbi"]})]})]})})]}),(0,N.jsxs)(g.A,{show:L,onHide:()=>K(!1),size:"xl",scrollable:!0,children:[(0,N.jsx)(g.A.Header,{closeButton:!0,children:(0,N.jsxs)(g.A.Title,{children:["Xem tr\u01b0\u1edbc m\u1eabu: ",null===B||void 0===B?void 0:B.template_name]})}),(0,N.jsx)(g.A.Body,{children:B&&(0,N.jsx)("div",{className:"border p-3",dangerouslySetInnerHTML:{__html:B.template_content}})})]})]}):(0,N.jsx)(a.A,{className:"mt-4",children:(0,N.jsx)(d.A,{variant:"warning",children:"B\u1ea1n kh\xf4ng c\xf3 quy\u1ec1n truy c\u1eadp qu\u1ea3n l\xfd m\u1eabu h\u1ee3p \u0111\u1ed3ng."})})};var C=n(3216);const T=function(){const e=(0,C.zy)(),t=new URLSearchParams(e.search),n=(e.pathname||"").endsWith("/contracts/create")||"1"===t.get("create")||"create"===t.get("open"),h=t.get("customer")||"",{hasPermission:d}=(0,c.As)(),[o,p]=(0,s.useState)("contracts");return d("contract_read")?(0,N.jsx)("div",{className:"contracts-page",children:(0,N.jsxs)(r.A.Container,{activeKey:o,onSelect:p,children:[(0,N.jsx)(a.A,{fluid:!0,className:"bg-light border-bottom",children:(0,N.jsxs)(i.A,{variant:"tabs",className:"border-0",children:[(0,N.jsx)(i.A.Item,{children:(0,N.jsxs)(i.A.Link,{eventKey:"contracts",children:[(0,N.jsx)("i",{className:"fas fa-file-contract me-2"}),"Qu\u1ea3n l\xfd h\u1ee3p \u0111\u1ed3ng"]})}),d("contract_template_read")&&(0,N.jsx)(i.A.Item,{children:(0,N.jsxs)(i.A.Link,{eventKey:"templates",children:[(0,N.jsx)("i",{className:"fas fa-file-alt me-2"}),"M\u1eabu h\u1ee3p \u0111\u1ed3ng"]})})]})}),(0,N.jsxs)(r.A.Content,{children:[(0,N.jsx)(r.A.Pane,{eventKey:"contracts",children:(0,N.jsx)(l.default,{initialOpenCreate:n,initialCustomerId:h})}),(0,N.jsx)(r.A.Pane,{eventKey:"templates",children:(0,N.jsx)(f,{})})]})]})}):(0,N.jsx)(a.A,{className:"mt-4",children:(0,N.jsxs)("div",{className:"alert alert-warning",children:[(0,N.jsx)("i",{className:"fas fa-exclamation-triangle me-2"}),"B\u1ea1n kh\xf4ng c\xf3 quy\u1ec1n truy c\u1eadp qu\u1ea3n l\xfd h\u1ee3p \u0111\u1ed3ng."]})})}}}]);
//# sourceMappingURL=293.c4908df4.chunk.js.map