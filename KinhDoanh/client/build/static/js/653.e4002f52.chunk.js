"use strict";(self.webpackChunkkho_mvg_client=self.webpackChunkkho_mvg_client||[]).push([[653],{730:(e,t,a)=>{a.d(t,{A:()=>s});const n="http://localhost:5001/api";const s=new class{async getAuthHeaders(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=localStorage.getItem("token");t?console.log("\u2705 Token found, length:",t.length):console.warn("\u26a0\ufe0f No token found in localStorage");const a={"Content-Type":"application/json",Authorization:"Bearer ".concat(t)};return e&&(a["Cache-Control"]="no-cache",a.Pragma="no-cache"),a}async handleResponse(e){const t=await e.json();if(!e.ok)throw console.error("\u274c CustomerService API Error:"),console.error("  Status:",e.status),console.error("  Status Text:",e.statusText),console.error("  Response Data:",t),400===e.status&&t.errors&&(console.error("  Validation Errors:"),t.errors.forEach(e=>{console.error("    - ".concat(e.path||e.param,": ").concat(e.msg))})),new Error(t.message||"HTTP error! status: ".concat(e.status));return t}async getCustomers(){const e=new URLSearchParams(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).toString(),t="".concat(n,"/customers").concat(e?"?".concat(e):""),a=await fetch(t,{method:"GET",headers:await this.getAuthHeaders(!0)});return this.handleResponse(a)}async getCustomer(e){const t=await fetch("".concat(n,"/customers/").concat(e),{method:"GET",headers:await this.getAuthHeaders()});return this.handleResponse(t)}async createCustomer(e){const t=await fetch("".concat(n,"/customers"),{method:"POST",headers:await this.getAuthHeaders(),body:JSON.stringify(e)});return this.handleResponse(t)}async updateCustomer(e,t){const a=await fetch("".concat(n,"/customers/").concat(e),{method:"PUT",headers:await this.getAuthHeaders(),body:JSON.stringify(t)});return this.handleResponse(a)}async deleteCustomer(e){const t=await fetch("".concat(n,"/customers/").concat(e),{method:"DELETE",headers:await this.getAuthHeaders()});return this.handleResponse(t)}async getCustomerContracts(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const a=new URLSearchParams(t?{status:t}:{}).toString(),s="".concat(n,"/customers/").concat(e,"/contracts").concat(a?"?".concat(a):""),r=await fetch(s,{method:"GET",headers:await this.getAuthHeaders()});return this.handleResponse(r)}async createContract(e){const t=await fetch("".concat(n,"/customers/contracts"),{method:"POST",headers:await this.getAuthHeaders(),body:JSON.stringify(e)});return this.handleResponse(t)}async getExpiringContracts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;const t=await fetch("".concat(n,"/customers/contracts/expiring?days=").concat(e),{method:"GET",headers:await this.getAuthHeaders()});return this.handleResponse(t)}async getCustomerStats(){const e=await fetch("".concat(n,"/customers/stats"),{method:"GET",headers:await this.getAuthHeaders()});return this.handleResponse(e)}}},1653:(e,t,a)=>{a.r(t),a.d(t,{default:()=>b});var n=a(9379),s=a(5043),r=a(2557),o=a(1719),c=a(1072),i=a(8602),l=a(3722),d=a(9422),h=a(5328),u=a(8628),m=a(4282),p=a(5016),g=a(6471),A=a(7848),v=a(730),_=a(9722);const y="".concat("http://localhost:5001/api","/projects"),x={async getProjects(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const t=localStorage.getItem("token");return(await _.A.get(y,{params:e,headers:t?{Authorization:"Bearer ".concat(t)}:void 0})).data}catch(t){console.error("Error fetching projects:",t);const e=t&&t.response&&t.response.data&&t.response.data.message||t.message||"Loi tai danh sach du an";throw new Error(e)}},async getZones(e){if(!e)return{zones:[]};try{const t=localStorage.getItem("token"),a=(await _.A.get("".concat(y,"/").concat(e,"/zones"),{headers:t?{Authorization:"Bearer ".concat(t)}:void 0})).data;return{zones:a&&a.data&&a.data.zones||a.zones||a||[]}}catch(t){console.error("Error fetching zones:",t);const e=t&&t.response&&t.response.data&&t.response.data.message||t.message||"Loi tai danh sach kho";throw new Error(e)}}};var j=a(579);const b=e=>{let{show:t,onHide:a,onSuccess:_,initialCustomerId:y=""}=e;const{user:b}=(0,p.As)(),{showSuccess:w,showError:f}=(0,g.hN)(),[S,C]=(0,s.useState)(!1),[N,T]=(0,s.useState)("basic"),[H,k]=(0,s.useState)([]),[G,R]=(0,s.useState)(!1),[L,E]=(0,s.useState)([]),[D,P]=(0,s.useState)([]),[O,V]=(0,s.useState)([]),[z,I]=(0,s.useState)(null),[q,J]=(0,s.useState)(null),[K,M]=(0,s.useState)(null),[B,F]=(0,s.useState)(null),[U,Y]=(0,s.useState)(!1),[X,Z]=(0,s.useState)(!1),[Q,W]=(0,s.useState)({contract_title:"",customer_id:"",customer_company_id:"",template_id:"",project_id:"",zone_id:"",party_a_name:"C\xd4NG TY KHO MVG",party_a_address:"Khu c\xf4ng nghi\u1ec7p ABC, B\xecnh D\u01b0\u01a1ng",party_a_representative:"Nguy\u1ec5n V\u0103n A",party_a_position:"Gi\xe1m \u0111\u1ed1c",party_a_id_number:"123456789",warehouse_location:"",warehouse_area:0,warehouse_purpose:"",rental_price:0,deposit_amount:0,service_fee:0,start_date:"",end_date:"",auto_renewal:!1,renewal_period:12,payment_cycle:"monthly",payment_due_date:5,payment_method:"Chuy\u1ec3n kho\u1ea3n",late_fee_percentage:2,special_terms:"",notes:"",assigned_to:(null===b||void 0===b?void 0:b.id)||"",variables:{}}),$=(0,s.useCallback)(async()=>{try{var e,t,a,s;C(!0);const[r,o,c]=await Promise.all([v.A.getCustomers({limit:100}),A.A.getContractTemplates({is_active:!0}),x.getProjects({limit:100})]);k((null===r||void 0===r||null===(e=r.data)||void 0===e?void 0:e.customers)||(null===r||void 0===r?void 0:r.customers)||[]),R(!0);const i=(null===o||void 0===o||null===(t=o.data)||void 0===t?void 0:t.templates)||(null===o||void 0===o?void 0:o.data)||(null===o||void 0===o?void 0:o.templates)||o||[];E(Array.isArray(i)?i:[]),Y(!0);const l=Array.isArray(i)&&i.find(e=>e.is_default);l&&(J(l),W(e=>(0,n.A)((0,n.A)({},e),{},{template_id:String(l.id)})));const d=(null===c||void 0===c||null===(a=c.data)||void 0===a?void 0:a.projects)||(null===c||void 0===c?void 0:c.projects)||(null===c||void 0===c?void 0:c.data)||[];P(Array.isArray(d)?d:Array.isArray(null===c||void 0===c||null===(s=c.data)||void 0===s?void 0:s.projects)?c.data.projects:[]),Z(!0)}catch(r){console.error("Error loading initial data:",r),f("Kh\xf4ng th\u1ec3 t\u1ea3i d\u1eef li\u1ec7u: "+r.message)}finally{C(!1)}},[f]);(0,s.useEffect)(()=>{t&&$()},[t,$]),(0,s.useEffect)(()=>{if(t&&!y)try{const e=new URLSearchParams(window.location.search),t=e.get("customer")||e.get("customer_id");t&&ee(t)}catch(e){}},[t,y]),(0,s.useEffect)(()=>{!async function(){if(!t||!y)return;if(H.some(e=>String(e.id)===String(y)))ee(y);else try{var e;const t=await v.A.getCustomer(y),a=(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.customer)||(null===t||void 0===t?void 0:t.data)||t;a&&a.id&&(k(e=>e.some(e=>String(e.id)===String(a.id))?e:[a,...e]),ee(a.id))}catch(a){console.warn("Could not preload initial customer",(null===a||void 0===a?void 0:a.message)||a)}}()},[t,y,H,G]),(0,s.useEffect)(()=>{!async function(){if(Q.project_id){const e=await x.getZones(Q.project_id);V(e.zones||[])}else V([])}()},[Q.project_id]);const ee=async e=>{try{var t;const a=H.find(t=>t.id===parseInt(e));if(!a)return;I(a);const s=await v.A.getCustomer(e),r=(null===s||void 0===s||null===(t=s.data)||void 0===t?void 0:t.customer)||(null===s||void 0===s?void 0:s.data)||s;W(t=>(0,n.A)((0,n.A)({},t),{},{customer_id:e,contract_title:"H\u1ee3p \u0111\u1ed3ng thu\xea kho - ".concat(r.name||r.full_name||"Kh\xe1ch h\xe0ng"),warehouse_purpose:r.warehouse_purpose||"L\u01b0u kho h\xe0ng h\xf3a",variables:(0,n.A)((0,n.A)({},t.variables),{},{party_b_name:r.name||r.full_name,party_b_address:r.address||"",party_b_representative:r.representative_name||r.full_name||"",party_b_position:"Gi\xe1m \u0111\u1ed1c",party_b_tax_code:r.tax_code||"",warehouse_purpose:r.warehouse_purpose||"L\u01b0u kho h\xe0ng h\xf3a",payment_cycle:"monthly"===t.payment_cycle?"H\xe0ng th\xe1ng":"quarterly"===t.payment_cycle?"H\xe0ng qu\xfd":"H\xe0ng n\u0103m",payment_due_date:t.payment_due_date})}))}catch(a){f("Kh\xf4ng th\u1ec3 t\u1ea3i th\xf4ng tin kh\xe1ch h\xe0ng: "+a.message)}},te=async e=>{e.preventDefault();try{C(!0),Q.variables.contract_number||(Q.variables.contract_number=(()=>{const e=new Date,t=e.getFullYear(),a=(e.getMonth()+1).toString().padStart(2,"0"),n=Math.floor(1e4*Math.random()).toString().padStart(4,"0");return"HD".concat(t).concat(a).concat(n)})());const e=await A.A.createContract(Q);w("T\u1ea1o h\u1ee3p \u0111\u1ed3ng th\xe0nh c\xf4ng"),null===_||void 0===_||_(e.data),a(),ae()}catch(t){f("L\u1ed7i t\u1ea1o h\u1ee3p \u0111\u1ed3ng: "+t.message)}finally{C(!1)}},ae=()=>{W({contract_title:"",customer_id:"",customer_company_id:"",template_id:"",project_id:"",zone_id:"",party_a_name:"C\xd4NG TY KHO MVG",party_a_address:"Khu c\xf4ng nghi\u1ec7p ABC, B\xecnh D\u01b0\u01a1ng",party_a_representative:"Nguy\u1ec5n V\u0103n A",party_a_position:"Gi\xe1m \u0111\u1ed1c",party_a_id_number:"123456789",warehouse_location:"",warehouse_area:0,warehouse_purpose:"",rental_price:0,deposit_amount:0,service_fee:0,start_date:"",end_date:"",auto_renewal:!1,renewal_period:12,payment_cycle:"monthly",payment_due_date:5,payment_method:"Chuy\u1ec3n kho\u1ea3n",late_fee_percentage:2,special_terms:"",notes:"",assigned_to:(null===b||void 0===b?void 0:b.id)||"",variables:{}}),I(null),J(null),M(null),F(null),T("basic")},ne=e=>new Intl.NumberFormat("vi-VN").format(e),se=e=>new Intl.NumberFormat("vi-VN").format(e)+" VN\u0110";return(0,j.jsxs)(r.A,{show:t,onHide:a,size:"xl",scrollable:!0,children:[(0,j.jsx)(r.A.Header,{closeButton:!0,children:(0,j.jsxs)(r.A.Title,{children:[(0,j.jsx)("i",{className:"fas fa-plus-circle me-2"}),"T\u1ea1o h\u1ee3p \u0111\u1ed3ng m\u1edbi"]})}),(0,j.jsxs)(r.A.Body,{children:[z&&(0,j.jsx)(o.A,{variant:"info",className:"mb-3",children:(0,j.jsxs)(c.A,{children:[(0,j.jsxs)(i.A,{md:4,children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("strong",{children:"Kh\xe1ch h\xe0ng:"})," ",z.name||z.full_name]}),z.customer_code&&(0,j.jsx)("div",{children:(0,j.jsxs)("small",{className:"text-muted",children:["M\xe3 KH: ",z.customer_code]})})]}),(0,j.jsxs)(i.A,{md:4,children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("strong",{children:"\u0110i\u1ec7n tho\u1ea1i:"})," ",z.phone||z.representative_phone||"\u2014"]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("strong",{children:"Email:"})," ",z.email||z.representative_email||"\u2014"]})]}),(0,j.jsx)(i.A,{md:4,children:(0,j.jsxs)("div",{children:[(0,j.jsx)("strong",{children:"\u0110\u1ecba ch\u1ec9:"})," ",z.address||"\u2014"]})})]})}),(0,j.jsxs)(l.A,{onSubmit:te,children:[(0,j.jsxs)(d.A,{activeKey:N,onSelect:T,className:"mb-3",children:[(0,j.jsx)(h.A,{eventKey:"basic",title:"Th\xf4ng tin h\u1ee3p \u0111\u1ed3ng",children:(0,j.jsxs)(c.A,{children:[(0,j.jsxs)(i.A,{md:6,children:[(0,j.jsxs)(l.A.Group,{className:"mb-3",children:[(0,j.jsx)(l.A.Label,{children:"Ch\u1ecdn kh\xe1ch h\xe0ng *"}),(0,j.jsxs)(l.A.Select,{value:Q.customer_id,onChange:e=>ee(e.target.value),required:!0,children:[(0,j.jsx)("option",{value:"",children:"-- Ch\u1ecdn kh\xe1ch h\xe0ng --"}),H.map(e=>(0,j.jsxs)("option",{value:e.id,children:[e.name||e.full_name||"Kh\xe1ch h\xe0ng"," ",e.customer_code?"(".concat(e.customer_code,")"):""]},e.id))]})]}),z&&(0,j.jsxs)(o.A,{variant:"info",children:[(0,j.jsx)("strong",{children:"Th\xf4ng tin kh\xe1ch h\xe0ng:"}),(0,j.jsx)("br",{}),(0,j.jsxs)("small",{children:["S\u0110T: ",z.phone,(0,j.jsx)("br",{}),"Email: ",z.email,(0,j.jsx)("br",{}),"\u0110\u1ecba ch\u1ec9: ",z.address]})]}),(0,j.jsxs)(l.A.Group,{className:"mb-3",children:[(0,j.jsx)(l.A.Label,{children:"Ch\u1ecdn d\u1ef1 \xe1n *"}),(0,j.jsxs)(l.A.Select,{value:Q.project_id||"",onChange:e=>{const t=e.target.value,a=D.find(e=>e.id===parseInt(t));M(a||null),W(e=>(0,n.A)((0,n.A)({},e),{},{project_id:t,zone_id:"",warehouse_location:""}))},required:!0,children:[(0,j.jsx)("option",{value:"",children:"-- Ch\u1ecdn d\u1ef1 \xe1n --"}),D.map(e=>(0,j.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,j.jsxs)(l.A.Group,{className:"mb-3",children:[(0,j.jsx)(l.A.Label,{children:"V\u1ecb tr\xed kho thu\xea *"}),(0,j.jsxs)(l.A.Select,{value:Q.zone_id||"",onChange:e=>{const t=e.target.value,a=O.find(e=>e.id===parseInt(t));W(e=>(0,n.A)((0,n.A)({},e),{},{zone_id:t,warehouse_location:a?"".concat(a.zone_name||a.zone_code," - ").concat((null===K||void 0===K?void 0:K.name)||""):"",variables:(0,n.A)((0,n.A)({},e.variables),{},{warehouse_location:a?"".concat(a.zone_name||a.zone_code," - ").concat((null===K||void 0===K?void 0:K.name)||""):""})})),F(a||null)},required:!0,disabled:!Q.project_id,children:[(0,j.jsx)("option",{value:"",children:"-- Ch\u1ecdn kho --"}),O.map(e=>(0,j.jsxs)("option",{value:e.id,children:[e.zone_name," (",e.zone_code,")"]},e.id))]})]})]}),(0,j.jsxs)(i.A,{md:6,children:[(0,j.jsxs)(l.A.Group,{className:"mb-3",children:[(0,j.jsx)(l.A.Label,{children:"Ch\u1ecdn m\u1eabu h\u1ee3p \u0111\u1ed3ng *"}),(0,j.jsxs)(l.A.Select,{value:Q.template_id,onChange:e=>(t=>{if(!t)return J(null),void W(e=>(0,n.A)((0,n.A)({},e),{},{template_id:""}));const a=L.find(e=>e.id===parseInt(t));if(a&&(J(a),W(e=>(0,n.A)((0,n.A)({},e),{},{template_id:t})),a.variables)){let t=[];try{t="string"===typeof a.variables?JSON.parse(a.variables):Array.isArray(a.variables)?a.variables:[]}catch(e){console.warn("Invalid template variables JSON:",(null===e||void 0===e?void 0:e.message)||e),t=[]}const s=(0,n.A)({},Q.variables);t.forEach(e=>{if(!s[e.name])switch(e.name){case"party_a_name":s[e.name]=Q.party_a_name;break;case"party_a_representative":s[e.name]=Q.party_a_representative;break;case"start_date":s[e.name]=Q.start_date;break;case"end_date":s[e.name]=Q.end_date;break;case"warehouse_location":s[e.name]=Q.warehouse_location;break;case"rental_price":s[e.name]=Q.rental_price.toLocaleString("vi-VN")+" VN\u0110";break;default:s[e.name]=""}}),W(e=>(0,n.A)((0,n.A)({},e),{},{variables:s})),T("variables")}})(e.target.value),required:!0,children:[(0,j.jsx)("option",{value:"",children:"-- Ch\u1ecdn m\u1eabu h\u1ee3p \u0111\u1ed3ng --"}),L.map(e=>(0,j.jsxs)("option",{value:e.id,children:[e.template_name,e.is_default&&" (M\u1eb7c \u0111\u1ecbnh)"]},e.id))]})]}),q&&(0,j.jsxs)(o.A,{variant:"success",children:[(0,j.jsx)("strong",{children:"M\u1eabu \u0111\xe3 ch\u1ecdn:"}),(0,j.jsx)("br",{}),(0,j.jsxs)("small",{children:["M\xe3: ",q.template_code,(0,j.jsx)("br",{}),"Phi\xean b\u1ea3n: ",q.version,(0,j.jsx)("br",{}),"Lo\u1ea1i: ",q.template_type]})]}),(0,j.jsxs)(l.A.Group,{className:"mb-3",children:[(0,j.jsx)(l.A.Label,{children:"Ti\xeau \u0111\u1ec1 h\u1ee3p \u0111\u1ed3ng *"}),(0,j.jsx)(l.A.Control,{type:"text",value:Q.contract_title,onChange:e=>W(t=>(0,n.A)((0,n.A)({},t),{},{contract_title:e.target.value})),placeholder:"VD: H\u1ee3p \u0111\u1ed3ng thu\xea kho - C\xf4ng ty ABC",required:!0})]}),(0,j.jsxs)(c.A,{children:[(0,j.jsx)(i.A,{md:6,children:(0,j.jsxs)(l.A.Group,{className:"mb-3",children:[(0,j.jsx)(l.A.Label,{children:"Di\u1ec7n t\xedch (m\xb2) *"}),(0,j.jsx)(l.A.Control,{type:"number",step:"0.1",min:"0",value:Q.warehouse_area,onChange:e=>{const t=parseFloat(e.target.value)||0;W(e=>(0,n.A)((0,n.A)({},e),{},{warehouse_area:t,variables:(0,n.A)((0,n.A)({},e.variables),{},{warehouse_area:t})}))},required:!0})]})}),(0,j.jsx)(i.A,{md:6,children:(0,j.jsxs)(l.A.Group,{className:"mb-3",children:[(0,j.jsx)(l.A.Label,{children:"Gi\xe1 thu\xea/th\xe1ng (VN\u0110) *"}),(0,j.jsx)(l.A.Control,{type:"text",value:Q.rental_price?ne(Q.rental_price):"",onChange:e=>{const t=e.target.value.replace(/\D/g,""),a=parseInt(t)||0;W(e=>(0,n.A)((0,n.A)({},e),{},{rental_price:a,variables:(0,n.A)((0,n.A)({},e.variables),{},{rental_price:se(a)})}))},placeholder:"VD: 10,000,000",required:!0}),Q.rental_price>0&&Q.warehouse_area>0&&(0,j.jsxs)(l.A.Text,{className:"text-muted",children:["Gi\xe1/m\xb2: ",ne(Math.round(Q.rental_price/Q.warehouse_area))," VN\u0110/m\xb2"]})]})})]}),(0,j.jsxs)(c.A,{children:[(0,j.jsx)(i.A,{md:6,children:(0,j.jsxs)(l.A.Group,{className:"mb-3",children:[(0,j.jsx)(l.A.Label,{children:"Ti\u1ec1n c\u1ecdc (VN\u0110)"}),(0,j.jsx)(l.A.Control,{type:"text",value:Q.deposit_amount?ne(Q.deposit_amount):"",onChange:e=>{const t=e.target.value.replace(/\D/g,""),a=parseInt(t)||0;W(e=>(0,n.A)((0,n.A)({},e),{},{deposit_amount:a,variables:(0,n.A)((0,n.A)({},e.variables),{},{deposit_amount:se(a)})}))},placeholder:"VD: 5,000,000"})]})}),(0,j.jsx)(i.A,{md:6,children:(0,j.jsxs)(l.A.Group,{className:"mb-3",children:[(0,j.jsx)(l.A.Label,{children:"Ph\xed d\u1ecbch v\u1ee5 (VN\u0110)"}),(0,j.jsx)(l.A.Control,{type:"text",value:Q.service_fee?ne(Q.service_fee):"",onChange:e=>{const t=e.target.value.replace(/\D/g,""),a=parseInt(t)||0;W(e=>(0,n.A)((0,n.A)({},e),{},{service_fee:a,variables:(0,n.A)((0,n.A)({},e.variables),{},{service_fee:se(a)})}))},placeholder:"VD: 500,000"})]})})]}),(0,j.jsxs)(c.A,{children:[(0,j.jsx)(i.A,{md:6,children:(0,j.jsxs)(l.A.Group,{className:"mb-3",children:[(0,j.jsx)(l.A.Label,{children:"Ng\xe0y b\u1eaft \u0111\u1ea7u *"}),(0,j.jsx)(l.A.Control,{type:"date",value:Q.start_date,onChange:e=>{const t=e.target.value,a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;const a=new Date(e),n=new Date(a);return n.setMonth(n.getMonth()+t),n.toISOString().split("T")[0]}(t,Q.renewal_period);W(e=>(0,n.A)((0,n.A)({},e),{},{start_date:t,end_date:a,variables:(0,n.A)((0,n.A)({},e.variables),{},{start_date:new Date(t).toLocaleDateString("vi-VN"),end_date:new Date(a).toLocaleDateString("vi-VN")})}))},required:!0})]})}),(0,j.jsx)(i.A,{md:6,children:(0,j.jsxs)(l.A.Group,{className:"mb-3",children:[(0,j.jsx)(l.A.Label,{children:"Ng\xe0y k\u1ebft th\xfac *"}),(0,j.jsx)(l.A.Control,{type:"date",value:Q.end_date,onChange:e=>{const t=e.target.value;W(e=>(0,n.A)((0,n.A)({},e),{},{end_date:t,variables:(0,n.A)((0,n.A)({},e.variables),{},{end_date:new Date(t).toLocaleDateString("vi-VN")})}))},min:Q.start_date,required:!0})]})})]}),(0,j.jsxs)(l.A.Group,{className:"mb-3",children:[(0,j.jsx)(l.A.Label,{children:"Chu k\u1ef3 thanh to\xe1n"}),(0,j.jsxs)(l.A.Select,{value:Q.payment_cycle,onChange:e=>W(t=>(0,n.A)((0,n.A)({},t),{},{payment_cycle:e.target.value,variables:(0,n.A)((0,n.A)({},t.variables),{},{payment_cycle:"monthly"===e.target.value?"H\xe0ng th\xe1ng":"quarterly"===e.target.value?"H\xe0ng qu\xfd":"H\xe0ng n\u0103m"})})),children:[(0,j.jsx)("option",{value:"monthly",children:"H\xe0ng th\xe1ng"}),(0,j.jsx)("option",{value:"quarterly",children:"H\xe0ng qu\xfd"}),(0,j.jsx)("option",{value:"yearly",children:"H\xe0ng n\u0103m"})]})]}),(0,j.jsxs)(c.A,{children:[(0,j.jsx)(i.A,{md:6,children:(0,j.jsxs)(l.A.Group,{className:"mb-3",children:[(0,j.jsx)(l.A.Label,{children:"H\u1ea1n thanh to\xe1n (ng\xe0y)"}),(0,j.jsx)(l.A.Control,{type:"number",min:"1",max:"31",value:Q.payment_due_date,onChange:e=>{const t=parseInt(e.target.value)||5;W(e=>(0,n.A)((0,n.A)({},e),{},{payment_due_date:t,variables:(0,n.A)((0,n.A)({},e.variables),{},{payment_due_date:t})}))}})]})}),(0,j.jsx)(i.A,{md:6,children:(0,j.jsxs)(l.A.Group,{className:"mb-3",children:[(0,j.jsx)(l.A.Label,{children:"Ph\xed tr\u1ec5 h\u1ea1n (%)"}),(0,j.jsx)(l.A.Control,{type:"number",step:"0.1",min:"0",max:"10",value:Q.late_fee_percentage,onChange:e=>W(t=>(0,n.A)((0,n.A)({},t),{},{late_fee_percentage:parseFloat(e.target.value)||2}))})]})})]}),(0,j.jsx)(l.A.Group,{className:"mb-3",children:(0,j.jsx)(l.A.Check,{type:"checkbox",id:"auto_renewal",label:"T\u1ef1 \u0111\u1ed9ng gia h\u1ea1n",checked:Q.auto_renewal,onChange:e=>W(t=>(0,n.A)((0,n.A)({},t),{},{auto_renewal:e.target.checked}))})}),(0,j.jsxs)(l.A.Group,{className:"mb-3",children:[(0,j.jsx)(l.A.Label,{children:"M\u1ee5c \u0111\xedch s\u1eed d\u1ee5ng kho"}),(0,j.jsx)(l.A.Control,{type:"text",value:Q.warehouse_purpose,onChange:e=>{const t=e.target.value;W(e=>(0,n.A)((0,n.A)({},e),{},{warehouse_purpose:t,variables:(0,n.A)((0,n.A)({},e.variables),{},{warehouse_purpose:t})}))},placeholder:"VD: L\u01b0u kho h\xe0ng h\xf3a, S\u1ea3n xu\u1ea5t, Ph\xe2n ph\u1ed1i..."})]}),(0,j.jsxs)(l.A.Group,{className:"mb-3",children:[(0,j.jsx)(l.A.Label,{children:"\u0110i\u1ec1u kho\u1ea3n \u0111\u1eb7c bi\u1ec7t"}),(0,j.jsx)(l.A.Control,{as:"textarea",rows:3,value:Q.special_terms,onChange:e=>{const t=e.target.value;W(e=>(0,n.A)((0,n.A)({},e),{},{special_terms:t,variables:(0,n.A)((0,n.A)({},e.variables),{},{special_terms:t})}))},placeholder:"C\xe1c \u0111i\u1ec1u kho\u1ea3n \u0111\u1eb7c bi\u1ec7t kh\xe1c..."})]})]})]})}),(0,j.jsx)(h.A,{eventKey:"variables",title:"Bi\u1ebfn m\u1eabu",disabled:!q,children:q&&q.variables&&(0,j.jsxs)("div",{children:[(0,j.jsxs)(o.A,{variant:"info",children:[(0,j.jsx)("i",{className:"fas fa-info-circle me-2"}),"C\xe1c bi\u1ebfn n\xe0y s\u1ebd \u0111\u01b0\u1ee3c thay th\u1ebf trong n\u1ed9i dung h\u1ee3p \u0111\u1ed3ng cu\u1ed1i c\xf9ng."]}),(0,j.jsx)(c.A,{children:(()=>{let e=[];try{e="string"===typeof q.variables?JSON.parse(q.variables):Array.isArray(q.variables)?q.variables:[]}catch(t){e=[]}return e})().map(e=>(0,j.jsx)(i.A,{md:6,children:(0,j.jsxs)(l.A.Group,{className:"mb-3",children:[(0,j.jsxs)(l.A.Label,{children:[e.description||e.name,e.required&&(0,j.jsx)("span",{className:"text-danger",children:"*"})]}),"boolean"===e.type?(0,j.jsx)(l.A.Check,{type:"checkbox",checked:"true"===Q.variables[e.name],onChange:t=>W(a=>(0,n.A)((0,n.A)({},a),{},{variables:(0,n.A)((0,n.A)({},a.variables),{},{[e.name]:t.target.checked.toString()})}))}):(0,j.jsx)(l.A.Control,{type:"date"===e.type?"date":"number"===e.type?"number":"text",value:Q.variables[e.name]||"",onChange:t=>W(a=>(0,n.A)((0,n.A)({},a),{},{variables:(0,n.A)((0,n.A)({},a.variables),{},{[e.name]:t.target.value})})),required:e.required,placeholder:"{{".concat(e.name,"}}")}),(0,j.jsxs)(l.A.Text,{className:"text-muted",children:["Bi\u1ebfn: ",(0,j.jsx)("code",{children:"{{".concat(e.name,"}}")})]})]})},e.name))})]})}),(0,j.jsx)(h.A,{eventKey:"preview",title:"Xem tr\u01b0\u1edbc",disabled:!q,children:q&&(0,j.jsxs)("div",{children:[(0,j.jsxs)(o.A,{variant:"success",children:[(0,j.jsx)("i",{className:"fas fa-eye me-2"}),"Xem tr\u01b0\u1edbc n\u1ed9i dung h\u1ee3p \u0111\u1ed3ng v\u1edbi d\u1eef li\u1ec7u \u0111\xe3 nh\u1eadp"]}),(0,j.jsx)(u.A,{children:(0,j.jsx)(u.A.Body,{children:(0,j.jsx)("div",{className:"contract-preview",dangerouslySetInnerHTML:{__html:String((null===q||void 0===q?void 0:q.template_content)||"").replace(/\{\{(\w+)\}\}/g,(e,t)=>Q.variables[t]||"[".concat(t,"]"))},style:{border:"1px solid #ddd",padding:"20px",backgroundColor:"white",fontFamily:"Times New Roman, serif"}})})})]})})]}),Q.customer_id&&Q.template_id&&(0,j.jsx)(o.A,{variant:"light",children:(0,j.jsxs)(c.A,{children:[(0,j.jsxs)(i.A,{md:3,children:[(0,j.jsx)("strong",{children:"Kh\xe1ch h\xe0ng:"}),(0,j.jsx)("br",{}),(null===z||void 0===z?void 0:z.name)||(null===z||void 0===z?void 0:z.full_name)]}),(0,j.jsxs)(i.A,{md:3,children:[(0,j.jsx)("strong",{children:"M\u1eabu h\u1ee3p \u0111\u1ed3ng:"}),(0,j.jsx)("br",{}),null===q||void 0===q?void 0:q.template_name]}),(0,j.jsxs)(i.A,{md:3,children:[(0,j.jsx)("strong",{children:"Di\u1ec7n t\xedch:"}),(0,j.jsx)("br",{}),Q.warehouse_area," m\xb2"]}),(0,j.jsxs)(i.A,{md:3,children:[(0,j.jsx)("strong",{children:"Gi\xe1 thu\xea:"}),(0,j.jsx)("br",{}),ne(Q.rental_price)," VN\u0110/th\xe1ng"]})]})})]})]}),(0,j.jsxs)(r.A.Footer,{children:[(0,j.jsx)(m.A,{variant:"secondary",onClick:a,disabled:S,children:"H\u1ee7y"}),(0,j.jsx)(m.A,{variant:"primary",onClick:te,disabled:S||!Q.customer_id||!Q.template_id,children:S?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("span",{className:"spinner-border spinner-border-sm me-2"}),"\u0110ang t\u1ea1o..."]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("i",{className:"fas fa-save me-2"}),"T\u1ea1o h\u1ee3p \u0111\u1ed3ng"]})})]})]})}},7848:(e,t,a)=>{a.d(t,{A:()=>s});const n="http://localhost:5001/api";const s=new class{async getAuthHeaders(){const e=localStorage.getItem("token");return{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}async handleResponse(e){if((e.headers.get("content-type")||"").includes("application/json")){const t=await e.json();if(!e.ok)throw new Error(t.message||"HTTP error! status: ".concat(e.status));return t}const t=await e.text();if(!e.ok){const a=t.replace(/<[^>]+>/g,"").trim(),n=a||"HTTP error! status: ".concat(e.status);throw new Error(n)}return{success:!0,data:t}}async getContracts(){const e=new URLSearchParams(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).toString(),t="".concat(n,"/contracts").concat(e?"?".concat(e):""),a=await fetch(t,{method:"GET",headers:await this.getAuthHeaders()});return this.handleResponse(a)}async getContract(e){const t=await fetch("".concat(n,"/contracts/").concat(e),{method:"GET",headers:await this.getAuthHeaders()});return this.handleResponse(t)}async createContract(e){const t=await fetch("".concat(n,"/contracts"),{method:"POST",headers:await this.getAuthHeaders(),body:JSON.stringify(e)});return this.handleResponse(t)}async updateContract(e,t){const a=await fetch("".concat(n,"/contracts/").concat(e),{method:"PUT",headers:await this.getAuthHeaders(),body:JSON.stringify(t)});return this.handleResponse(a)}async updateContractStatus(e,t){const a=await fetch("".concat(n,"/contracts/").concat(e,"/status"),{method:"PATCH",headers:await this.getAuthHeaders(),body:JSON.stringify(t)});return this.handleResponse(a)}async getContractTemplates(){const e=new URLSearchParams(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).toString(),t="".concat(n,"/contract-templates").concat(e?"?".concat(e):""),a=await fetch(t,{method:"GET",headers:await this.getAuthHeaders()});return this.handleResponse(a)}async getContractTemplate(e){const t=await fetch("".concat(n,"/contract-templates/").concat(e),{method:"GET",headers:await this.getAuthHeaders()});return this.handleResponse(t)}async createContractTemplate(e){const t=await fetch("".concat(n,"/contract-templates"),{method:"POST",headers:await this.getAuthHeaders(),body:JSON.stringify(e)});return this.handleResponse(t)}async generateDocumentFromTemplate(e,t){const a=await fetch("".concat(n,"/contract-templates/").concat(e,"/generate"),{method:"POST",headers:await this.getAuthHeaders(),body:JSON.stringify(t)});return this.handleResponse(a)}async getDocumentCategories(){const e=await fetch("".concat(n,"/contract-documents/categories"),{method:"GET",headers:await this.getAuthHeaders()});return this.handleResponse(e)}async getContractDocuments(e){const t=new URLSearchParams(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).toString(),a="".concat(n,"/contract-documents/").concat(e).concat(t?"?".concat(t):""),s=await fetch(a,{method:"GET",headers:await this.getAuthHeaders()});return this.handleResponse(s)}async getDocument(e){const t=await fetch("".concat(n,"/contract-documents/document/").concat(e),{method:"GET",headers:await this.getAuthHeaders()});return this.handleResponse(t)}async createDocument(e){const t=await fetch("".concat(n,"/contract-documents"),{method:"POST",headers:await this.getAuthHeaders(),body:JSON.stringify(e)});return this.handleResponse(t)}async updateDocument(e,t){const a=await fetch("".concat(n,"/contract-documents/").concat(e),{method:"PUT",headers:await this.getAuthHeaders(),body:JSON.stringify(t)});return this.handleResponse(a)}async createDocumentVersion(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=await fetch("".concat(n,"/contract-documents/").concat(e,"/create-version"),{method:"POST",headers:await this.getAuthHeaders(),body:JSON.stringify(t)});return this.handleResponse(a)}async submitForReview(e,t){const a=await fetch("".concat(n,"/contracts/").concat(e,"/submit-review"),{method:"POST",headers:await this.getAuthHeaders(),body:JSON.stringify(t)});return this.handleResponse(a)}async addReview(e,t){const a=await fetch("".concat(n,"/contracts/").concat(e,"/reviews"),{method:"POST",headers:await this.getAuthHeaders(),body:JSON.stringify(t)});return this.handleResponse(a)}async getContractStats(){const e=new URLSearchParams(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).toString(),t="".concat(n,"/contracts/stats").concat(e?"?".concat(e):""),a=await fetch(t,{method:"GET",headers:await this.getAuthHeaders()});return this.handleResponse(a)}}}}]);
//# sourceMappingURL=653.e4002f52.chunk.js.map