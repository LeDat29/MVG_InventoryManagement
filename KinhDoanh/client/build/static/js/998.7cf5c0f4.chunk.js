"use strict";(self.webpackChunkkho_mvg_client=self.webpackChunkkho_mvg_client||[]).push([[998],{4998:(e,n,a)=>{a.r(n),a.d(n,{default:()=>A});var s=a(9379),t=a(5043),r=a(5328),c=a(326),i=a(4282),l=a(8628),o=a(1072),h=a(8602),d=a(3722),m=a(7994),u=a(1719),x=a(579);const p=function(e){let{data:n,errors:a,touched:t,onDataChange:r,onGenerateCode:c}=e;const p=e=>{const{name:a,value:t}=e.target,c=(0,s.A)((0,s.A)({},n),{},{[a]:t});r(c)};return(0,x.jsxs)(l.A,{children:[(0,x.jsx)(l.A.Header,{children:(0,x.jsxs)("h5",{className:"mb-0",children:[(0,x.jsx)("i",{className:"fas fa-user me-2"}),"Th\xf4ng tin c\xe1 nh\xe2n c\u01a1 b\u1ea3n"]})}),(0,x.jsxs)(l.A.Body,{children:[(0,x.jsxs)(o.A,{children:[(0,x.jsx)(h.A,{md:6,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"Lo\u1ea1i kh\xe1ch h\xe0ng *"}),(0,x.jsxs)(d.A.Select,{name:"customer_type",value:n.customer_type,onChange:p,children:[(0,x.jsx)("option",{value:"individual",children:"C\xe1 nh\xe2n (CN)"}),(0,x.jsx)("option",{value:"company",children:"Doanh nghi\u1ec7p (DN)"})]}),(0,x.jsx)(d.A.Text,{className:"text-muted",children:"M\xe3 kh\xe1ch h\xe0ng s\u1ebd b\u1eaft \u0111\u1ea7u b\u1eb1ng CN (C\xe1 nh\xe2n) ho\u1eb7c DN (Doanh nghi\u1ec7p)"})]})}),(0,x.jsx)(h.A,{md:6,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"M\xe3 kh\xe1ch h\xe0ng *"}),(0,x.jsxs)(m.A,{children:[(0,x.jsx)(d.A.Control,{type:"text",name:"customer_code",value:n.customer_code,onChange:p,placeholder:"VD: ".concat("individual"===n.customer_type?"CN":"DN","123456"),isInvalid:t.customer_code&&a.customer_code}),(0,x.jsx)(i.A,{variant:"outline-secondary",onClick:c,title:"T\u1ef1 \u0111\u1ed9ng t\u1ea1o m\xe3",children:(0,x.jsx)("i",{className:"fas fa-magic"})})]}),t.customer_code&&a.customer_code&&(0,x.jsx)("div",{className:"invalid-feedback d-block",children:a.customer_code}),(0,x.jsx)(d.A.Text,{className:"text-muted",children:"Format: 2 k\xfd t\u1ef1 ph\xe2n lo\u1ea1i + 6 k\xfd t\u1ef1 s\u1ed1 t\u1ef1 \u0111\u1ed9ng"})]})})]}),(0,x.jsxs)(o.A,{children:[(0,x.jsx)(h.A,{md:8,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"H\u1ecd v\xe0 t\xean \u0111\u1ea7y \u0111\u1ee7 *"}),(0,x.jsx)(d.A.Control,{type:"text",name:"full_name",value:n.full_name,onChange:p,placeholder:"Nh\u1eadp h\u1ecd t\xean \u0111\u1ea7y \u0111\u1ee7",isInvalid:t.full_name&&a.full_name}),t.full_name&&a.full_name&&(0,x.jsx)("div",{className:"invalid-feedback",children:a.full_name})]})}),(0,x.jsx)(h.A,{md:4,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i *"}),(0,x.jsx)(d.A.Control,{type:"text",name:"phone",value:n.phone,onChange:p,placeholder:"0123456789",isInvalid:t.phone&&a.phone}),t.phone&&a.phone&&(0,x.jsx)("div",{className:"invalid-feedback",children:a.phone})]})})]}),(0,x.jsxs)(o.A,{children:[(0,x.jsx)(h.A,{md:6,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"Email"}),(0,x.jsx)(d.A.Control,{type:"email",name:"email",value:n.email,onChange:p,placeholder:"email@example.com",isInvalid:t.email&&a.email}),t.email&&a.email&&(0,x.jsx)("div",{className:"invalid-feedback",children:a.email})]})}),(0,x.jsx)(h.A,{md:6,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"CMND/CCCD"}),(0,x.jsx)(d.A.Control,{type:"text",name:"id_number",value:n.id_number,onChange:p,placeholder:"S\u1ed1 CMND/CCCD",isInvalid:t.id_number&&a.id_number}),t.id_number&&a.id_number&&(0,x.jsx)("div",{className:"invalid-feedback",children:a.id_number})]})})]}),(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"\u0110\u1ecba ch\u1ec9 li\xean h\u1ec7"}),(0,x.jsx)(d.A.Control,{as:"textarea",rows:2,name:"address",value:n.address,onChange:p,placeholder:"\u0110\u1ecba ch\u1ec9 \u0111\u1ea7y \u0111\u1ee7 (s\u1ed1 nh\xe0, \u0111\u01b0\u1eddng, ph\u01b0\u1eddng/x\xe3, qu\u1eadn/huy\u1ec7n, t\u1ec9nh/th\xe0nh)"})]}),(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"Ghi ch\xfa"}),(0,x.jsx)(d.A.Control,{as:"textarea",rows:3,name:"notes",value:n.notes,onChange:p,placeholder:"Ghi ch\xfa th\xeam v\u1ec1 kh\xe1ch h\xe0ng..."})]}),"individual"===n.customer_type&&(0,x.jsxs)(u.A,{variant:"info",children:[(0,x.jsx)("i",{className:"fas fa-info-circle me-2"}),(0,x.jsx)("strong",{children:"L\u01b0u \xfd cho kh\xe1ch h\xe0ng c\xe1 nh\xe2n:"})," M\u1ed9t c\xe1 nh\xe2n c\xf3 th\u1ec3 thu\xea kho th\xf4ng qua nhi\u1ec1u c\xf4ng ty kh\xe1c nhau. Vui l\xf2ng \u0111i\u1ec1n th\xf4ng tin c\xf4ng ty \u1edf tab ti\u1ebfp theo."]})]})]})};var g=a(4063);const j=function(e){let{companies:n,errors:a,touched:t,onCompaniesChange:r}=e;const c=(e,a,t)=>{const c=[...n];c[e]=(0,s.A)((0,s.A)({},c[e]),{},{[a]:t}),r(c)},m=e=>e.trim()?/^[0-9]{10}(-[0-9]{3})?$/.test(e)?"":"M\xe3 s\u1ed1 thu\u1ebf ph\u1ea3i c\xf3 10 s\u1ed1 ho\u1eb7c 10 s\u1ed1 + 3 s\u1ed1 m\xe3 chi nh\xe1nh (VD: 0123456789 ho\u1eb7c 0123456789-001)":"M\xe3 s\u1ed1 thu\u1ebf l\xe0 b\u1eaft bu\u1ed9c",p=["Kho h\xe0ng h\xf3a t\u1ed5ng h\u1ee3p","Kho nguy\xean li\u1ec7u s\u1ea3n xu\u1ea5t","Kho th\xe0nh ph\u1ea9m","Kho ph\u1ee5 t\xf9ng, linh ki\u1ec7n","Kho thi\u1ebft b\u1ecb, m\xe1y m\xf3c","Kho h\xe0ng \u0111i\u1ec7n t\u1eed","Kho h\xe0ng th\u1eddi trang","Kho h\xe0ng th\u1ef1c ph\u1ea9m","Kho h\xe0ng d\u01b0\u1ee3c ph\u1ea9m","Kho h\xe0ng h\xf3a ch\u1ea5t","Kho v\u0103n ph\xf2ng ph\u1ea9m","Kho t\xe0i li\u1ec7u, h\u1ed3 s\u01a1","Kh\xe1c"];return(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,x.jsxs)("h5",{className:"mb-0",children:[(0,x.jsx)("i",{className:"fas fa-building me-2"}),"Th\xf4ng tin c\xf4ng ty (",n.length,")"]}),(0,x.jsxs)(i.A,{variant:"outline-primary",size:"sm",onClick:()=>{const e={id:null,tax_code:"",company_name:"",invoice_address:"",warehouse_purpose:"",is_primary:0===n.length};r([...n,e])},children:[(0,x.jsx)("i",{className:"fas fa-plus me-2"}),"Th\xeam c\xf4ng ty"]})]}),(0,x.jsxs)(u.A,{variant:"info",className:"mb-3",children:[(0,x.jsx)("i",{className:"fas fa-info-circle me-2"}),(0,x.jsx)("strong",{children:"L\u01b0u \xfd:"})," M\u1ed9t c\xe1 nh\xe2n c\xf3 th\u1ec3 thu\xea nhi\u1ec1u kho b\u1eb1ng nhi\u1ec1u c\xf4ng ty kh\xe1c nhau. M\u1ed7i c\xf4ng ty s\u1ebd c\xf3 th\xf4ng tin ri\xeang \u0111\u1ec3 xu\u1ea5t h\xf3a \u0111\u01a1n v\xe0 k\xfd h\u1ee3p \u0111\u1ed3ng."]}),n.map((e,a)=>(0,x.jsxs)(l.A,{className:"mb-3",children:[(0,x.jsxs)(l.A.Header,{className:"d-flex justify-content-between align-items-center",children:[(0,x.jsxs)("div",{children:[(0,x.jsxs)("strong",{children:["C\xf4ng ty ",a+1]}),e.is_primary&&(0,x.jsx)(g.A,{bg:"primary",className:"ms-2",children:"C\xf4ng ty ch\xednh"})]}),(0,x.jsxs)("div",{children:[!e.is_primary&&n.length>1&&(0,x.jsx)(i.A,{variant:"outline-success",size:"sm",className:"me-2",onClick:()=>(e=>{const a=n.map((n,a)=>(0,s.A)((0,s.A)({},n),{},{is_primary:a===e}));r(a)})(a),title:"\u0110\u1eb7t l\xe0m c\xf4ng ty ch\xednh",children:(0,x.jsx)("i",{className:"fas fa-star"})}),n.length>1&&(0,x.jsx)(i.A,{variant:"outline-danger",size:"sm",onClick:()=>(e=>{if(n.length<=1)alert("Ph\u1ea3i c\xf3 \xedt nh\u1ea5t m\u1ed9t c\xf4ng ty");else if(window.confirm("B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a c\xf4ng ty n\xe0y?")){const a=n.filter((n,a)=>a!==e);n[e].is_primary&&a.length>0&&(a[0].is_primary=!0),r(a)}})(a),title:"X\xf3a c\xf4ng ty",children:(0,x.jsx)("i",{className:"fas fa-trash"})})]})]}),(0,x.jsxs)(l.A.Body,{children:[(0,x.jsxs)(o.A,{children:[(0,x.jsx)(h.A,{md:6,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"M\xe3 s\u1ed1 thu\u1ebf *"}),(0,x.jsx)(d.A.Control,{type:"text",value:e.tax_code,onChange:e=>c(a,"tax_code",e.target.value),placeholder:"0123456789 ho\u1eb7c 0123456789-001",isInvalid:m(e.tax_code)}),(0,x.jsx)(d.A.Text,{className:"text-muted",children:"10 s\u1ed1 cho tr\u1ee5 s\u1edf ch\xednh, th\xeam -001, -002... cho chi nh\xe1nh"}),m(e.tax_code)&&(0,x.jsx)("div",{className:"invalid-feedback d-block",children:m(e.tax_code)})]})}),(0,x.jsx)(h.A,{md:6,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"T\xean c\xf4ng ty *"}),(0,x.jsx)(d.A.Control,{type:"text",value:e.company_name,onChange:e=>c(a,"company_name",e.target.value),placeholder:"T\xean c\xf4ng ty \u0111\u1ea7y \u0111\u1ee7",isInvalid:!e.company_name.trim()}),!e.company_name.trim()&&(0,x.jsx)("div",{className:"invalid-feedback d-block",children:"T\xean c\xf4ng ty l\xe0 b\u1eaft bu\u1ed9c"})]})})]}),(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"\u0110\u1ecba ch\u1ec9 xu\u1ea5t h\xf3a \u0111\u01a1n *"}),(0,x.jsx)(d.A.Control,{as:"textarea",rows:2,value:e.invoice_address,onChange:e=>c(a,"invoice_address",e.target.value),placeholder:"\u0110\u1ecba ch\u1ec9 \u0111\u1ea7y \u0111\u1ee7 \u0111\u1ec3 xu\u1ea5t h\xf3a \u0111\u01a1n VAT",isInvalid:!e.invoice_address.trim()}),!e.invoice_address.trim()&&(0,x.jsx)("div",{className:"invalid-feedback d-block",children:"\u0110\u1ecba ch\u1ec9 xu\u1ea5t h\xf3a \u0111\u01a1n l\xe0 b\u1eaft bu\u1ed9c"})]}),(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"M\u1ee5c \u0111\xedch s\u1eed d\u1ee5ng kho *"}),(0,x.jsxs)(d.A.Select,{value:e.warehouse_purpose,onChange:e=>c(a,"warehouse_purpose",e.target.value),isInvalid:!e.warehouse_purpose,children:[(0,x.jsx)("option",{value:"",children:"-- Ch\u1ecdn m\u1ee5c \u0111\xedch s\u1eed d\u1ee5ng --"}),p.map(e=>(0,x.jsx)("option",{value:e,children:e},e))]}),!e.warehouse_purpose&&(0,x.jsx)("div",{className:"invalid-feedback d-block",children:"Vui l\xf2ng ch\u1ecdn m\u1ee5c \u0111\xedch s\u1eed d\u1ee5ng kho"}),(0,x.jsx)(d.A.Text,{className:"text-muted",children:"Th\xf4ng tin n\xe0y s\u1ebd \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong h\u1ee3p \u0111\u1ed3ng thu\xea kho"})]})]})]},a)),0===n.length&&(0,x.jsxs)(u.A,{variant:"warning",children:[(0,x.jsx)("i",{className:"fas fa-exclamation-triangle me-2"}),"Ch\u01b0a c\xf3 th\xf4ng tin c\xf4ng ty n\xe0o. Vui l\xf2ng th\xeam \xedt nh\u1ea5t m\u1ed9t c\xf4ng ty \u0111\u1ec3 ti\u1ebfp t\u1ee5c."]})]})};const _=function(e){let{contracts:n,companies:a,personalInfo:r,errors:c,touched:p,onContractsChange:j}=e;const[_]=(0,t.useState)([{id:1,name:"D\u1ef1 \xe1n Kho B\xecnh D\u01b0\u01a1ng",code:"BD001"},{id:2,name:"D\u1ef1 \xe1n Kho \u0110\u1ed3ng Nai",code:"DN001"},{id:3,name:"D\u1ef1 \xe1n Kho Long An",code:"LA001"},{id:4,name:"D\u1ef1 \xe1n Kho T\xe2y Ninh",code:"TN001"}]),A=(e,a,t)=>{const r=[...n];if(r[e]=(0,s.A)((0,s.A)({},r[e]),{},{[a]:t}),"start_date"===a&&t&&!r[e].end_date){const n=new Date(t),a=new Date(n);a.setFullYear(a.getFullYear()+1),r[e].end_date=a.toISOString().split("T")[0]}j(r)},v=()=>{const e=(new Date).getFullYear(),n=((new Date).getMonth()+1).toString().padStart(2,"0"),a=Math.floor(1e3*Math.random()).toString().padStart(3,"0");return"HD".concat(e).concat(n).concat(a)},b=e=>new Intl.NumberFormat("vi-VN").format(e);return(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,x.jsxs)("h5",{className:"mb-0",children:[(0,x.jsx)("i",{className:"fas fa-file-contract me-2"}),"Th\xf4ng tin h\u1ee3p \u0111\u1ed3ng (",n.length,")"]}),(0,x.jsxs)(i.A,{variant:"outline-primary",size:"sm",onClick:()=>{if(0===a.length)return void alert("Vui l\xf2ng th\xeam th\xf4ng tin c\xf4ng ty tr\u01b0\u1edbc khi t\u1ea1o h\u1ee3p \u0111\u1ed3ng");const e={id:null,contract_number:v(),project_id:"",warehouse_location:"",company_index:0,representative_name:r.full_name,representative_position:"Gi\xe1m \u0111\u1ed1c",area_sqm:0,rental_price:0,start_date:"",end_date:"",payment_terms:"Thanh to\xe1n theo th\xe1ng, tr\u01b0\u1edbc ng\xe0y 5 h\xe0ng th\xe1ng",binding_terms:"",is_active:!0};j([...n,e])},disabled:0===a.length,children:[(0,x.jsx)("i",{className:"fas fa-plus me-2"}),"Th\xeam h\u1ee3p \u0111\u1ed3ng"]})]}),(0,x.jsxs)(u.A,{variant:"info",className:"mb-3",children:[(0,x.jsx)("i",{className:"fas fa-info-circle me-2"}),(0,x.jsx)("strong",{children:"L\u01b0u \xfd:"})," M\u1ed9t c\xf4ng ty c\xf3 th\u1ec3 thu\xea nhi\u1ec1u kho \u1edf nhi\u1ec1u d\u1ef1 \xe1n, v\u1ecb tr\xed kh\xe1c nhau. Th\xf4ng tin n\xe0y s\u1ebd \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 t\u1ef1 \u0111\u1ed9ng t\u1ea1o h\u1ee3p \u0111\u1ed3ng thu\xea kho t\u1eeb h\u1ec7 th\u1ed1ng."]}),0===a.length&&(0,x.jsxs)(u.A,{variant:"warning",children:[(0,x.jsx)("i",{className:"fas fa-exclamation-triangle me-2"}),"Vui l\xf2ng \u0111i\u1ec1n th\xf4ng tin c\xf4ng ty tr\u01b0\u1edbc khi t\u1ea1o h\u1ee3p \u0111\u1ed3ng."]}),n.map((e,s)=>{const t=(e=>{const n=[];return e.contract_number.trim()||n.push("S\u1ed1 h\u1ee3p \u0111\u1ed3ng l\xe0 b\u1eaft bu\u1ed9c"),e.project_id||n.push("Vui l\xf2ng ch\u1ecdn d\u1ef1 \xe1n"),e.warehouse_location.trim()||n.push("V\u1ecb tr\xed kho l\xe0 b\u1eaft bu\u1ed9c"),e.representative_name.trim()||n.push("Ng\u01b0\u1eddi \u0111\u1ea1i di\u1ec7n l\xe0 b\u1eaft bu\u1ed9c"),e.area_sqm<=0&&n.push("Di\u1ec7n t\xedch thu\xea ph\u1ea3i l\u1edbn h\u01a1n 0"),e.rental_price<=0&&n.push("Gi\xe1 thu\xea ph\u1ea3i l\u1edbn h\u01a1n 0"),e.start_date||n.push("Ng\xe0y b\u1eaft \u0111\u1ea7u l\xe0 b\u1eaft bu\u1ed9c"),e.end_date||n.push("Ng\xe0y k\u1ebft th\xfac l\xe0 b\u1eaft bu\u1ed9c"),e.start_date&&e.end_date&&new Date(e.start_date)>=new Date(e.end_date)&&n.push("Ng\xe0y k\u1ebft th\xfac ph\u1ea3i sau ng\xe0y b\u1eaft \u0111\u1ea7u"),n})(e),r=a[e.company_index],c=((e,n,a)=>{if(!n||!a||e<=0)return 0;const s=new Date(n),t=new Date(a),r=12*(t.getFullYear()-s.getFullYear())+(t.getMonth()-s.getMonth());return r>0?Math.round(e/r):0})(e.rental_price,e.start_date,e.end_date);return(0,x.jsxs)(l.A,{className:"mb-3",children:[(0,x.jsxs)(l.A.Header,{className:"d-flex justify-content-between align-items-center",children:[(0,x.jsxs)("div",{children:[(0,x.jsxs)("strong",{children:["H\u1ee3p \u0111\u1ed3ng ",s+1]}),e.contract_number&&(0,x.jsx)(g.A,{bg:"secondary",className:"ms-2",children:e.contract_number}),e.is_active&&(0,x.jsx)(g.A,{bg:"success",className:"ms-2",children:"\u0110ang ho\u1ea1t \u0111\u1ed9ng"})]}),(0,x.jsx)("div",{children:(0,x.jsx)(i.A,{variant:"outline-danger",size:"sm",onClick:()=>(e=>{if(window.confirm("B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a h\u1ee3p \u0111\u1ed3ng n\xe0y?")){const a=n.filter((n,a)=>a!==e);j(a)}})(s),title:"X\xf3a h\u1ee3p \u0111\u1ed3ng",children:(0,x.jsx)("i",{className:"fas fa-trash"})})})]}),(0,x.jsxs)(l.A.Body,{children:[(0,x.jsxs)(o.A,{children:[(0,x.jsx)(h.A,{md:4,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"S\u1ed1 h\u1ee3p \u0111\u1ed3ng *"}),(0,x.jsxs)(m.A,{children:[(0,x.jsx)(d.A.Control,{type:"text",value:e.contract_number,onChange:e=>A(s,"contract_number",e.target.value),placeholder:"HD202400001"}),(0,x.jsx)(i.A,{variant:"outline-secondary",onClick:()=>A(s,"contract_number",v()),title:"T\u1ea1o s\u1ed1 h\u1ee3p \u0111\u1ed3ng t\u1ef1 \u0111\u1ed9ng",children:(0,x.jsx)("i",{className:"fas fa-magic"})})]})]})}),(0,x.jsx)(h.A,{md:4,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"D\u1ef1 \xe1n *"}),(0,x.jsxs)(d.A.Select,{value:e.project_id,onChange:e=>A(s,"project_id",e.target.value),children:[(0,x.jsx)("option",{value:"",children:"-- Ch\u1ecdn d\u1ef1 \xe1n --"}),_.map(e=>(0,x.jsxs)("option",{value:e.id,children:[e.name," (",e.code,")"]},e.id))]})]})}),(0,x.jsx)(h.A,{md:4,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"V\u1ecb tr\xed kho *"}),(0,x.jsx)(d.A.Control,{type:"text",value:e.warehouse_location,onChange:e=>A(s,"warehouse_location",e.target.value),placeholder:"VD: Khu A, L\xf4 01, T\u1ea7ng 1"})]})})]}),(0,x.jsxs)(o.A,{children:[(0,x.jsx)(h.A,{md:4,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"C\xf4ng ty thu\xea *"}),(0,x.jsx)(d.A.Select,{value:e.company_index,onChange:e=>A(s,"company_index",parseInt(e.target.value)),children:a.map((e,n)=>(0,x.jsxs)("option",{value:n,children:[e.company_name," (",e.tax_code,")"]},n))}),r&&(0,x.jsxs)(d.A.Text,{className:"text-muted",children:["M\u1ee5c \u0111\xedch: ",r.warehouse_purpose]})]})}),(0,x.jsx)(h.A,{md:4,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"Ng\u01b0\u1eddi \u0111\u1ea1i di\u1ec7n c\xf4ng ty *"}),(0,x.jsx)(d.A.Control,{type:"text",value:e.representative_name,onChange:e=>A(s,"representative_name",e.target.value),placeholder:"T\xean ng\u01b0\u1eddi \u0111\u1ea1i di\u1ec7n"})]})}),(0,x.jsx)(h.A,{md:4,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"Ch\u1ee9c v\u1ee5"}),(0,x.jsxs)(d.A.Select,{value:e.representative_position,onChange:e=>A(s,"representative_position",e.target.value),children:[(0,x.jsx)("option",{value:"Gi\xe1m \u0111\u1ed1c",children:"Gi\xe1m \u0111\u1ed1c"}),(0,x.jsx)("option",{value:"Ph\xf3 Gi\xe1m \u0111\u1ed1c",children:"Ph\xf3 Gi\xe1m \u0111\u1ed1c"}),(0,x.jsx)("option",{value:"Tr\u01b0\u1edfng ph\xf2ng",children:"Tr\u01b0\u1edfng ph\xf2ng"}),(0,x.jsx)("option",{value:"Qu\u1ea3n l\xfd",children:"Qu\u1ea3n l\xfd"}),(0,x.jsx)("option",{value:"\u0110\u1ea1i di\u1ec7n",children:"\u0110\u1ea1i di\u1ec7n"})]})]})})]}),(0,x.jsxs)(o.A,{children:[(0,x.jsx)(h.A,{md:3,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"Di\u1ec7n t\xedch thu\xea (m\xb2) *"}),(0,x.jsx)(d.A.Control,{type:"number",min:"0",step:"0.1",value:e.area_sqm,onChange:e=>A(s,"area_sqm",parseFloat(e.target.value)||0),placeholder:"0"})]})}),(0,x.jsx)(h.A,{md:3,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"Gi\xe1 thu\xea/th\xe1ng (VN\u0110) *"}),(0,x.jsx)(d.A.Control,{type:"number",min:"0",value:e.rental_price,onChange:e=>A(s,"rental_price",parseInt(e.target.value)||0),placeholder:"0"}),e.rental_price>0&&(0,x.jsxs)(d.A.Text,{className:"text-success",children:[b(e.rental_price)," VN\u0110/th\xe1ng"]})]})}),(0,x.jsx)(h.A,{md:3,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"Ng\xe0y b\u1eaft \u0111\u1ea7u *"}),(0,x.jsx)(d.A.Control,{type:"date",value:e.start_date,onChange:e=>A(s,"start_date",e.target.value)})]})}),(0,x.jsx)(h.A,{md:3,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"Ng\xe0y k\u1ebft th\xfac *"}),(0,x.jsx)(d.A.Control,{type:"date",value:e.end_date,onChange:e=>A(s,"end_date",e.target.value),min:e.start_date})]})})]}),(0,x.jsxs)(o.A,{children:[(0,x.jsx)(h.A,{md:6,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"Th\xf4ng tin thanh to\xe1n"}),(0,x.jsx)(d.A.Control,{as:"textarea",rows:3,value:e.payment_terms,onChange:e=>A(s,"payment_terms",e.target.value),placeholder:"\u0110i\u1ec1u ki\u1ec7n thanh to\xe1n, chu k\u1ef3 thanh to\xe1n..."})]})}),(0,x.jsx)(h.A,{md:6,children:(0,x.jsxs)(d.A.Group,{className:"mb-3",children:[(0,x.jsx)(d.A.Label,{children:"\u0110i\u1ec1u kho\u1ea3n r\xe0ng bu\u1ed9c"}),(0,x.jsx)(d.A.Control,{as:"textarea",rows:3,value:e.binding_terms,onChange:e=>A(s,"binding_terms",e.target.value),placeholder:"C\xe1c \u0111i\u1ec1u kho\u1ea3n \u0111\u1eb7c bi\u1ec7t, r\xe0ng bu\u1ed9c..."})]})})]}),e.start_date&&e.end_date&&e.rental_price>0&&(0,x.jsx)(u.A,{variant:"light",className:"mb-0",children:(0,x.jsxs)(o.A,{children:[(0,x.jsxs)(h.A,{md:3,children:[(0,x.jsx)("strong",{children:"T\u1ed5ng th\u1eddi h\u1ea1n:"}),(0,x.jsx)("br",{}),Math.ceil((new Date(e.end_date)-new Date(e.start_date))/864e5)," ng\xe0y"]}),(0,x.jsxs)(h.A,{md:3,children:[(0,x.jsx)("strong",{children:"Gi\xe1 thu\xea/m\xb2/th\xe1ng:"}),(0,x.jsx)("br",{}),e.area_sqm>0?b(Math.round(e.rental_price/e.area_sqm)):0," VN\u0110"]}),(0,x.jsxs)(h.A,{md:3,children:[(0,x.jsx)("strong",{children:"T\u1ed5ng gi\xe1 tr\u1ecb h\u1ee3p \u0111\u1ed3ng:"}),(0,x.jsx)("br",{}),(0,x.jsxs)("span",{className:"text-success",children:[b(c*Math.ceil((new Date(e.end_date)-new Date(e.start_date))/2592e6))," VN\u0110"]})]}),(0,x.jsxs)(h.A,{md:3,children:[(0,x.jsx)("strong",{children:"Tr\u1ea1ng th\xe1i:"}),(0,x.jsx)("br",{}),(0,x.jsx)(g.A,{bg:e.is_active?"success":"secondary",children:e.is_active?"\u0110ang ho\u1ea1t \u0111\u1ed9ng":"Kh\xf4ng ho\u1ea1t \u0111\u1ed9ng"})]})]})}),t.length>0&&(0,x.jsxs)(u.A,{variant:"danger",className:"mt-3",children:[(0,x.jsx)("strong",{children:"Vui l\xf2ng ki\u1ec3m tra:"}),(0,x.jsx)("ul",{className:"mb-0 mt-2",children:t.map((e,n)=>(0,x.jsx)("li",{children:e},n))})]})]})]},s)}),0===n.length&&a.length>0&&(0,x.jsxs)(u.A,{variant:"warning",children:[(0,x.jsx)("i",{className:"fas fa-exclamation-triangle me-2"}),"Ch\u01b0a c\xf3 h\u1ee3p \u0111\u1ed3ng n\xe0o. Vui l\xf2ng th\xeam \xedt nh\u1ea5t m\u1ed9t h\u1ee3p \u0111\u1ed3ng \u0111\u1ec3 ho\xe0n t\u1ea5t th\xf4ng tin kh\xe1ch h\xe0ng."]})]})};const A=function(e){let{customer:n=null,onSave:a,onCancel:l,isLoading:o=!1}=e;const[h,d]=(0,t.useState)("personal"),[m,u]=(0,t.useState)({personal:{customer_code:"",customer_type:"individual",full_name:"",phone:"",email:"",address:"",id_number:"",notes:""},companies:[{id:null,tax_code:"",company_name:"",invoice_address:"",warehouse_purpose:"",is_primary:!0}],contracts:[{id:null,contract_number:"",project_id:"",warehouse_location:"",company_index:0,representative_name:"",representative_position:"",area_sqm:0,rental_price:0,start_date:"",end_date:"",payment_terms:"",binding_terms:"",is_active:!0}]}),[g]=(0,t.useState)({}),[A]=(0,t.useState)({}),v=e=>{if(!e)return"";try{if(e.includes("T"))return e.split("T")[0];if(e.match(/^\d{4}-\d{2}-\d{2}$/))return e;const n=new Date(e);return isNaN(n.getTime())?"":n.toISOString().split("T")[0]}catch(n){return console.warn("Date formatting error:",n,"for date:",e),""}};return(0,t.useEffect)(()=>{n?(console.log("\ud83d\udd0d Loading customer data for edit:",n),u({personal:{customer_code:n.customer_code||"",customer_type:n.customer_type||"individual",full_name:n.representative_name||n.name||"",phone:n.phone||"",email:n.email||"",address:n.address||"",id_number:n.id_number||"",notes:n.notes||""},companies:[{id:null,tax_code:n.tax_code||"",company_name:n.name||"",invoice_address:n.address||"",warehouse_purpose:"",is_primary:!0}],contracts:Array.isArray(n.contracts)?n.contracts.map(e=>({id:e.id||null,contract_number:e.contract_number||"",project_id:e.project_id||"",warehouse_location:"".concat(e.project_name||""," - ").concat(e.zone_code||"").trim(),company_index:0,representative_name:n.representative_name||n.name||"",representative_position:"",area_sqm:e.zone_area||0,rental_price:e.rental_price||e.total_value||0,start_date:v(e.start_date),end_date:v(e.end_date),payment_terms:e.payment_cycle||"",binding_terms:e.contract_terms||"",is_active:"active"===e.status,status:e.status||"draft",project_name:e.project_name||"",zone_code:e.zone_code||"",zone_name:e.zone_name||"",days_until_expiry:e.days_until_expiry||null})):[{id:null,contract_number:"",project_id:"",warehouse_location:"",company_index:0,representative_name:n.representative_name||n.name||"",representative_position:"",area_sqm:0,rental_price:0,start_date:"",end_date:"",payment_terms:"",binding_terms:"",is_active:!0}]}),console.log("\u2705 Form data populated for customer:",n.customer_code)):console.log("\ud83c\udd95 Creating new customer - using default form structure")},[n]),(0,x.jsxs)("div",{children:[(0,x.jsxs)(r.A.Container,{activeKey:h,onSelect:e=>d(e),children:[(0,x.jsxs)(c.A,{variant:"tabs",className:"mb-3",children:[(0,x.jsx)(c.A.Item,{children:(0,x.jsxs)(c.A.Link,{eventKey:"personal",children:[(0,x.jsx)("i",{className:"fas fa-user me-2"}),"Th\xf4ng tin c\u01a1 b\u1ea3n"]})}),(0,x.jsx)(c.A.Item,{children:(0,x.jsxs)(c.A.Link,{eventKey:"company",children:[(0,x.jsx)("i",{className:"fas fa-building me-2"}),"Th\xf4ng tin c\xf4ng ty"]})}),(0,x.jsx)(c.A.Item,{children:(0,x.jsxs)(c.A.Link,{eventKey:"contracts",children:[(0,x.jsx)("i",{className:"fas fa-file-contract me-2"}),"Th\xf4ng tin h\u1ee3p \u0111\u1ed3ng"]})})]}),(0,x.jsxs)(r.A.Content,{children:[(0,x.jsx)(r.A.Pane,{eventKey:"personal",children:(0,x.jsx)(p,{data:m.personal,errors:g,touched:A,onDataChange:e=>u(n=>(0,s.A)((0,s.A)({},n),{},{personal:e})),onGenerateCode:()=>{const e="individual"===m.personal.customer_type?"CN":"DN",n=Date.now().toString(),a=Math.floor(1e4*Math.random()).toString().padStart(4,"0"),t=(n.slice(-2)+a).slice(0,6),r="".concat(e).concat(t);u(e=>(0,s.A)((0,s.A)({},e),{},{personal:(0,s.A)((0,s.A)({},e.personal),{},{customer_code:r})}))}})}),(0,x.jsx)(r.A.Pane,{eventKey:"company",children:(0,x.jsx)(j,{companies:m.companies,errors:g,touched:A,onCompaniesChange:e=>u(n=>(0,s.A)((0,s.A)({},n),{},{companies:e}))})}),(0,x.jsx)(r.A.Pane,{eventKey:"contracts",children:(0,x.jsx)(_,{contracts:m.contracts,companies:m.companies,personalInfo:m.personal,errors:g,touched:A,onContractsChange:e=>u(n=>(0,s.A)((0,s.A)({},n),{},{contracts:e}))})})]})]}),(0,x.jsxs)("div",{className:"d-flex justify-content-between mt-4",children:[(0,x.jsxs)(i.A,{variant:"outline-secondary",onClick:l,disabled:o,children:[(0,x.jsx)("i",{className:"fas fa-times me-2"}),"H\u1ee7y b\u1ecf"]}),(0,x.jsxs)("div",{children:["personal"!==h&&(0,x.jsxs)(i.A,{variant:"outline-primary",className:"me-2",onClick:()=>{const e=["personal","company","contracts"],n=e.indexOf(h);n>0&&d(e[n-1])},children:[(0,x.jsx)("i",{className:"fas fa-arrow-left me-2"}),"Quay l\u1ea1i"]}),"contracts"!==h?(0,x.jsxs)(i.A,{variant:"primary",onClick:()=>{const e=["personal","company","contracts"],n=e.indexOf(h);n<e.length-1&&d(e[n+1])},children:["Ti\u1ebfp theo",(0,x.jsx)("i",{className:"fas fa-arrow-right ms-2"})]}):(0,x.jsx)(i.A,{variant:"success",onClick:()=>{try{if(console.log("\ud83d\udd0d CustomerFormTabs onClick triggered"),console.log("\ud83d\udcca Current formData:",m),console.log("\ud83c\udfaf onSave function exists:",typeof a),"function"!==typeof a)throw new Error("onSave is not a function");a(m)}catch(e){console.error("\u274c CustomerFormTabs onClick error:",e),alert("Error: "+e.message)}},disabled:o,size:"lg",children:o?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("span",{className:"spinner-border spinner-border-sm me-2"}),"\u0110ang l\u01b0u..."]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("i",{className:"fas fa-save me-2"}),n?"C\u1eadp nh\u1eadt":"L\u01b0u th\xf4ng tin"]})})]})]})]})}}}]);
//# sourceMappingURL=998.7cf5c0f4.chunk.js.map