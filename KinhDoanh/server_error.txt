(node:36432) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_users_email ON users(email)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_users_role ON users(role)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_users_is_active ON users(is_active)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_users_created_at ON users(created_at)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_users_last_login ON users(last_login)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_customers_status ON customers(status)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_customers_created_at ON customers(created_at)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_customers_created_by ON customers(created_by)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_projects_status ON projects(status)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_projects_code ON projects(code)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_projects_name ON projects(name)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_projects_created_at ON projects(created_at)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_projects_manager_id ON projects(manager_id)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_projects_status_created ON projects(status, created_at)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_contracts_project_id ON contracts(project_id)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_contracts_status ON contracts(status)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_contracts_start_date ON contracts(start_date)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_contracts_end_date ON contracts(end_date)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_contracts_created_at ON contracts(created_at)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_contracts_project_status ON contracts(project_id, status)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_contracts_dates ON contracts(start_date, end_date, status)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_zones_status ON warehouse_zones(status)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_zones_zone_type ON warehouse_zones(zone_type)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_zones_created_at ON warehouse_zones(created_at)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_upp_project_id ON user_project_permissions(project_id)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_upp_created_at ON user_project_permissions(created_at)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_ai_configs_provider ON user_ai_configs(provider)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_ai_configs_is_active ON user_ai_configs(is_active)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_ai_configs_priority ON user_ai_configs(priority)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_chat_sessions_status ON ai_chat_sessions(status)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_chat_sessions_started_at ON ai_chat_sessions(started_at)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_chat_sessions_ai_provider ON ai_chat_sessions(ai_provider)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_chat_messages_role ON ai_chat_messages(role)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_chat_messages_created_at ON ai_chat_messages(created_at)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_chat_messages_is_function_call ON ai_chat_messages(is_function' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_query_cache_satisfaction ON ai_query_cache(satisfaction_score)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_query_cache_usage ON ai_query_cache(usage_count)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_query_cache_last_used ON ai_query_cache(last_used_at)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_query_cache_usage_satisfaction ON ai_query_cache(usage_count, ' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_user_logs_action ON user_logs(action)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_user_logs_resource_type ON user_logs(resource_type)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_user_logs_resource_id ON user_logs(resource_id)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_user_logs_created_at ON user_logs(created_at)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_user_logs_is_ai_assisted ON user_logs(is_ai_assisted)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_user_logs_ai_session_id ON user_logs(ai_session_id)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_user_logs_action_created ON user_logs(action, created_at)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_user_logs_ai_assisted_created ON user_logs(is_ai_assisted, cre' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_schema_docs_is_active ON database_schema_docs(is_active)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_ai_functions_is_active ON ai_function_definitions(is_active)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_ai_functions_usage_count ON ai_function_definitions(usage_coun' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_documents_customer_id ON documents(customer_id)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_documents_category_id ON documents(category_id)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_documents_uploaded_by ON documents(uploaded_by)' at line 1
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF NOT EXISTS idx_documents_created_at ON documents(created_at)' at line 1
⚠️  Warning executing statement: Table 'kho_mvg.customers' doesn't exist
⚠️  Warning executing statement: Table 'kho_mvg.contracts' doesn't exist
⚠️  Warning executing statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PRINT 'Database indexes created successfully!'' at line 1
❌ Lỗi kiểm tra/tạo admin user: Table 'kho_mvg.users' doesn't exist
Failed to connect to MongoDB: MongooseServerSelectionError: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017
    at _handleConnectionErrors (C:\KinhDoanh\node_modules\mongoose\lib\connection.js:816:11)
    at NativeConnection.openUri (C:\KinhDoanh\node_modules\mongoose\lib\connection.js:791:11)
    at async connectMongoDB (C:\KinhDoanh\config\database.js:35:27)
    at async startServer (C:\KinhDoanh\server.js:156:9) {
  reason: TopologyDescription {
    type: 'Unknown',
    servers: Map(1) { 'localhost:27017' => [ServerDescription] },
    stale: false,
    compatible: true,
    heartbeatFrequencyMS: 10000,
    localThresholdMS: 15,
    setName: null,
    maxElectionId: null,
    maxSetVersion: null,
    commonWireVersion: 0,
    logicalSessionTimeoutMinutes: null
  },
  code: undefined
}
❌ Lỗi khởi động server: MongooseServerSelectionError: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017
    at _handleConnectionErrors (C:\KinhDoanh\node_modules\mongoose\lib\connection.js:816:11)
    at NativeConnection.openUri (C:\KinhDoanh\node_modules\mongoose\lib\connection.js:791:11)
    at async connectMongoDB (C:\KinhDoanh\config\database.js:35:27)
    at async startServer (C:\KinhDoanh\server.js:156:9) {
  reason: TopologyDescription {
    type: 'Unknown',
    servers: Map(1) { 'localhost:27017' => [ServerDescription] },
    stale: false,
    compatible: true,
    heartbeatFrequencyMS: 10000,
    localThresholdMS: 15,
    setName: null,
    maxElectionId: null,
    maxSetVersion: null,
    commonWireVersion: 0,
    logicalSessionTimeoutMinutes: null
  },
  code: undefined
}
